[
  {
    "title": "VBS | Delete specified file or folder.",
    "description": "Sample source code of a function to delete files and folders using VBS",
    "date": "2020-02-23T00:00:00.000Z",
    "emoji": "ğŸ¶",
    "tags": ["vbs"],
    "published": true,
    "body": {
      "raw": " Here is a sample source code of a function to delete files and folders using VBS.  ## Sample Code  ```vb Option Explicit  DeleteFolder \"C:\\sample\" DeleteFile \"C:\\test\\test.txt\"  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' @brief : Delete the specified file. ' @note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Sub DeleteFile (ByVal strFile)   Dim objFso  Set objFso = CreateObject(\"Scripting.FileSystemObject\")   ' delete file  objFso.DeleteFile strFile,True   Set objFso = Nothing  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' @brief : Delete the specified folder. ' @note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Sub DeleteFolder (ByVal strFolder)   Dim objFso  Set objFso = CreateObject(\"Scripting.FileSystemObject\")   ' delete folder  objFso.DeleteFolder strFolder,True    Set objFso = Nothing  End Sub ```  ## Additional information.  `FileSystemObject.DeleteFolder` Function:    - Parameter 1:    - Folder to be deleted. - Parameter 2:   - True: Delete read-only files as well.   - False (default): Do not delete read-only files."
    },
    "_id": "blog/1-delete-file-folder-vbs.mdx",
    "_raw": {
      "sourceFilePath": "blog/1-delete-file-folder-vbs.mdx",
      "sourceFileName": "1-delete-file-folder-vbs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/1-delete-file-folder-vbs"
    },
    "type": "Post",
    "slug": "/blog/1-delete-file-folder-vbs",
    "slugAsParams": "1-delete-file-folder-vbs"
  },
  {
    "title": "How to Apply Updated JavaScript Files in WordPress",
    "description": "When updating JavaScript files within WordPress (a web server), I encountered a situation where the changes were not reflected properly, leading to frustration. To prevent falling into the same situation, I'd like to share the solution I found.",
    "date": "2020-03-07T00:00:00.000Z",
    "emoji": "ğŸ¦’",
    "tags": ["wordpress"],
    "published": true,
    "body": {
      "raw": " When updating JavaScript files within WordPress (a web server), I encountered a situation where the changes were not reflected properly, leading to frustration. To prevent falling into the same situation, I'd like to share the solution I found.  ## Problem Encountered In cases like the following source code, where a separate file 'Player.js' is being loaded:  ```html <html> <head>     <meta charset=\"utf-8\" />     <script src=\"js/class/Player.js\"></script>     ãƒ»     ãƒ»     ãƒ» </head> ```  If an issue is found in 'Player.js' and you make changes to it, simply re-uploading the JavaScript file won't reflect the changes on the web browser.  ## Solution To cut to the chase, you need to modify your code as follows:  ```html <html> <head>     <meta charset=\"utf-8\" />     <script src=\"js/class/Player.js?20200306\"></script>     ãƒ»     ãƒ»     ãƒ» </head> ```  Here, I've added '?20200306' after 'Player.js'. You can use any number or identifier after the '?'â€”it doesn't matter. It could be the updated date or anything else.  By doing this, the web browser recognizes it as a new JavaScript file, and the changes will be reflected.  ## Cause The data for CSS and JS files is stored in the web browser's cache. Therefore, changes made to files within WordPress might not be reflected. However, as shown in the solution in step 2, adding '?+number' makes the browser treat it as a new file, prompting it to load fresh data.  That's it!\""
    },
    "_id": "blog/10-update-javascript-wordpress.mdx",
    "_raw": {
      "sourceFilePath": "blog/10-update-javascript-wordpress.mdx",
      "sourceFileName": "10-update-javascript-wordpress.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/10-update-javascript-wordpress"
    },
    "type": "Post",
    "slug": "/blog/10-update-javascript-wordpress",
    "slugAsParams": "10-update-javascript-wordpress"
  },
  {
    "title": "MQL | Sending JSON Data with the WebRequest Function",
    "description": "This is an article about MQL, a language used for FX trading in MetaTrader 4 (MT4).In this article, we will introduce how to send JSON data using the WebRequest function to make requests to a web server.",
    "date": "2020-03-08T00:00:00.000Z",
    "emoji": "ğŸ’¹",
    "tags": ["ea", "mql"],
    "published": true,
    "body": {
      "raw": " This is an article about MQL, a language used for FX trading in MetaTrader 4 (MT4).  In this article, we will introduce how to send JSON data using the WebRequest function to make requests to a web server.  ## WebRequest Function The WebRequest function is used to send HTTP requests to a specified web server. There are two variations of the WebRequest function with different sets of parameters. In this method, we will use the following type:  ```cpp int  WebRequest(    const string      method,           // HTTP method    const string      url,              // URL    const string      headers,          // Headers    int               timeout,          // Timeout    const char        &data[],          // Array containing the HTTP message body    char              &result[],        // Array containing the server's response data    string            &result_headers   // Server response headers    ); ```  If you want to understand it better, you can also refer to the following website:  [Reference Site](https://yukifx.web.fc2.com/sub/reference/05_common_func/cone/commonfunc_webrequest.html)  ## Sending JSON Data via POST Let's explain the steps to send JSON data via POST using the WebRequest function.  ### â‘  Configure WebRequest-Allow URL In MT4, you need to specify the URLs that are allowed for sending web requests.  First, launch MT4 and go to the menu bar, then select \"Tools\" -> \"Options\" -> \"Expert Advisors.\"  In this window, you will find \"Allow WebRequest URLs.\" Check the box and add the URL to which you want to send requests.  ![image](/blog/11/add_url.png)  ___ ### â‘¡ POST JSON Data to the Web Server We will illustrate sending text to a posting-enabled web server.  Suppose you have the following text:  Hello. Goodbye.  To store this text in an MQL String variable, it will look like this:  ```cpp // Text prepared in MQL string text; text = \"Hello.\" + \"\\n\" + \"Goodbye.\" ```  To send this text in JSON format, you need to convert it as follows:  ```json {\"content\":\"Hello.\\nGoodbye.\"} ```  Please note that the \"content\" part is just an example. It can vary depending on the target web server.  You need to convert the text into JSON format like the example above and then load it into the WebRequest function to send the request.  Here's an example in MQL:  ```cpp // Text prepared in MQL string text; text = \"Hello.\" + \"\\n\" + \"Goodbye.\" string headers;  // Convert text to JSON format and send the web request string data; char post[], result[];  // Create the header part headers = \"Content-Type: application/json\\r\\n\";  // Create the body part StringReplace(text, \"\\n\", \"\\\\n\"); data = \"{\\\"content\\\":\\\"\" + text + \"\\\"}\"; ArrayResize(post, StringToCharArray(data, post, 0, WHOLE_ARRAY, CP_UTF8) - 1);  // Send the request int rest = WebRequest(\"POST\", *Web server URL*, headers, 5000, post, result, headers); ```  In the example above, special characters such as line breaks need to be converted into strings that can be recognized by JSON, so be cautious.  That's it!"
    },
    "_id": "blog/11-web-request-json-mql.mdx",
    "_raw": {
      "sourceFilePath": "blog/11-web-request-json-mql.mdx",
      "sourceFileName": "11-web-request-json-mql.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/11-web-request-json-mql"
    },
    "type": "Post",
    "slug": "/blog/11-web-request-json-mql",
    "slugAsParams": "11-web-request-json-mql"
  },
  {
    "title": "Javascript | Sample Typing Game",
    "description": "I created a \"Typing Game\" using JavaScript.",
    "date": "2020-03-09T00:00:00.000Z",
    "emoji": "âŒ¨",
    "tags": ["javascript"],
    "published": true,
    "body": {
      "raw": " I created a \"Typing Game\" using JavaScript.  ## Overview This game requires players to type in displayed English words from the keyboard within a time limit.  [**Play Sample Game**](https://atman-33.github.io/typing-game-js/)  [**Source Code Here**](https://github.com/atman-33/typing-game-js)  ![image](/blog/12/typing.png)  ## Project Structure The project structure is as follows:  ```text js_typing_game â”œ index.html â”œ css â”‚  â”” base.css â”” js    â”œ Common.js    â”” class ã€€    â”œ FlashingText.js ã€€    â”” Typing.js ```  ## Source Code Explanation The main file responsible for running the game is `index.html`.  Here is an overview of the functionality of each file, so you can get a grasp of the major components:  ```text index.html       - Main game logic base.css         - Styling for the game screen and keyboard Common.js        - Text loading for questions FlashingText.js  - Text blinking effect Typing.js        - Typing character validation and keyboard lighting ```  I will primarily explain the key code segments.  ___ ### â‘ index.html In this case, I defined the game state (`gameState`) to transition from \"Preparing\" to \"Typing Game\" to \"Game Over\" based on player actions.  ```html <!DOCTYPE html> <html>     <head>         <meta http-equiv=\"content-type\" charset=\"utf-8\">         <link rel=\"stylesheet\" href=\"css/base.css\" />         <script src=\"//code.createjs.com/1.0.0/createjs.min.js\"></script>         <script src=\"js/Common.js\"></script>         <script src=\"js/class/Typing.js\"></script>         <script src=\"js/class/FlashingText.js\"></script>         <script> // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // JavaScript start  // Typing game state codes const READY = 0;    // Preparing const PLAYING = 1;  // Typing Game const END = 2;      // Game Over  var score = 0;      // Score var timer = 30;     // Timer (seconds)  var countdown = 3;              // Countdown before starting var wordsFile = \"words.txt\";    // Text file containing questions  var gameState = READY;      // Typing game state var typing = new Typing();  // Typing class  var flashingText = new FlashingText(\"input\", \"Press Spacebar!!\", 1000, 500, 0);  var scoreText; var timerText;  var subject;        // Upper text display space: Title var input;          // Lower text display space: Input display content  var statementList;  // List of questions var statement;      // Question text var numOfStatement; // Number indicating which character of the question text  window.addEventListener(\"keydown\", handleKeydown); window.addEventListener(\"keyup\", handleKeyup);  // Execute when the page loads window.onload = function(){      statementList = readTextFileToArray(wordsFile);     typing.insertKeyboard(\"board\");      // 0: Preparing     if(gameState == READY) {          flashingText.flash();   // Display blinking text before starting     } }  // ---- ---- ---- ---- ---- // Key Processing start  // Keydown Processing function handleKeydown(event) {      // Process input characters     var chara = typing.checkWord(event);      // 0: Preparing     if(gameState == READY) {         if(event.keyCode == 32){    // Press spacebar to start             startReady();           // Proceed to preparation before starting         }     }      // 1: Typing Game     if(gameState == PLAYING) {         judgeTyping(chara);         // Check correctness of typed character     } }  // Keyup Processing function handleKeyup(event) {      // Check Caps Lock     var capslock;      if(typing.checkCapsLock(event) == 1) {         capslock = document.getElementById('capslock');         capslock.innerHTML = \"CapsLock ON\";     } else {         capslock = document.getElementById('capslock');         capslock.innerHTML = \"CapsLock OFF\";     } }  // Key Processing end // ---- ---- ---- ---- ----  // Preparation before starting the game function startReady() {      flashingText.setMsg(\"Starting soon...\");     flashingText.setIsFlashing(0);  // Stop blinking      // Display countdown on the subject ID tag     subject = document.getElementById('subject');     subject.innerHTML = countdown;      // Countdown every 1 second     var id = setInterval(function(){         countdown--;         console.log(countdown);          subject.innerHTML = countdown;          if(countdown <= 0){             clearInterval(id);             console.log(\"Finish!\");             gameState = PLAYING;              startTimer();   // Start countdown for remaining time             loadSubject();  // Load the question text         }     }, 1000); }  // Load question text function loadSubject() {      // statementList = [\"Test\", \"Apple\", \"Banana\"];      // Randomly select a question from the list of questions     statement = statementList[Math.floor(Math.random() * statementList.length)];      // Display the question text     subject = document.getElementById('subject');     subject.innerHTML = statement;      // Display the input content     subject = document.getElementById('input');     subject.innerHTML = \"\";      numOfStatement = 0;      // Keyboard highlights correct characters     typing.active(statement, numOfStatement); }  // Start countdown for remaining time function startTimer() {      // Display countdown on the timer ID tag     timerText = document.getElementById('timer');     timerText.innerHTML = \"Remaining Time: \" + timer;       // Countdown every 1 second     var id = setInterval(function(){         timer--;         console.log(timer);          timerText.innerHTML = \"Remaining Time: \" + timer;          if(timer <= 0){             if(gameState == PLAYING) {                 // Game Over processing                 subject = document.getElementById('subject');                 subject.innerHTML = \"---- Game Over ----\";                 gameState = END;                 clearInterval(id);             }         }     }, 1000); }  // Check correctness of typed character function judgeTyping(chara) {     var seikai = statement.substr(numOfStatement, 1);      if(chara == seikai) {         // Correct         score = score + 10;          // Add correct character to input (input ID tag)         var input = document.getElementById('input');         input.innerHTML = input.innerHTML + chara;          // Move to the next character         numOfStatement = numOfStatement + 1;          if(statement.length != numOfStatement) {             // If the question text continues             typing.active(statement, numOfStatement);          } else {             score = score + 50;             // Move to the next question             loadSubject();         }      } else {         // Incorrect, do nothing     }      // Update the score     scoreText = document.getElementById('score');     scoreText.innerHTML = \"Score: \" +   score; }  // JavaScript end // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----         </script>     </head>     <body>         <!-- Panel Display -->         <div id=\"panel\">             <div id=\"score\">Score: 0</div>             <div id=\"timer\">Remaining Time: --</div>             <div id=\"capslock\">CapsLock --</div>             <div id=\"subject\">Typing Game</div>             <div id=\"input\">Input</div>         </div>         <!-- Keyboard Display -->         <div id=\"board\">         </div>     </body>     <foot>      </foot> </html> ```  You might notice that there are relatively few HTML elements in the actual display part of the HTML file. This is because the content for the keyboard display (HTML) is called from `Typing.js`. This decision was made to control keyboard color changes from `Typing.js` for better management.  ___ ### â‘¡Common.js This file contains a function that reads a specified text file and returns an array. The delimiter used for splitting is the newline character.  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // brief: Read a specified file and return an array. // note: Split using newline character. // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- function readTextFileToArray(file) {      var array;      var rawFile = new XMLHttpRequest();     rawFile.open(\"GET\", file, false);     rawFile.onreadystatechange = function ()     {         if(rawFile.readyState === 4)         {             if(rawFile.status === 200 || rawFile.status == 0)             {                 var allText = rawFile.responseText;                 array = allText.split(/[\\r\\n]+/);             }         }     }     rawFile.send(null);      return array; } ```  ___ ### â‘¢FlashingText.js This is a class for making text blink in an HTML page.  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // brief: Blinking Text Class // note: // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- class FlashingText {      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // brief: Constructor     // note: Arguments id -> ID tag in HTML     //                  msg -> Message to be displayed in the ID tag     //                  onTime -> Lighting time [ms]     //                  offTime -> Extinction time [ms]     //                  flag -> 0: Display, 1: Hide     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     constructor(id, msg, onTime, offTime, flag) {          this.id = id;         this.msg = msg;         this.onTime = onTime;         this.offTime = offTime;         this.flag = flag;          this.isFlashing = 1;    // 1: Blink, 0: Do not blink     }      // setter     setMsg(msg) { this.msg = msg; }     setIsFlashing(isFlashing) {         this.isFlashing = isFlashing;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // brief: Make text blink     // note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     flash() {          // Get the text with the specified ID         var element = document.getElementById(this.id);         var interval;      \tif(this.flag == 0){      \t\t// Display the text     \t\telement.innerHTML = this.msg;     \t\tthis.flag = 1;     \t\tinterval = this.onTime;     \t}     \telse{      \t\t// Hide the text     \t\telement.innerHTML = \"\";     \t\tthis.flag = 0;     \t\tinterval = this.offTime;     \t}          if(this.isFlashing == 1 || (this.isFlashing == 0 && this.flag == 0)) {             var self = this;         \tsetTimeout(function() {self.flash();}, interval);         }     } } ```      ___ ### â‘£ Typing.js  The key points in this script are that it defines strings for keyboard keys in a dictionary-like format. Furthermore, it handles the lowercase/uppercase states separately for CapsLock since CapsLock can change the case of characters.   Additionally, this class contains a function for highlighting the corresponding keyboard keys (setactive method).  By passing a string as an argument, this class determines the corresponding keyboard keys based on the class attribute in the HTML tags. Therefore, this class needs to be integrated with the HTML (the part that displays the keyboard), but managing it in a separate file would not be ideal for maintenance, so it was designed to display the keyboard keys from within this class.  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // brief: Typing Class // note: // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  var codelist = {8:[\"BackSpase\",\"BackSpace\"], 9:[\"Tab\",\"Tab\"], 13:[\"Enter\",\"Enter\"], 16:[\"Shift\",\"\"], 17:[\"Ctrl\",\"\"]                 , 20:[\"\",\"caps\"], 32:[\" \",\" \"], 45:[\"-\",\"=\"], 48:[\"0\",\"\"], 49:[\"1\",\"!\"], 50:[\"2\",'\"'], 51:[\"3\",\"#\"]                 , 52:[\"4\",\"$\"], 53:[\"5\",\"%\"], 54:[\"6\",\"&\"], 55:[\"7\",\"'\"], 56:[\"8\",\"(\"], 57:[\"9\",\")\"], 58:[\":\",\"*\"]                 , 59:[\";\",\"+\"], 61:[\";\",\"+\"], 64:[\"@\",\"`\"], 65:[\"a\",\"A\"], 66:[\"b\",\"B\"], 67:[\"c\",\"C\"], 68:[\"d\",\"D\"]                 , 69:[\"e\",\"E\"], 70:[\"f\",\"F\"], 71:[\"g\",\"G\"], 72:[\"h\",\"H\"], 73:[\"i\",\"I\"], 74:[\"j\",\"J\"], 75:[\"k\",\"K\"]                 , 76:[\"l\",\"L\"], 77:[\"m\",\"M\"], 78:[\"n\",\"N\"], 79:[\"o\",\"O\"], 80:[\"p\",\"P\"], 81:[\"q\",\"Q\"], 82:[\"r\",\"R\"]                 , 83:[\"s\",\"S\"], 84:[\"t\",\"T\"], 85:[\"u\",\"U\"], 86:[\"v\",\"V\"], 87:[\"w\",\"W\"], 88:[\"x\",\"X\"], 89:[\"y\",\"Y\"]                 , 90:[\"z\",\"Z\"], 92:[\"\\\\\",\"_\"], 96:[\"0\",\"\"], 97:[\"1\",\"\"], 98:[\"2\",\"\"], 99:[\"3\",\"\"], 100:[\"4\",\"\"], 101:[\"5\",\"\"]                 , 102:[\"6\",\"\"], 103:[\"7\",\"\"], 104:[\"8\",\"\"], 105:[\"9\",\"\"], 107:[\";\",\"+\"], 109:[\"-\",\"=\"], 160:[\"^\",\"~\"]                 , 173:[\"-\",\"=\"], 186:[\":\",\"*\"], 187:[\";\",\"+\"], 188:[\",\",\"ï¼œ\"], 189:[\"-\",\"=\"], 190:[\".\",\"ï¼\"], 191:[\"/\",\"?\"]                 , 192:[\"@\",\"`\"], 219:[\"[\",\"{\"], 220:[\"\\\\\",\"_\"], 221:[\"]\",\"}\"], 222:[\"^\",\"~\"], 226:[\"\\\\\",\"_\"], 222:[\"^\",\"~\"]                 , 240:[\"è‹±æ•°\",\"\"], 244:[\"åŠ/å…¨\",\"\"]};  var capslist = {8:[\"BackSpase\",\"BackSpace\"], 9:[\"Tab\",\"Tab\"], 13:[\"Enter\",\"Enter\"], 16:[\"Shift\",\"\"], 17:[\"Ctrl\",\"\"]                 , 20:[\"\",\"caps\"], 32:[\" \",\" \"], 45:[\"-\",\"=\"], 48:[\"0\",\"\"], 49:[\"1\",\"!\"], 50:[\"2\",'\"'], 51:[\"3\",\"#\"]                 , 52:[\"4\",\"$\"], 53:[\"5\",\"%\"], 54:[\"6\",\"&\"], 55:[\"7\",\"'\"], 56:[\"8\",\"(\"], 57:[\"9\",\")\"], 58:[\":\",\"*\"]                 , 59:[\";\",\"+\"], 61:[\";\",\"+\"], 64:[\"@\",\"`\"], 65:[\"A\",\"a\"], 66:[\"B\",\"b\"], 67:[\"C\",\"c\"], 68:[\"D\",\"d\"]                 , 69:[\"E\",\"e\"], 70:[\"F\",\"f\"], 71:[\"G\",\"g\"], 72:[\"H\",\"h\"], 73:[\"I\",\"i\"], 74:[\"J\",\"j\"], 75:[\"K\",\"k\"]                 , 76:[\"L\",\"l\"], 77:[\"M\",\"m\"], 78:[\"N\",\"n\"], 79:[\"O\",\"o\"], 80:[\"P\",\"p\"], 81:[\"Q\",\"q\"], 82:[\"R\",\"r\"]                 , 83:[\"S\",\"s\"], 84:[\"T\",\"t\"], 85:[\"U\",\"u\"], 86:[\"V\",\"v\"], 87:[\"W\",\"w\"], 88:[\"X\",\"x\"], 89:[\"Y\",\"y\"]                 , 90:[\"Z\",\"z\"], 92:[\"\\\\\",\"_\"], 96:[\"0\",\"\"], 97:[\"1\",\"\"], 98:[\"2\",\"\"], 99:[\"3\",\"\"], 100:[\"4\",\"\"], 101:[\"5\",\"\"]                 , 102:[\"6\",\"\"], 103:[\"7\",\"\"], 104:[\"8\",\"\"], 105:[\"9\",\"\"], 107:[\";\",\"+\"], 109:[\"-\",\"=\"], 160:[\"^\",\"~\"]                 , 173:[\"-\",\"=\"], 186:[\":\",\"*\"], 187:[\";\",\"+\"], 188:[\",\",\"ï¼œ\"], 189:[\"-\",\"=\"], 190:[\".\",\"ï¼\"], 191:[\"/\",\"?\"]                 , 192:[\"@\",\"`\"], 219:[\"[\",\"{\"], 220:[\"\\\\\",\"_\"], 221:[\"]\",\"}\"], 222:[\"^\",\"~\"], 226:[\"\\\\\",\"_\"], 222:[\"^\",\"~\"]                 , 240:[\"è‹±æ•°\",\"\"], 244:[\"åŠ/å…¨\",\"\"]};  var leftcode = {\"!\":\"\", '\"':\"\", \"#\":\"\", \"$\":\"\", \"%\":\"\", \"&\":\"\", \"Q\":\"\", \"W\":\"\", \"E\":\"\", \"R\":\"\", \"T\":\"\", \"A\":\"\", \"S\":\"\"                 , \"D\":\"\", \"F\":\"\", \"G\":\"\", \"Z\":\"\", \"X\":\"\", \"C\":\"\", \"V\":\"\", \"B\":\"\"};  var leftcaps = {\"!\":\"\", '\"':\"\", \"#\":\"\", \"$\":\"\", \"%\":\"\", \"&\":\"\", \"q\":\"\", \"w\":\"\", \"e\":\"\", \"r\":\"\", \"t\":\"\", \"a\":\"\", \"s\":\"\"                 , \"d\":\"\", \"f\":\"\", \"g\":\"\", \"z\":\"\", \"x\":\"\", \"c\":\"\", \"v\":\"\", \"b\":\"\"};  var eachactive = {\"\\\\\":\"220\", \"|\":\"220\", \"_\":\"226\", \";\":\"187\", \"+\":\"187\", \":\":\"186\", \"*\":\"186\"};  var keyboardHTML = ''             + '<table id=\"keyboard\">'             + '<tr class=\"tr  _k\">'             + '  <td class=\"key top1\" id=\"left_20\"><span id=\"caps_20\" class=\"off\">caps</span></td>'             + '  <td class=\"key top1\" id=\"key_49\">1</td>'             + '  <td class=\"key top1\" id=\"key_50\">2</td>'             + '  <td class=\"key top1\" id=\"key_51\">3</td>'             + '  <td class=\"key top1\" id=\"key_52\">4</td>'             + '  <td class=\"key top1\" id=\"key_53\">5</td>'             + '  <td class=\"key top1\" id=\"key_54\">6</td>'             + '  <td class=\"key top1\" id=\"key_55\">7</td>'             + '  <td class=\"key top1\" id=\"key_56\">8</td>'             + '  <td class=\"key top1\" id=\"key_57\">9</td>'             + '  <td class=\"key top1\" id=\"key_48\">0</td>'             + '  <td class=\"key top1\" id=\"key_189\">-</td>'             + '  <td class=\"key top1\" id=\"key_187\">=</td>'             + '  <td class=\"key top1\" id=\"right_8\"><span id=\"backspase_8\">BackSpase</span></td>'             + '</tr>'             + '<tr class=\"tr_k\">'             + '  <td class=\"key top2\" id=\"tab_9\"><span id=\"tab_9\" class=\"off\">Tab</span></td>'             + '  <td class=\"key top2\" id=\"key_81\">Q</td>'             + '  <td class=\"key top2\" id=\"key_87\">W</td>'             + '  <td class=\"key top2\" id=\"key_69\">E</td>'             + '  <td class=\"key top2\" id=\"key_82\">R</td>'             + '  <td class=\"key top2\" id=\"key_84\">T</td>'             + '  <td class=\"key top2\" id=\"key_89\">Y</td>'             + '  <td class=\"key top2\" id=\"key_85\">U</td>'             + '  <td class=\"key top2\" id=\"key_73\">I</td>'             + '  <td class=\"key top2\" id=\"key_79\">O</td>'             + '  <td class=\"key top2\" id=\"key_80\">P</td>'             + '  <td class=\"key top2\" id=\"key_219\">[</td>'             + '  <td class=\"key top2\" id=\"key_221\">]</td>'             + '  <td class=\"key top2\" id=\"key_220\"><span id=\"yen_220\">\\\\</span></td>'             + '</tr>'             + '<tr class=\"tr_k\">'             + '  <td class=\"key top3\" id=\"left_16\"><span id=\"shift_16\" class=\"off\">Shift</span></td>'             + '  <td class=\"key top3\" id=\"key_65\">A</td>'             + '  <td class=\"key top3\" id=\"key_83\">S</td>'             + '  <td class=\"key top3\" id=\"key_68\">D</td>'             + '  <td class=\"key top3\" id=\"key_70\">F</td>'             + '  <td class=\"key top3\" id=\"key_71\">G</td>'             + '  <td class=\"key top3\" id=\"key_72\">H</td>'             + '  <td class=\"key top3\" id=\"key_74\">J</td>'             + '  <td class=\"key top3\" id=\"key_75\">K</td>'             + '  <td class=\"key top3\" id=\"key_76\">L</td>'             + '  <td class=\"key top3\" id=\"key_186\">;</td>'             + '  <td class=\"key top3\" id=\"key_222\">\\'</td>'             + '  <td class=\"key top3\" id=\"key_13\"><span id=\"enter_13\" class=\"off\">Enter</span></td>'             + '</tr>'             + '<tr class=\"tr_k\">'             + '  <td class=\"key top4\" id=\"left_240\"><span id=\"moji_240\" class=\"off\">è‹±æ•°</span></td>'             + '  <td class=\"key top4\" id=\"left_17\"><span id=\"ctrl_17\" class=\"off\">Ctrl</span></td>'             + '  <td class=\"key top4\" id=\"left_91\"><span id=\"win_91\" class=\"off\">Win</span></td>'             + '  <td class=\"key top4\" id=\"left_244\"><span id=\"kana_244\" class=\"off\">åŠ/å…¨</span></td>'             + '  <td class=\"key top4\" id=\"key_32\"><span id=\"space_32\" class=\"off\">Space</span></td>'             + '  <td class=\"key top4\" id=\"right_91\"><span id=\"menu_91\" class=\"off\">Menu</span></td>'             + '  <td class=\"key top4\" id=\"right_240\"><span id=\"moji_240\" class=\"off\">è‹±æ•°</span></td>'             + '  <td class=\"key top4\" id=\"right_18\"><span id=\"alt_18\" class=\"off\">Alt</span></td>'             + '  <td class=\"key top4\" id=\"left_32\"><span id=\"space_32\" class=\"off\">Space</span></td>'             + '  <td class=\"key top4\" id=\"right_18\"><span id=\"alt_18\" class=\"off\">Alt</span></td>'             + '</tr>'             + '</table>';  class Typing {      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Constructor     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     constructor() {          this.capslock = \"\"     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Insert the HTML of the keyboard     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     insertKeyboard(id) {         document.getElementById(id).innerHTML = keyboardHTML;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Get the inputted character     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     checkWord(event) {          var keycode, shiftcode, chara  \t\tkeycode = event.keyCode;         shiftcode = event.shiftKey;          if(this.capslock==1){             chara = this.getCapsChar(keycode, shiftcode);           }else{             chara = this.getChar(keycode, shiftcode);         }          return chara;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Check CapsLock and retrieve its state     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     checkCapsLock(onKeyUpEvent) {          if(onKeyUpEvent.getModifierState(\"CapsLock\") == false) {             console.log(\"CapsLock OFF\");             this.capslock = 0;         }         else {             console.log(\"CapsLock ON\");             this.capslock = 1;         }          return this.capslock;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Retrieve a character from the key code and shift state     // Note: CapsLock OFF     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     getChar(keycode, shiftcode){         var chara;          if(keycode in codeList){             if(shiftcode){                    chara = codeList[keycode][1];             }else{                    chara = codeList[keycode][0];             }         }else{             chara = \"\";         }         return chara;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Retrieve a character from the key code and shift state     // Note: CapsLock ON     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     getCapsChar(keycode, shiftcode){         var chara;          if(keycode in capsList){             if(shiftcode){                    chara = capsList[keycode][1];             }else{                    chara = capsList[keycode][0];             }         }else{             chara = \"\";         }         return chara;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Update the color state of the keyboard     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     active(statement, numOfStatement){          var ichi = numOfStatement;          // Position of the statement (which one)         var mondai = statement;             // The statement         var mondaiLen = statement.length;   // Length of the statement          var left, list;          this.resetActive();         if(this.capslock==1){             // CapsLock: ON             left=leftCaps;             list=capsList;         }else{             // CapsLock: OFF             left=leftCode;             list=codeList;         }         if(ichi!=mondaiLen){             for(var i in list){                 if(list[i][0]==mondai.charAt(ichi)){                     if(mondai.charAt(ichi) in eachActive){                             this.setActive(\"code\"+('00'+eachActive[mondai.charAt(ichi)]).slice(-3),0);                     }else{                             this.setActive(\"code\"+('00'+i).slice(-3),0);                     }                 }else if(list[i][1]==mondai.charAt(ichi)){                     if(mondai.charAt(ichi) == \"_\"){                             this.setActive(\"code226\",0);                     }else if(mondai.charAt(ichi) == \"|\"){                             this.setActive(\"code220\",0);                     }else{                             this.setActive(\"code\"+('00'+i).slice(-3),0);                     }                     if(list[i][1] in left){                             this.setActive(\"code016\",1);                     }else{                             this.setActive(\"code016\",0);                     }                 }             }         }     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Apply color to the target key.     // Note: targetClass -> The class to which color will be applied     //       targetNo    -> If there are multiple targets to be colored, which one to color     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     setActive(targetClass,targetNo){         var allElements;         var elementName;          var foundElements = new Array();         if (document.all){             allElements = document.all;         }else {             allElements = document.getElementsByTagName(\"*\");         }         var elementsLen;         var j=0;         for(var i=0,elementsLen=allElements.length;i<elementsLen;i++){             elementName = allElements[i].className;             if(elementName.indexOf(targetClass,0) > -1) {                 foundElements[j] = allElements[i];                 j++;             }         }         foundElements[targetNo].style.background=\"#00ffff\";     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Remove the color from the key.     // Note:     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     resetActive(){         var allElements;         var elementName;          if (document.all){             allElements = document.all;         }else {             allElements = document.getElementsByTagName(\"*\");         }         var elementsLen;         for(var i=0,elementsLen=allElements.length;i<elementsLen;i++){             elementName = allElements[i].className;             if(elementName.indexOf(\"table\",0) > -1) {                 allElements[i].style.background=\"#ffffff\";             }         }     } } ```  The script appears to define a JavaScript class called `Typing` that handles keyboard input. It defines dictionaries for keyboard key codes and their corresponding characters in both lowercase and uppercase states. It also defines some other properties and methods related to handling keyboard input.  The script also seems to define HTML markup for a virtual keyboard, including various keys and their IDs.  The `Cursor` class seems to handle the cursor animation and positioning. It sets the cursor's style, position, and visibility. It provides methods for starting and stopping cursor movement and handling text input.  Finally, the script adds a button to the document that toggles the virtual keyboard's visibility when clicked.  To use this script, you would need to integrate it into an HTML document and ensure that the necessary HTML elements and styles are present for the virtual keyboard to work correctly. Additionally, event listeners and handlers may need to be set up to capture keyboard input and update the virtual keyboard accordingly. "
    },
    "_id": "blog/12-typing-game-js.mdx",
    "_raw": {
      "sourceFilePath": "blog/12-typing-game-js.mdx",
      "sourceFileName": "12-typing-game-js.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/12-typing-game-js"
    },
    "type": "Post",
    "slug": "/blog/12-typing-game-js",
    "slugAsParams": "12-typing-game-js"
  },
  {
    "title": "Python | Line, Discord,Slackã¸ã®é€šçŸ¥ã‚¯ãƒ©ã‚¹",
    "description": "Python ã§Lineã€Discordã€Slackã¸ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’é€ã£ã¦é€šçŸ¥ã™ã‚‹ã‚¯ãƒ©ã‚¹ã®ã‚µãƒ³ãƒ—ãƒ«",
    "date": "2020-03-10T00:00:00.000Z",
    "emoji": "ğŸ“¨",
    "tags": ["python"],
    "published": true,
    "body": {
      "raw": " Python ã§Lineã€Discordã€Slackã¸ã€ãƒ†ã‚­ã‚¹ãƒˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€ã‚’é€ã£ã¦é€šçŸ¥ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚  [ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/notification-python)  ## æ¦‚è¦ API ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚„ Webhook URL ã‚’ã‚»ãƒƒãƒˆã—ã€ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¾ã›ã‚‹ã“ã¨ã§é€šçŸ¥ã‚’é€ã‚‹æ©Ÿèƒ½ã‚’å‚™ãˆã¦ã„ã¾ã™ã€‚  ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ã„ã†ã»ã©ã§ã‚‚ãªã„ã§ã™ãŒã€é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆnotification.pyï¼‰ã¨ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆdebug.pyï¼‰ã‚’æº–å‚™ã—ã¾ã—ãŸã€‚  ```text py_notification |-notification.py |-debug.py ```  ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ ãƒ¡ã‚¤ãƒ³å‡¦ç†ï¼ˆdebug.pyï¼‰ ã§ é€šçŸ¥ã‚¯ãƒ©ã‚¹ï¼ˆnotification.pyï¼‰ ã‚’å‘¼ã³å‡ºã—ã¦é€šçŸ¥ã‚’å®Ÿè¡Œã•ã›ã¾ã™ã€‚  ___ ### â‘ notification.py  ```py import requests import json  class Notification():     \"\"\"     @brief : é€šçŸ¥ã‚¯ãƒ©ã‚¹     @note  :     \"\"\"     line_notify_token = ''     discord_webhook_url = ''     discord_username = ''     slack_webhook_url = ''     slack_username = ''      def __init__(self):         print(\"Notification ã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–\")      # ----- LINE, DISCORD, SLACK ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ãŸã‚ã®åˆæœŸè¨­å®š é–¢é€£----     def set_line(self, token):         self.line_notify_token = token      def set_discord(self, url, username):         self.discord_webhook_url = url         self.discord_username = username      def set_slack(self, url, username):         self.slack_webhook_url = url         self.slack_username = username              # ----- Notifyï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ã‚‹ï¼‰ é–¢é€£-----     def send_message(self, text) :         try:             self.__line(text)         except:             pass         try:             self.__discord(text)         except:             pass         try:             self.__slack(text)         except:             pass      def __line(self, message):         if len(self.line_notify_token) > 0:             requests.post('https://notify-api.line.me/api/notify', headers={'Authorization': 'Bearer ' + self.line_notify_token}, data={'message': '\\n' + message})             print(message + \" by Line\")      def __discord(self, message):         if len(self.discord_webhook_url) > 0:             requests.post(self.discord_webhook_url, data={'username': self.discord_username, 'content': message})             print(message + \" by Discord\")      def __slack(self, message):         if len(self.slack_webhook_url) > 0:             requests.post(self.slack_webhook_url, data=json.dumps({'username': self.slack_username, 'text':message}))             print(message + \" by Slack\") ```  ___ ### â‘¡debug.py ```py import sys  # è‡ªä½œã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã«å‚ç…§å…ˆã‚’è¿½åŠ  sys.path.append(\"..\") # print(sys.path)  # ã‚¯ãƒ©ã‚¹èª­ã¿è¾¼ã¿ï¼šfrom <ãƒ•ã‚¡ã‚¤ãƒ«å> import <ã‚¯ãƒ©ã‚¹å> from notification import Notification  notify = Notification() line_token          = \"LINE ã® ãƒˆãƒ¼ã‚¯ãƒ³ ã‚’ã“ã“ã«å…¥åŠ›\" discord_webhook_url = \"Discord ã® Webhook URL ã‚’ã“ã“ã«å…¥åŠ›\" slack_webhook_url   = \"Slack ã® Webhook URL ã‚’ã“ã“ã«å…¥åŠ›\"  notify.set_line(line_token) notify.set_discord(discord_webhook_url, \"bot\") notify.set_slack(slack_webhook_url, \"bot\")  notify.send_message(\"test message\") ```  è©°ã¾ã‚Šã‚„ã™ã„ã®ãŒã€è‡ªä½œã‚¯ãƒ©ã‚¹ã‚’å‘¼ã³å‡ºã™ç‚¹ã‹ã¨æ€ã„ã¾ã™ã€‚ ä»Šå›ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ãŒã€   `from notification import Notification`   `from <ãƒ•ã‚¡ã‚¤ãƒ«å> import <ã‚¯ãƒ©ã‚¹å>`ã€€ã¨ã„ã†ã‚ˆã†ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚    ã¾ãŸã€è‡ªä½œã‚¯ãƒ©ã‚¹ã‚’è¿½åŠ ã™ã‚‹éš›ã¯å‚ç…§å…ˆã‚’ syspath.append ã§è¿½åŠ ã™ã‚‹ã“ã¨ã‚’å¿˜ã‚Œãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚  ä»¥ä¸Šã§ã™ã€‚  ä½™è«‡ã§ã™ãŒã€ã‚„ã¯ã‚ŠPythonã¯æ›¸ãã‚„ã™ãã€ã‚³ãƒ¼ãƒ‰ãŒãã‚Œã„ã ã¨æ”¹ã‚ã¦æ„Ÿã˜ã¾ã—ãŸã€‚ "
    },
    "_id": "blog/13-notify-line-discord-slack-python.mdx",
    "_raw": {
      "sourceFilePath": "blog/13-notify-line-discord-slack-python.mdx",
      "sourceFileName": "13-notify-line-discord-slack-python.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/13-notify-line-discord-slack-python"
    },
    "type": "Post",
    "slug": "/blog/13-notify-line-discord-slack-python",
    "slugAsParams": "13-notify-line-discord-slack-python"
  },
  {
    "title": "Python | å‘½åè¦å‰‡ã¾ã¨ã‚",
    "description": "Pythonã®å‘½åè¦å‰‡ï¼ˆä¾‹ï¼‰",
    "date": "2020-03-11T00:00:00.000Z",
    "emoji": "ğŸ",
    "tags": ["python"],
    "published": true,
    "body": {
      "raw": " Pythonã®å‘½åè¦å‰‡ã«ã¤ã„ã¦è‡ªåˆ†ãªã‚Šã®è€ƒãˆã‚’æ•´ç†ã—ã¾ã—ãŸã€‚  ## å‘½åè¦å‰‡ |å¯¾è±¡|ãƒ«ãƒ¼ãƒ«|ä¾‹| |:--|:--|:--| ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸|å…¨å°æ–‡å­— ãªã‚‹ã¹ãçŸ­ãã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢éæ¨å¥¨|tqdm, requests â€¦ ãƒ•ã‚¡ã‚¤ãƒ«|å…¨å°æ–‡å­—|notification ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«|å…¨å°æ–‡å­— ãªã‚‹ã¹ãçŸ­ãã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢å¯|sys, os,â€¦ ã‚¯ãƒ©ã‚¹|æœ€åˆå¤§æ–‡å­— + å¤§æ–‡å­—åŒºåˆ‡ã‚Š|MyFavoriteClass ä¾‹å¤–|æœ€åˆå¤§æ–‡å­— + å¤§æ–‡å­—åŒºåˆ‡ã‚Š|MyFuckingError å‹å¤‰æ•°|æœ€åˆå¤§æ–‡å­— + å¤§æ–‡å­—åŒºåˆ‡ã‚Š|MyFavoriteType ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆpublicï¼‰|å…¨å°æ–‡å­— + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Š|my_favorite_method ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆprivateï¼‰|ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢Ã—2 + å…¨å°æ–‡å­— + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Š|__my_favorite_method é–¢æ•°|å…¨å°æ–‡å­— + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Š|my_favorite_funcion å¤‰æ•°|å…¨å°æ–‡å­— + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Š|my_favorite_instance å®šæ•°|å…¨å¤§æ–‡å­— + ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢åŒºåˆ‡ã‚Š|MY_FAVORITE_CONST  ## å‚è€ƒè¨˜äº‹ [Pythonå‘½åè¦å‰‡ä¸€è¦§](https://qiita.com/naomi7325/items/4eb1d2a40277361e898b)  [ã€ŒPythonicè‰²ã€…ã€ Pythonã®ã‚¢ãƒ³ãƒ€ãƒ¼ã‚¹ã‚³ã‚¢( _ )ã‚’ä½¿ã„ã“ãªãã†ï¼](https://medium.com/lsc-psd/pythonic%E8%89%B2%E3%80%85-python%E3%81%AE%E3%82%A2%E3%83%B3%E3%83%80%E3%83%BC%E3%82%B9%E3%82%B3%E3%82%A2-%E3%82%92%E4%BD%BF%E3%81%84%E3%81%93%E3%81%AA%E3%81%9D%E3%81%86-3c132842eeef ) "
    },
    "_id": "blog/14-naming-rule-python.mdx",
    "_raw": {
      "sourceFilePath": "blog/14-naming-rule-python.mdx",
      "sourceFileName": "14-naming-rule-python.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/14-naming-rule-python"
    },
    "type": "Post",
    "slug": "/blog/14-naming-rule-python",
    "slugAsParams": "14-naming-rule-python"
  },
  {
    "title": "VBA | Excelã‹ã‚‰SQL Plusã‚’å®Ÿè¡Œã—ã¦ã‚»ãƒƒã‚·ãƒ§ãƒ³åˆ‡æ–­",
    "description": "Oracle ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å¼·åˆ¶è§£é™¤ã™ã‚‹æ–¹æ³•",
    "date": "2020-03-12T00:00:00.000Z",
    "emoji": "âœ„",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": "âœ„ Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½¿ã£ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€èª°ã‹ãŒã‚¢ãƒ—ãƒªã‚’æ“ä½œã—ãŸã¾ã¾ã¨ãªã‚Šã€ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒãƒ­ãƒƒã‚¯ã•ã‚ŒãŸçŠ¶æ…‹ã«ãªã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚  ä»Šå›ã€ãã®ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’è§£é™¤ã™ã‚‹ãŸã‚ã€ Excelã‹ã‚‰SQL Plus ã‚’å®Ÿè¡Œã—ã¦ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å¼·åˆ¶åˆ‡æ–­ï¼ˆãƒ­ãƒƒã‚¯è§£é™¤ï¼‰ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚  [ã‚µãƒ³ãƒ—ãƒ«ã®Excelã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://github.com/atman-33/template-excel-vba/tree/main/SQLPlus%E5%AE%9F%E8%A1%8C_Oracle%E3%82%BB%E3%83%83%E3%82%B7%E3%83%A7%E3%83%B3%E5%88%87%E6%96%AD)  ## æ¦‚è¦ ã¾ãšã€OracleãŒãƒ­ãƒƒã‚¯çŠ¶æ…‹ã«ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚  ä¸‹è¨˜ã®SQLã‚’ã€SQL Developer ã‚„SQL Plusu ã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€   ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’å¼•ãèµ·ã“ã—ã¦ã„ã‚‹ã®ãŒ **ã©ã“ã‹ã‚‰ï¼ˆã©ã®PCã‹ã‚‰ï¼‰ã®æ¥ç¶šãªã®ã‹** ç¢ºèªã§ãã¾ã™ã€‚  ```sql select    s.sid, s.serial#, s.username, s.osuser, s.machine, s.terminal, s.program, o.object_name  from    v$session s, v$locked_object l, dba_objects o  where    s.sid = l.session_id and l.object_id = o.object_id ```  ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã®å ´åˆã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒæŠ½å‡ºã•ã‚Œã¾ã™ã€‚  ![image](/blog/15/oracle-lock.png)  ãƒ­ãƒƒã‚¯çŠ¶æ…‹ã‚’è§£é™¤ã™ã‚‹ã«ã¯ã€æŠ½å‡ºã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã®ä¸­ã«ã‚ã‚‹SIDã¨SERIAL#ãŒå¿…è¦ã¨ãªã‚Šã¾ã™ã€‚ ï¼ˆä¸Šã®ä¾‹ã§ã¯ã€ SID=277, SERIAL#=18621ï¼‰  ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚  ```text æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |- Main |- ModuleSqlPlus ```  main ã‹ã‚‰ modSqlPlus ã®é–¢æ•°ã‚’å‘¼ã³å‡ºã™ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹é€ ã§ã™ã€‚  ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ Excelã®VBAã€ã„ã‚ã‚†ã‚‹ãƒã‚¯ãƒ­å‡¦ç†ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ãªã‚Šã¾ã™ã€‚  ___ ### â‘ ModuleSqlPlus SQL Plus ã‹ã‚‰SQLã‚’å®Ÿè¡Œã™ã‚‹ãŸã‚ã«å¿…è¦ãªé–¢æ•°ã‚’æ ¼ç´ã—ã¦ã„ã¾ã™ã€‚  ```vb Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : SQLæ–‡ã‹ã‚‰SQLPlusã‚’å®Ÿè¡Œ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub Sqlplus(user As String, password As String, serviceName As String, sql As String)      Dim sqlFile As String      ' å®Ÿè¡Œã™ã‚‹SQLãƒ•ã‚¡ã‚¤ãƒ«     sqlFile = \"temp.sql\"      ' SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ     CreateSqlFile sqlFile, sql     Debug.Print \"ã€å®Ÿè¡Œã™ã‚‹SQLæ–‡ã€‘\"     Debug.Print \"---- ---- ----\"     Debug.Print sql     Debug.Print \"---- ---- ----\"      ' SQLPLUSã‹ã‚‰SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ     SqlplusFromFile user, password, serviceName, sqlFile      ' SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤     KillSqlFile sqlFile  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : SQLãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰SQLPlusã‚’å®Ÿè¡Œ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub SqlplusFromFile(user As String, password As String, serviceName As String, sqlFile As String)      Dim cmd As String     'ã‚·ã‚§ãƒ«ã‚³ãƒãƒ³ãƒ‰     Dim objWSH As Object  'WSH      cmd = \"sqlplus \" & user & \"/\" & password & \"@\" & serviceName & \" as sysdba \" & \"@\" & ActiveWorkbook.Path & \"\\\" & sqlFile     Debug.Print \"ORACLE; sqlplusã‚’å®Ÿè¡Œ\"     Debug.Print cmd      'éåŒæœŸã§å®Ÿè¡Œã•ã‚Œã‚‹     'Call Shell(cmd, vbHide)  On Error GoTo Exception     'åŒæœŸã§å®Ÿè¡Œã™ã‚‹     Set objWSH = CreateObject(\"WScript.Shell\")     objWSH.Run cmd, 1, True      GoTo Finally  Exception:      Call MsgBox(Err.Description, vbOKOnly, \"ç•°å¸¸çµ‚äº†\")     GoTo Finally  Finally:      Set objWSH = Nothing              ' ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’è§£æ”¾  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ‡ã‚‹SQLã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿæ–½ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub KillSession(user As String, password As String, serviceName As String, sid As String, serial As String)      Dim sql As String      ' å®Ÿè¡Œã™ã‚‹SQL     sql = \"alter system kill session '\" & sid & \",\" & serial & \"';\" & vbCrLf & \"exit;\"      Sqlplus user, password, serviceName, sql  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub CreateSqlFile(fileName As String, sql As String)     Dim strFilePath As String     strFilePath = ActiveWorkbook.Path & \"\\\" & fileName 'ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹      Debug.Print \"ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆï¼š\" & strFilePath     Open strFilePath For Output As #1     Print #1, sql     Close #1  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : SQLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub KillSqlFile(fileName As String)     Dim strFilePath As String     strFilePath = ActiveWorkbook.Path & \"\\\" & fileName 'ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹      Debug.Print \"ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤é–‹å§‹ï¼š\" & strFilePath     Kill strFilePath  End Sub ```  SQL Plus Windows Shellã€ã¤ã¾ã‚Šã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  ãã®ãŸã‚ã€ä¸€åº¦SQLæ–‡ãŒæ ¼ç´ã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’SQL Plus ã§å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚  ___ ### â‘¡Main Oracleæ¥ç¶šã—ã¦ã„ã‚‹ï¼ˆãƒ­ãƒƒã‚¯ã—ã¦ã„ã‚‹ï¼‰ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ‡æ–­ã—ã¾ã™ã€‚  ```vb Option Explicit  ' ãƒ¡ã‚¤ãƒ³å‡¦ç† Public Sub Main()      Dim user As String     Dim password As String     Dim serviceName As String     Dim sid As String     Dim serial As String      user = \"sys\"     password = \"1234\"     serviceName = \"TESTDB\"      sid = \"277\"     serial = \"16127\"      ' Oracleæ¥ç¶šã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’åˆ‡æ–­     KillSession user, password, serviceName, sid, serial      Debug.Print \"å‡¦ç†çµ‚äº†\"  End Sub ```  ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€modSqlPlusãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®killSession ã‚’å‘¼ã³å‡ºã—ã¦ã€ãã®å¼•æ•°ã«å¿…è¦ãªSIDã¨SERIAL#ã‚’æ¸¡ã—ã¦ã„ã¾ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/15-kill-oracle-session-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/15-kill-oracle-session-excel-vba.mdx",
      "sourceFileName": "15-kill-oracle-session-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/15-kill-oracle-session-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/15-kill-oracle-session-excel-vba",
    "slugAsParams": "15-kill-oracle-session-excel-vba"
  },
  {
    "title": "WordPress | Google AdSenseã®ads.txtè¨­ç½®æ–¹æ³•",
    "description": "WordPress ã«ãŠã‘ã‚‹ ads.txt ã®è¨­ç½®æ–¹æ³•",
    "date": "2020-03-14T00:00:00.000Z",
    "emoji": "ğŸ›œ",
    "tags": ["wordpress", "googleAdsense"],
    "published": true,
    "body": {
      "raw": " Google AdSense ã‚’ä½¿ã£ã¦ã„ã‚‹ã¨ã€è‡ªåˆ†ã®ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã«ä¸‹è¨˜ã®ã‚ˆã†ãªã‚¢ãƒ©ãƒ¼ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™  ![image](/blog/16/google-adsense-alert.png)  Google ã®ãƒ˜ãƒ«ãƒ—ã«ã‚ˆã‚‹ã¨ã€ads.txtã¯åºƒå‘Šæ ãŒå½ç‰©ã§ãªã„ã¨åˆ¤åˆ¥ã§ãã‚‹ã‚ˆã†ã«ãªã‚‹ã¨è¨˜è¼‰ã•ã‚Œã¦ãŠã‚Šæ¨å¥¨ã•ã‚Œã¦ã„ã¾ã™ã€‚  >ads.txt ã¯ã€ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’å¼·ããŠã™ã™ã‚ã—ã¾ã™ã€‚ads.txt ã‚’ä½¿ç”¨ã™ã‚Œã°ã€è³¼å…¥è€…ãŒå½ã®åºƒå‘Šæ ã‚’åˆ¤åˆ¥ã§ãã‚‹ãŸã‚ã€ã‚µã‚¤ãƒˆé‹å–¶è€…æ§˜ã¨ã—ã¦ã‚‚å½ã®åºƒå‘Šæ ã«åç›ŠãŒæµã‚Œã‚‹ã®ã‚’é˜»æ­¢ã—ã€ãã®åˆ†åç›Šã‚’å¢—ã‚„ã™ã“ã¨ãŒã§ãã‚‹ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆãŒã‚ã‚Šã¾ã™ã€‚ > > https://support.google.com/adsense/answer/7532444?hl=ja  ãã®ãŸã‚ã«ã¯ã€Google AdSense ã§å…¥æ‰‹ã—ãŸ ads.txt ã‚’Webã‚µãƒ¼ãƒãƒ¼ã®ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã—ãªãã¦ã¯ãªã‚Šã¾ã›ã‚“ã€‚   AWSã«ã‚ˆã‚ŠWordPressã‚’æ§‹ç¯‰ã—ãŸéš›ã€ads.txtã®è¨­ç½®å ´æ‰€ã«å°‘ã—ãƒãƒã‚Šã¾ã—ãŸã®ã§è¨˜äº‹ã«æ®‹ã—ã¦ãŠãã¾ã™ã€‚   ## æ‰‹é †  ___ ### â‘ ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹WordPressãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ã¾ãšãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒã©ã“ãªã®ã‹ï¼Ÿã¨ã„ã†ã“ã¨ãªã®ã§ã™ãŒã€çµè«–ã‹ã‚‰ã„ã†ã¨Webã‚µã‚¤ãƒˆã®Topãƒšãƒ¼ã‚¸ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã§ã™ã€‚  WordPressã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã™ã‚‹æ–¹æ³•ã¯ã„ãã¤ã‹ã‚ã‚‹ã®ã§ã™ãŒã€ã“ã“ã§ã¯ **Advanced File Manager** ã¨ã„ã†ä¾¿åˆ©ãªãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã¨ã—ã¾ã™ã€‚  ä¸‹è¨˜ã®ã‚ˆã†ã«ã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¿½åŠ ã§ Advanced Fie Manager ã‚’æ¤œç´¢ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  ![image](/blog/16/advanced-file-manager.png)  ___ ### â‘¡ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ads.txtã‚’ä¿å­˜ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’è¿½åŠ ã—ã¦æœ‰åŠ¹åŒ–ã™ã‚‹ã¨ã€WordPressã®ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã«ã€File Managerã€ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚  ãã® File Manager ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ **å·¦ã‚¿ãƒ–ã®ã€htmlã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹éƒ¨åˆ†ãŒãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª** ã§ã™ã€‚  å¾Œã¯ ads.txt ã‚’ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ä¿å­˜ã™ã‚Œã°å®Œäº†ã§ã™ã€‚  ![image](/blog/16/wordpress-file-manager.png)  ãƒ«ãƒ¼ãƒˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ Top Page ã€ã¤ã¾ã‚Š WordPress ã§ã„ãˆã°ã€index.php ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ«ãƒ€ã¨ãªã‚Šã¾ã™ã€‚  å‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/16-set-google-adsense-file-wordpress.mdx",
    "_raw": {
      "sourceFilePath": "blog/16-set-google-adsense-file-wordpress.mdx",
      "sourceFileName": "16-set-google-adsense-file-wordpress.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/16-set-google-adsense-file-wordpress"
    },
    "type": "Post",
    "slug": "/blog/16-set-google-adsense-file-wordpress",
    "slugAsParams": "16-set-google-adsense-file-wordpress"
  },
  {
    "title": "VBA | Excelã®å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã—ã¦åˆ†å‰²ä¿å­˜",
    "description": "Excel VBA ã§ å„ã‚·ãƒ¼ãƒˆã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«å‡ºåŠ›ã™ã‚‹æ–¹æ³•",
    "date": "2020-03-15T00:00:00.000Z",
    "emoji": "ğŸ†",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " Excelã§ãƒãƒ‹ãƒ¥ã‚¢ãƒ«ãªã©ä½œæˆã—ã¦ã„ã‚‹ã¨ã€ã‚·ãƒ¼ãƒˆæ•°ãŒå¤šããªã‚Šã™ãã¦ãƒ•ã‚¡ã‚¤ãƒ«è‡ªä½“ãŒé‡ããªã£ãŸã‚Šã€Excelã®å‹•ä½œãŒé‡ããªã£ãŸã‚Šã™ã‚‹ã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ  ãã®ã‚ˆã†ãªå ´åˆã«ä½¿ãˆãã†ãªã€Excelã®å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã—ã¦åˆ†å‰²ä¿å­˜ã™ã‚‹ãƒã‚¯ãƒ­ã‚’ä½œæˆã—ã¾ã—ãŸã®ã§èª¬æ˜ã—ã¾ã™ã€‚  [ã‚µãƒ³ãƒ—ãƒ«ã®Excelã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://github.com/atman-33/template-excel-vba/tree/main/Excel%E3%82%B7%E3%83%BC%E3%83%88%E3%82%92%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AB%E5%88%87%E3%82%8A%E5%87%BA%E3%81%97%E5%87%BA%E5%8A%9B)   ## æ¦‚è¦ ä»Šå›ã®ãƒã‚¯ãƒ­æ©Ÿèƒ½ã¯ã€ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚  - ãƒã‚¯ãƒ­ã‚’å®Ÿè¡Œï¼ˆãƒœã‚¿ãƒ³æŠ¼ä¸‹ï¼‰ - å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ†å‰²ã—ãŸã„Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠ - é¸æŠãƒ•ã‚¡ã‚¤ãƒ«ã®å„ã‚·ãƒ¼ãƒˆã‚’Excelãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦åˆ‡ã‚Šå‡ºã—ä¿å­˜ ï¼ˆé¸æŠã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒãƒ•ã‚©ãƒ«ãƒ€å†…ï¼‰ - ãƒã‚¯ãƒ­å®Ÿè¡ŒExcelãƒ•ã‚¡ã‚¤ãƒ«ã«ã€åˆ‡ã‚Šå‡ºã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒªãƒ³ã‚¯å…ˆä¸€è¦§ã€ã‚’ç”Ÿæˆ  ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚  ```text Excelã®å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã—.xlsm | æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |-Main |-ModuleHelper |-ModuleSheetToFile ```  ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ Excelã®VBAã€ã„ã‚ã‚†ã‚‹ãƒã‚¯ãƒ­å‡¦ç†ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨ãªã‚Šã¾ã™ã€‚  ### â‘ Main ```vb Option Explicit  ' ãƒ¡ã‚¤ãƒ³å‡¦ç† Public Sub Main()      ' æç”»å‡¦ç†ã€è‡ªå‹•æ›´æ–°ãªã©ã‚’åœæ­¢     Focus True      ' Excelã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹å‡¦ç†     GetOpenFileSheetstSave      ' æç”»å‡¦ç†ã€è‡ªå‹•æ›´æ–°ãªã©ã‚’å†é–‹     Focus False  End Sub ``` ãƒ¡ã‚¤ãƒ³ã® GetOpenFileSheetsSave é–¢æ•°ã‚’å®Ÿè¡Œã™ã‚‹é–“ã« Focus é–¢æ•°ã‚’æº–å‚™ã—ã¾ã—ãŸã€‚   ã“ã® Focus é–¢æ•°ã§Excelã®æç”»å‡¦ç†ã€è‡ªå‹•æ›´æ–°ãªã©ã‚’åœæ­¢ã—ã¦ãŠãã“ã¨ã§ãƒã‚¯ãƒ­å®Ÿè¡Œæ™‚é–“ã‚’çŸ­ç¸®ã•ã›ã¾ã™ã€‚  ___ ### â‘ ModuleHelper  ä»Šå›ä½¿ç”¨ã™ã‚‹é–¢æ•°ã§ã™ã€‚  ```vb Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ç”»é¢æç”»ãªã©ã‚’åœæ­¢ã—ã¦å®Ÿè¡Œã‚’æ—©ãã™ã‚‹ã€‚ ' note  : Focus = True  -> æç”»åœæ­¢ã€ã‚¤ãƒ™ãƒ³ãƒˆæŠ‘åˆ¶ã€æ‰‹å‹•è¨ˆç®— '         Focus = False -> æç”»å†é–‹ã€ã‚¤ãƒ™ãƒ³ãƒˆç›£è¦–å†é–‹ã€è‡ªå‹•è¨ˆç®— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub Focus(ByVal Flag As Boolean)     With Application         .EnableEvents = Not Flag         .ScreenUpdating = Not Flag         .Calculation = IIf(Flag, xlCalculationManual, xlCalculationAutomatic)     End With End Sub ```  ___ ### â‘¡ModuleSheetToFile ãƒã‚¤ãƒ³ãƒˆã‚„è£œè¶³ã¯ã‚³ãƒ¼ãƒ‰å†…ã®ã‚³ãƒ¡ãƒ³ãƒˆã«è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  ```vb Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : é¸æŠã—ãŸExcelãƒ•ã‚¡ã‚¤ãƒ«ã®å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã— ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub GetOpenFileSheetstSave()      Dim openFilePath As String     Dim saveFolderPath As String      openFilePath = Application.GetOpenFilename(FileFilter:=\"Excelãƒ•ã‚¡ã‚¤ãƒ«,*.xlsx\")      If openFilePath <> \"False\" Then          ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒé¸æŠã•ã‚ŒãŸå ´åˆ         saveFolderPath = GetFileFolderPath(openFilePath)         SheetsSave openFilePath, saveFolderPath          MsgBox \"å‡¦ç†ã‚’å®Œäº†ã—ã¾ã—ãŸ\"     Else         MsgBox \"ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ\"     End If  End Sub   ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : å„ã‚·ãƒ¼ãƒˆã‚’ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã— ' note  : å¼•æ•°ã® excelPath, saveFolder ã¯ãƒ•ãƒ«ãƒ‘ã‚¹ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub SheetsSave(excelPath As String, saveFolderPath As String)      Dim wb As Workbook     Dim sheet As Object      Dim linkListSheetRow As Long     Dim linkListSheetName As String      linkListSheetRow = 1     linkListSheetName = \"__LinkList__\"      ' ãƒ•ã‚¡ã‚¤ãƒ«åˆ‡ã‚Šå‡ºã—å…ˆãƒªãƒ³ã‚¯ä¸€è¦§ã®ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ     CreateSheet linkListSheetName      ' ãƒ–ãƒƒã‚¯ã‚’é–‹ã     Set wb = Workbooks.Open(excelPath)      For Each sheet In wb.Worksheets          ' äº‹å‰ã«åŒåã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤         KillFile saveFolderPath & \"\\\" & sheet.name & \".xlsx\"          sheet.Copy         ActiveWorkbook.SaveAs saveFolderPath & \"\\\" & sheet.name         ActiveWorkbook.Close          ' ãƒ•ã‚¡ã‚¤ãƒ«åˆ‡ã‚Šå‡ºã—å…ˆãƒªãƒ³ã‚¯ä¸€è¦§ã¸è¿½åŠ          ThisWorkbook.Worksheets(linkListSheetName).Cells(linkListSheetRow, 1).Value = sheet.name         ThisWorkbook.Worksheets(linkListSheetName).Cells(linkListSheetRow, 2).Value = saveFolderPath & \"\\\" & sheet.name & \".xlsx\"          ' ãƒã‚¤ãƒ‘ãƒ¼ãƒªãƒ³ã‚¯è¿½åŠ ï¼ˆå¯¾è±¡ã®ã‚·ãƒ¼ãƒˆã‚’Activeã«ã™ã‚‹å¿…è¦ã‚ã‚Šï¼‰         ThisWorkbook.Worksheets(linkListSheetName).Activate         ActiveSheet.Hyperlinks.Add Anchor:=Cells(linkListSheetRow, 2), Address:=Cells(linkListSheetRow, 2).Value          linkListSheetRow = linkListSheetRow + 1      Next sheet      ' ãƒ–ãƒƒã‚¯ã‚’é–‰ã˜ã‚‹     Application.DisplayAlerts = False   'ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºã•ãªã„     wb.Close savechanges:=False         'ä¿å­˜ã›ãšã«é–‰ã˜ã‚‹     Application.DisplayAlerts = True    'ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å‡ºã™  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚·ãƒ¼ãƒˆã‚’è¿½åŠ ä½œæˆ ' note  : ä½œæˆã™ã‚‹ã‚·ãƒ¼ãƒˆã¯æœ€å¾Œå°¾ã«è¿½åŠ  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub CreateSheet(sheetName As String)      If SheetExists(sheetName) = False Then          ThisWorkbook.Worksheets.Add after:=ThisWorkbook.Worksheets(ThisWorkbook.Worksheets.Count)         ActiveSheet.name = sheetName      End If  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : æŒ‡å®šã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ã‚©ãƒ«ãƒ€ãƒ‘ã‚¹ã‚’å–å¾— ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function GetFileFolderPath(filePath As String) As String      Dim pathName As String     Dim fileName As String      fileName = Dir(filePath)     pathName = Replace(filePath, fileName, \"\")     pathName = CutRight(pathName, 1)     Debug.Print pathName & vbCrLf & fileName      GetFileFolderPath = pathName  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : æ–‡å­—åˆ—ã®å³å´ã‹ã‚‰æŒ‡å®šæ–‡å­—æ•°å‰Šé™¤ ' note  : å¼•æ•°ï¼‘ï¼šå¯¾è±¡ã®æ–‡å­—åˆ—ã€å¼•æ•°ï¼’ï¼šå‰Šé™¤æ–‡å­—æ•°ã€æˆ»ã‚Šå€¤ï¼šå‰Šé™¤å¾Œã®æ–‡å­—åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function CutRight(s, i As Long) As String     Dim iLen    As Long     ' æ–‡å­—åˆ—é•·      ' æ–‡å­—åˆ—ã§ã¯ãªã„å ´åˆ     If VarType(s) <> vbString Then         Exit Function     End If      iLen = Len(s)      ' æ–‡å­—åˆ—é•·ã‚ˆã‚ŠæŒ‡å®šæ–‡å­—æ•°ãŒå¤§ãã„å ´åˆ     If iLen < i Then         Exit Function     End If      ' æŒ‡å®šæ–‡å­—æ•°ã‚’å‰Šé™¤ã—ã¦è¿”ã™     CutRight = Left(s, iLen - i) End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : å¯¾è±¡ã®ã‚·ãƒ¼ãƒˆãŒå­˜åœ¨ã™ã‚‹ã‹åˆ¤å®š ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function SheetExists(sheetName As String) As Boolean      Dim wb As Workbook     Dim ws As Worksheet      Set wb = ThisWorkbook      On Error Resume Next     Set ws = wb.Worksheets(sheetName)     On Error GoTo 0      SheetExists = Not ws Is Nothing  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‰Šé™¤ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub KillFile(filePath As String)     Dim strFilePath As String     strFilePath = filePath 'ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹      If Dir(strFilePath) <> \"\" Then         ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã™ã‚‹         Debug.Print \"ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤é–‹å§‹ï¼š\" & strFilePath         Kill strFilePath     Else         ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„         Debug.Print \"ãƒ•ã‚¡ã‚¤ãƒ«ã¯å­˜åœ¨ã—ã¾ã›ã‚“ï¼š\" & strFilePath     End If  End Sub ```  Excelã®å„ã‚·ãƒ¼ãƒˆã‚’åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã«åˆ‡ã‚Šå‡ºã—ã¦ä¿å­˜ã™ã‚‹ã¨ã„ã†ã‚·ãƒ³ãƒ—ãƒ«ãªæ©Ÿèƒ½ã§ã™ãŒã€æ³¨æ„ã™ã¹ãç‚¹ã‚‚ã„ãã¤ã‹ã‚ã£ãŸè‰¯ã„ã‚µãƒ³ãƒ—ãƒ«ã§ã—ãŸã€‚  ä»Šå›ã®é–¢æ•°ã¯æ±ç”¨çš„ã«ã‚‚ä½¿ãˆã‚‹ãŸã‚ã€é–¢æ•°ã®ã‚¢ã‚¯ã‚»ã‚¹ä¿®é£¾å­ã‚’ private ã‹ã‚‰ public ã«å¤‰æ›´ã—ã¦æ´»ç”¨ã—ã¦ã‚‚ã‚‰ã£ã¦ã‚‚ã‚ˆã„ã‹ã¨æ€ã„ã¾ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/17-excel-sheet-to-file-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/17-excel-sheet-to-file-excel-vba.mdx",
      "sourceFileName": "17-excel-sheet-to-file-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/17-excel-sheet-to-file-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/17-excel-sheet-to-file-excel-vba",
    "slugAsParams": "17-excel-sheet-to-file-excel-vba"
  },
  {
    "title": "AWS | MySQL Workbench ã‹ã‚‰ AWS DBã«SSHæ¥ç¶š",
    "description": "AWSã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã«å¯¾ã—ã¦ã€SSHæ¥ç¶šã‚’åˆ©ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§DBã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€MySQL Workbench ã‚’ç”¨ã„ã¦DBã‚’æ“ä½œã™ã‚‹æ–¹æ³•",
    "date": "2020-04-01T00:00:00.000Z",
    "emoji": "ğŸ•·",
    "tags": ["aws"],
    "published": true,
    "body": {
      "raw": " AWSãªã©ã‚¯ãƒ©ã‚¦ãƒ‰ã«DBã‚’æ§‹ç¯‰ã—ã¦ã„ã‚‹å ´åˆã€DBé–‹ç™ºã‚’ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰è¡Œã†ãŸã‚ã«MySQL Workbenchã§æ¥ç¶šã•ã›ãŸã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚  ä»Šå›ã€SSHæ¥ç¶šã‚’åˆ©ç”¨ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼çµŒç”±ã§DBã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶šã—ã€MySQL Workbench ã‚’ç”¨ã„ã¦DBã‚’æ“ä½œå¯èƒ½ã«ã—ã¾ã™ã€‚  ## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆ ä¸‹è¨˜ã®ã‚ˆã†ãªã€è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ã§ã‚ã‚‹Webã‚µãƒ¼ãƒãƒ¼ã‚’çµŒç”±ã—ã¦DBã«æ¥ç¶šã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆã¨ã—ã¾ã™ã€‚  ![image](/blog/18/aws_system.png)  ã“ã®æ§‹æˆã«å¯¾ã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰ã€DBã‚µãƒ¼ãƒãƒ¼ã®MySQLã€ã¸MySQL Workbenchã‚’ç”¨ã„ã¦æ¥ç¶šã—ã¾ã™ã€‚  ## æ‰‹é † ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰è¸ã¿å°ã‚µãƒ¼ãƒãƒ¼ã‚’çµŒç”±ã—ã¦DBã«æ¥ç¶šã™ã‚‹ã«ã¯ã€**ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ï¼ˆã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼‰ã‹ã‚‰SSHã§ç©´ï¼ˆãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ï¼‰ã‚’æ§‹ç¯‰** ã—ã€ãã®å¾Œã«MySQL Workbenchã‹ã‚‰æ¥ç¶šã—ã¾ã™ã€‚  ___ ### (1).sshãƒ•ã‚©ãƒ«ãƒ€ã«â‘ ç§˜å¯†éµã¨â‘¡configãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚ŠDBã‚µãƒ¼ãƒãƒ¼ã¸æ¥ç¶šã™ã‚‹ãŸã‚ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚  #### .sshãƒ•ã‚©ãƒ«ãƒ€ã®ä¸­èº« ![image](/blog/18/ssh_folder.png)  configãƒ•ã‚¡ã‚¤ãƒ«ã¯txtãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ã€æ‹¡å¼µå­ã‚’å‰Šé™¤ã™ã‚Œã°æº–å‚™ã§ãã¾ã™ã€‚  ___ ### (2)configãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ã‚’è¨˜è¼‰ configãƒ•ã‚¡ã‚¤ãƒ«ã«ä¸‹è¨˜ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚  ```text Host host_wp   hostname AA.AAA.AA.AAA   port 22   user ec2-user   IdentityFile ~/.ssh/ï¼ˆAWSç§˜å¯†éµã®åå‰ï¼‰.pem  Host host_wp_db   hostname bb.bbb.bb.bbb   port 22   user ec2-user   IdentityFile ~/.ssh/ï¼ˆAWSç§˜å¯†éµã®åå‰ï¼‰.pem   ProxyCommand C:\\Windows\\System32\\OpenSSH\\ssh.exe -l %r -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null host_wp  -W %h:%p   GatewayPorts   yes   LocalForward   9999   localhost:3306 ```  Webã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã€€â†’ã€€host_wp   DBã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã€€â†’ã€€host_wp_dbã€€ãŒå¯¾å¿œã—ã¦ã„ã¾ã™ã€‚     DBã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šã¯ã€ProxyCommand ã§ host_wp æ¥ç¶šã‚’çµŒç”±ã™ã‚‹ã‚ˆã†ã«æŒ‡å®šã—ã¦ãŠã‚Šã¾ã™ã€‚  ä»Šå›ã®ä¾‹ã§ã¯ã€DBã‚µãƒ¼ãƒãƒ¼ã¸ã®æ¥ç¶šï¼ˆhost_wp_dbï¼‰ã«ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã®ãƒãƒ¼ãƒˆã€9999ã€ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚   ãƒãƒ¼ãƒˆ9999ã¯ä»»æ„ã®ç•ªå·ã§æ§‹ã„ã¾ã›ã‚“ãŒã€åˆ¥ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã“ã¨ãŒæ¡ä»¶ã¨ãªã‚Šã¾ã™ã€‚    **ã€ç¢ºèªæ–¹æ³•ã€‘** ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ãƒãƒ¼ãƒˆç•ªå·ã‚’ç¢ºèª    `netstat -nao|find \"9999\"`  ä¸Šè¨˜ã®å®Ÿè¡Œå¾Œã€ä½•ã‚‚ã‚³ãƒ¡ãƒ³ãƒˆãŒè¿”ã£ã¦ã“ãªã‘ã‚Œã°åˆ©ç”¨ã—ã¦ã„ãªã„ã€‚    ___ ### (3)ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‹ã‚‰SSHæ¥ç¶š ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§DBã‚µãƒ¼ãƒãƒ¼ã«æ¥ç¶š  `ssh host_wp_db`  ã“ã‚Œã§ã€ãƒ­ãƒ¼ã‚«ãƒ«PCã‹ã‚‰Webã‚µãƒ¼ãƒãƒ¼ï¼ˆè¸ã¿å°çµŒç”±ï¼‰ã§æ¥ç¶šã§ãã¾ã™ã€‚  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‰ã˜ã¦ã—ã¾ã†ã¨SSHæ¥ç¶šãŒåˆ‡ã‚Œã¦ã—ã¾ã†ã®ã§ã€   **ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’ç«‹ã¡ä¸Šã’ãŸã¾ã¾** ã«ã—ã¦ãŠã„ã¦ãã ã•ã„ã€‚    ___ ### (4)MySQL Workbench ã«ã‚ˆã‚‹DBæ¥ç¶š MySQL Workbench ã® Manage Server Connection ã§ä¸‹è¨˜ã®è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚    #### AWS MySQL DBã¸ã®æ¥ç¶šè¨­å®š   ![image](/blog/18/mysql_workbench_connect.png)  ã“ã‚Œã§AWSã®MySQL DBã¸æ¥ç¶šå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/18-ssh-connect-aws-db.mdx",
    "_raw": {
      "sourceFilePath": "blog/18-ssh-connect-aws-db.mdx",
      "sourceFileName": "18-ssh-connect-aws-db.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/18-ssh-connect-aws-db"
    },
    "type": "Post",
    "slug": "/blog/18-ssh-connect-aws-db",
    "slugAsParams": "18-ssh-connect-aws-db"
  },
  {
    "title": "Git | ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’Gitã¸pushã™ã‚‹æ–¹æ³•",
    "description": "ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’Gitã¸pushã™ã‚‹æ‰‹é †",
    "date": "2020-04-02T00:00:00.000Z",
    "emoji": "â˜„",
    "tags": ["git"],
    "published": true,
    "body": {
      "raw": " ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’Gitã¸pushã™ã‚‹æ‰‹é †ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚  ___ #### â‘ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ•ã‚©ãƒ«ãƒ€ã¸ç§»å‹•ï¼ˆfolder_pathã¯æ›¸ãæ›ãˆã¦ãã ã•ã„ï¼‰  ```bash cd folder_path ``` ___ #### â‘¡ãƒ­ãƒ¼ã‚«ãƒ«ãƒªãƒã‚¸ãƒˆãƒªä½œæˆã€€â˜…åˆå›ã®ã¿ã§OK  ```bash git init ``` ___ #### â‘¢ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«ä¿å­˜  ```bash git add -A ```  add ã—ãŸå†…å®¹ã®ç¢ºèª  ```bash git status ``` ___ #### â‘£add ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚³ãƒŸãƒƒãƒˆ  ```bash git commit -m \"first commit\" ```  ___ #### â‘¤ãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªå origin ã«ç™»éŒ²ã€€â˜…åˆå›ã®ã¿ã§OK  github ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆï¼ˆèª¬æ˜ã¯çœç•¥ï¼‰  ```bash git remote add origin https://github.com/å¯¾è±¡ãƒªãƒã‚¸ãƒˆãƒªã®URL ```     ç™»éŒ²ã—ãŸãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒªã®æƒ…å ±ç¢ºèª  ```bash git remote git remote -v ``` ___ #### â‘¥Github ã«ãƒ—ãƒƒã‚·ãƒ¥ï¼ˆoriginãƒªãƒ¢ãƒ¼ãƒˆãƒªãƒã‚¸ãƒˆãƒª â† masterãƒ–ãƒ©ãƒ³ãƒï¼‰  ```bash git push origin master ```  â€»masterãƒ–ãƒ©ãƒ³ãƒã«pushã™ã‚‹ä¾‹ã§ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/19-git-push-sample.mdx",
    "_raw": {
      "sourceFilePath": "blog/19-git-push-sample.mdx",
      "sourceFileName": "19-git-push-sample.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/19-git-push-sample"
    },
    "type": "Post",
    "slug": "/blog/19-git-push-sample",
    "slugAsParams": "19-git-push-sample"
  },
  {
    "title": "VBS | Getting the current folder.",
    "description": "Sample source code of a function in VBS to retrieve the path of the current folder",
    "date": "2020-02-24T00:00:00.000Z",
    "emoji": "ğŸ“",
    "tags": ["vbs"],
    "published": true,
    "body": {
      "raw": " Here is a sample source code of a function in VBS to retrieve the path of the current folder.  ## Sample Code  ```vb Option Explicit  Msgbox GetCurrentDirectory()  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' breif : Getting the current folder ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Function GetCurrentDirectory()      Dim objWshShell     ' WshShell object      Set objWshShell = WScript.CreateObject(\"WScript.Shell\")     If Err.Number <> 0 Then         WScript.Echo \"error: \" & Err.Description         wscript.quit(1)     End If     GetCurrentDirectory = objWshShell.CurrentDirectory  End Function ```  ## Explanation  This script retrieves the current folder (also known as the current directory) in which the VBS file (executable file) is located.  *Note: The terms \"current folder\" and \"current directory\" are used interchangeably.*"
    },
    "_id": "blog/2-get-current-folder-vbs.mdx",
    "_raw": {
      "sourceFilePath": "blog/2-get-current-folder-vbs.mdx",
      "sourceFileName": "2-get-current-folder-vbs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/2-get-current-folder-vbs"
    },
    "type": "Post",
    "slug": "/blog/2-get-current-folder-vbs",
    "slugAsParams": "2-get-current-folder-vbs"
  },
  {
    "title": "C# | PCã‚«ãƒ¡ãƒ©ã‹ã‚‰æ˜ åƒã‚’å–å¾—ã™ã‚‹ã‚¢ãƒ—ãƒª",
    "description": "C#, OpenCV ã‚’åˆ©ç”¨ã—ãŸPCã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’åŠ å·¥ã—ã¦è¡¨ç¤ºã•ã›ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³",
    "date": "2020-04-03T00:00:00.000Z",
    "emoji": "ğŸ“·",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " PCã«æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’å–å¾—ã—ã¦ã€è§£æç­‰ã‚’è¡Œã„ãŸã„ã¨æ€ã£ãŸã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ  ä»Šå›ã€PCã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’åŠ å·¥ã—ã¦è¡¨ç¤ºã•ã›ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚  [ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/pc-camera-app-cs)  **2020/4/14è¿½è¨˜**   ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€Visual Studio ã‹ã‚‰ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¨å‚ç…§éƒ¨åˆ†ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚Nugetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¸‹ã•ã„ã€‚  ___ ## æ¦‚è¦ PCã«å†…è”µã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ã¨ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€å¯¾å¿œã—ãŸæ˜ åƒã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¡¨ç¤ºã—ã¾ã™ã€‚  ã€ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã€‘ - ãªã— - ã‚°ãƒ¬ãƒ¼ã€€ï¼šã€€æ˜ åƒãŒã‚°ãƒ¬ãƒ¼ã«ãªã‚Šã¾ã™ã€‚ - é¡”èªè­˜ã€€ï¼šã€€é¡”ã‚’èªè­˜ã—ãŸéƒ¨åˆ†ã«èµ¤ã®çŸ©å½¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚  ![image](/blog/20/app_sample.png)  ___ ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Visual Studioã§ä½œæˆã—ã¦ã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã¯å¤šãã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ãŠã‚Šã¾ã™ã®ã§ã€ä¸»ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿èª¬æ˜ã—ã¾ã™ã€‚  ã“ã¡ã‚‰ã¯ã€ä¸Šã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚  ```text PcCameraApp |-MainForm.cs |-OpenCVSharpBitmap.cs |-haarcascade_frontalface_default.xml ```  |ãƒ•ã‚¡ã‚¤ãƒ«å|æ©Ÿèƒ½| |:--|:--| MainForm.cs|ã‚¢ãƒ—ãƒªã®æ“ä½œã«å¯¾ã™ã‚‹å„ç¨®å‡¦ç† OpenCVSharpBitmap.cs|æ˜ åƒã‚’åŠ å·¥ã—ã¦Bitmapã§è¿”ã™ã‚¯ãƒ©ã‚¹ haarcascade_frontalface_default.xml|é¡”ã‚’æ¤œå‡ºã™ã‚‹ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«  ___ ## è£½ä½œæ‰‹é † Visual Studio ã‚’ç”¨ã„ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è£½ä½œæ‰‹é †ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚  ___ ### â‘ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã«é–¢ã—ã¦ã€è©³ç´°ã®èª¬æ˜ã¯çœç•¥ã•ã›ã¦é ‚ãã¾ã™ã€‚  ä¸‹è¨˜ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã¾ã§é€²ã‚ã¦ãã ã•ã„ã€‚  [Visual Studio ã§ã®æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ](https://docs.microsoft.com/ja-jp/visualstudio/ide/create-new-project?view=vs-2019)  ___ ### â‘¡OpenCVSharpã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« ç”»åƒå‡¦ç†ã®æ©Ÿèƒ½ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã« OpenCVSharp ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€â†’ã€ŒNuGet ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç®¡ç†ã€ã‚’é–‹ãã¾ã™ã€‚  ![image](/blog/20/visual_studio_1.png)  å‚ç…§ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã€Œopencvã€ã‚’å…¥åŠ›ã—ã¾ã™ã€‚  è¡¨ç¤ºã•ã‚ŒãŸä¸€è¦§ã‹ã‚‰ã€ã€ŒOpenCvSharp3-AnyCPUã€ã‚’é¸æŠã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  ![image](/blog/20/11.png)  ___ ### â‘¢AForge.NETãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰  PCä»˜éšã®ã‚«ãƒ¡ãƒ©ã‚’åˆ©ç”¨ã™ã‚‹éš›ã«ã¯ã€AForge.NETã¨ã„ã†å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ä¸€é€šã‚Šã®å‡¦ç†ãŒã¾ã‹ãªãˆã¾ã™ã€‚  ã“ã“ã§ã€ã‚«ãƒ¡ãƒ©ã®æ˜ åƒå–å¾—ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æº–å‚™ã—ã¾ã™ã€‚  [AFroge.netã®é…å¸ƒã‚µã‚¤ãƒˆ](http://www.aforgenet.com/framework/downloads.html)  ã€ŒDownload Libraries Only ã€ã‚’é¸æŠã—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã„ã¾ã™ã€‚  ![image](/blog/20/aforge_net.png)  ___ ### â‘£AForge.NET ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‚ç…§è¨­å®š ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ï¼ˆAForge.NET Framework-2.2.5-(libs only).zipï¼‰ã®ä¸­ã«ã€ŒReleseã€ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã¾ã™ã€‚  ã“ã®ã€ŒReleseã€ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã€ä»Šå›å¿…è¦ãªä¸‹è¨˜ã®ï¼’ç‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Visual Studioã®å‚ç…§è¨­å®šã«è¿½åŠ ã—ã¾ã™ã€‚  - AForge.Video.dll - AForge.Video.DirecrtShow.dll  ![image](/blog/20/visual_studio_1.png) ![image](/blog/20/visual_studio_2.png)  ___ ### â‘¤ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³è£½ä½œ ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚  ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³å´ã§ã€ãƒ„ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚ˆã‚Šã€å¿…è¦ãªæ•°ã®ComboBoxã€Buttonã€Labelã€PictureBoxã€Timerã‚’é…ç½®ã—ã¾ã™ã€‚  ã“ã“ã§ã€PictureBox ã¯ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’æ˜ ã™éƒ¨åˆ†ã§ã™ãŒã€æ˜ åƒãŒå¤§ãã„å ´åˆã¯ã€æº–å‚™ã—ãŸ PictureBox å†…ã«æ˜ åƒãŒåã¾ã‚Šã¾ã›ã‚“ã€‚   ãã®ãŸã‚ã€PictureBox ã® SizeMode ã‚’ StreachImage ã«å¤‰æ›´ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚  ![image](/blog/20/visual_studio_3.png)  ___ ### â‘¥ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®åŸ‹ã‚è¾¼ã¿ ã“ã“ã‹ã‚‰ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã§ã™ã€‚ã¾ãšã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚³ãƒ¼ãƒ‰å´ã§ã™ã€‚  â–¼ MainForm.cs  ```cs using System; using System.Collections.Generic; using System.ComponentModel; using System.Data; using System.Diagnostics; using System.Drawing; using System.Linq; using System.Text; using System.Threading.Tasks; using System.Windows.Forms;  using AForge.Video;             // AForge.NETãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰èª­è¾¼ using AForge.Video.DirectShow;  // AForge.NETãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰èª­è¾¼  using Original;  namespace PcCameraApp {     public partial class MainForm : Form     {         // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰         readonly string[] IMAGE_MODE = { \"ãªã—\", \"ã‚°ãƒ¬ãƒ¼\", \"é¡”èªè­˜\" };  // ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰         private string mode;                                            // ç¾åœ¨ã®ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰          public bool DeviceExist = false;                // ãƒ‡ãƒã‚¤ã‚¹æœ‰ç„¡         public FilterInfoCollection videoDevices;       // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§         public VideoCaptureDevice videoSource = null;   // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰å–å¾—ã—ãŸæ˜ åƒ          public MainForm()         {             InitializeComponent();         }          // Loadã‚¤ãƒ™ãƒ³ãƒˆï¼ˆFormã®ç«‹ã¡ä¸Šã’æ™‚ã«å®Ÿè¡Œï¼‰         private void Form1_Load(object sender, EventArgs e)         {             Debug.WriteLine(\"Formã®ãƒ­ãƒ¼ãƒ‰é–‹å§‹\");             this.getCameraInfo();         }          // ã‚«ãƒ¡ãƒ©æƒ…å ±ã®å–å¾—         public void getCameraInfo()         {             try             {                 // ç«¯æœ«ã§èªè­˜ã—ã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§ã‚’å–å¾—                 videoDevices = new FilterInfoCollection(FilterCategory.VideoInputDevice);                 comboBoxCameraType.Items.Clear();                  if (videoDevices.Count == 0)                     throw new ApplicationException();                  foreach (FilterInfo device in videoDevices)                 {                     // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§ã‚’ã‚³ãƒ³ãƒœãƒœãƒƒã‚¯ã‚¹ã«è¿½åŠ                      comboBoxCameraType.Items.Add(device.Name);                     comboBoxCameraType.SelectedIndex = 0;                     DeviceExist = true;                 }             }             catch (ApplicationException)             {                 DeviceExist = false;                 comboBoxCameraType.Items.Add(\"DeviceãŒå­˜åœ¨ã—ã¦ã„ã¾ã›ã‚“ã€‚\");             }              comboBoxMode.Items.Clear();              // ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã®è¿½åŠ              foreach (string mode in IMAGE_MODE)             {                 comboBoxMode.Items.Add(mode);             }         }          // é–‹å§‹oråœæ­¢ãƒœã‚¿ãƒ³         private void button1_Click(object sender, EventArgs e)         {             Debug.WriteLine(\"ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯\");             mode = comboBoxMode.Text;              if (buttonStartStop.Text == \"é–‹å§‹\")             {                  if (DeviceExist)                 {                     videoSource = new VideoCaptureDevice(videoDevices[comboBoxCameraType.SelectedIndex].MonikerString);                     videoSource.NewFrame += new NewFrameEventHandler(videoRendering);                     this.CloseVideoSource();                      videoSource.Start();                      buttonStartStop.Text = \"åœæ­¢\";                     timer1.Enabled = true;                      Debug.WriteLine(\"ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ï¼š\" + mode);                 }                 else                 {                     labelFps.Text = \"ãƒ‡ãƒã‚¤ã‚¹ãŒå­˜åœ¨ã—ã¦ã„ã¾ã›ã‚“ã€‚\";                 }             }             else             {                 if (videoSource.IsRunning)                 {                     timer1.Enabled = false;                     this.CloseVideoSource();                     labelFps.Text = \"åœæ­¢ä¸­\";                     buttonStartStop.Text = \"é–‹å§‹\";                  }             }         }         // æç”»å‡¦ç†         private void videoRendering(object sender, NewFrameEventArgs eventArgs)         {             Bitmap img = (Bitmap)eventArgs.Frame.Clone();              Debug.WriteLine(DateTime.Now + \":\" + \"æç”»æ›´æ–°\");             // Debug.WriteLine(mode);              try             {                 switch (mode)                 {                     case \"ãªã—\":                         pictureBoxCamera.Image = img;                         break;                      case \"ã‚°ãƒ¬ãƒ¼\":                         using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))                         {                             pictureBoxCamera.Image = bitmap.toGray();                         }                         break;                      case \"é¡”èªè­˜\":                         using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))                         {                             string strCurDir = System.Environment.CurrentDirectory;                             Debug.WriteLine(strCurDir);                             // pictureBoxCamera.Image = bitmap.addFaceRect(@\"C:\\Users\\gpbjk\\source\\repos\\Original\\cs\\opencv\\haarcascade_frontalface_default.xml\");                             pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @\"\\haarcascade_frontalface_default.xml\");                         }                         break;                      default:                         pictureBoxCamera.Image = img;                         break;                 }             }             catch             {                 pictureBoxCamera.Image = img;             }         }         // åœæ­¢ã®åˆæœŸåŒ–         private void CloseVideoSource()         {             if (!(videoSource == null))                 if (videoSource.IsRunning)                 {                     videoSource.SignalToStop();                     videoSource = null;                 }         }         // ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆã®å–å¾—         private void timer1_Tick(object sender, EventArgs e)         {             labelFps.Text = videoSource.FramesReceived.ToString() + \"FPS\";         }         // ã‚½ãƒ•ãƒˆçµ‚äº†æ™‚ã®ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†         private void MainForm_FormClosing(object sender, FormClosingEventArgs e)         {             if (videoSource != null)             {                 // Form ã‚’é–‰ã˜ã‚‹éš›ã¯æ˜ åƒãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’ã‚¯ãƒ­ãƒ¼ã‚º                 if (videoSource.IsRunning)                 {                     this.CloseVideoSource();                 }             }         }     } } ```  æç”»å‡¦ç†éƒ¨åˆ†ã§ã€ã‚¯ãƒ©ã‚¹ã€ŒOpenCVSharpBitmap ã€ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚  ã“ã®ã‚¯ãƒ©ã‚¹ã§ã€æ˜ åƒã‚’åŠ å·¥ã—ã¦Bitmapã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚  â–¼OpenCVSharpBitmap .cs  ```cs using OpenCvSharp; using OpenCvSharp.Extensions; using System; using System.Drawing;  ///  /// ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¯ãƒ©ã‚¹ ///  namespace Original {     public class OpenCVSharpBitmap : IDisposable     {         private Mat mat;          ///          /// ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿         ///          ///         public OpenCVSharpBitmap(Bitmap img)         {             this.mat = BitmapConverter.ToMat(img);         }          public void Dispose()         {             ((IDisposable)mat).Dispose();         }          ///          /// ã‚°ãƒ¬ãƒ¼ã«å¤‰æ›ã—ãŸBitmapã‚’å–å¾—         ///          ///         public Bitmap toGray()         {             Mat matGray = mat.CvtColor(ColorConversionCodes.BGR2GRAY);             return BitmapConverter.ToBitmap(matGray);         }          ///          /// é¡”ã‚’èªè­˜ã—ã¦èµ¤æ ã‚’è¿½åŠ ã—ãŸBitmapã‚’å–å¾—         ///          ///         ///         public Bitmap addFaceRect(string @cascadePath)         {             // åˆ†é¡æ©Ÿã®ç”¨æ„             using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath))             {                 foreach (Rect rectFace in cascade.DetectMultiScale(mat))                 {                     // è¦‹ã¤ã‹ã£ãŸå ´æ‰€ã«èµ¤æ ã‚’è¡¨ç¤º                     Rect rect = new Rect(rectFace.X, rectFace.Y, rectFace.Width, rectFace.Height);                     mat.Rectangle(rect, new OpenCvSharp.Scalar(0,0,255), 3, LineTypes.Link8);                 }             }              return BitmapConverter.ToBitmap(mat);         }     } } ``` ___ ### â‘¦é¡”èªè­˜ã®æ–¹æ³• é¡”èªè­˜ã—ãŸçŸ©å½¢ã‚’æ˜ åƒã«åŠ ãˆã‚‹å‡¦ç†ã¯ã€è£œè¶³ã§èª¬æ˜ã—ã¦ãŠãã¾ã™ã€‚  ã¾ãšã€ä»Šå›ã®é¡”èªè­˜ã§ã¯ **ã€Œã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ†é¡ã€** ã¨å‘¼ã°ã‚Œã‚‹æ–¹æ³•ã‚’ç”¨ã„ã¦ã„ã¾ã™ã€‚   äºˆã‚ã€ç‰¹å®šã®ãƒ¢ãƒã‚’åŒºåˆ¥ã™ã‚‹è¨­å®šå€¤ãŒå«ã¾ã‚Œã‚‹XMLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãŠãã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ OpenCvSharp ã®é–¢æ•°ã‹ã‚‰èª­ã¿è¾¼ã¿ã¾ã™ã€‚  é¡”èªè­˜ã«å¿…è¦ãªXMLãƒ•ã‚¡ã‚¤ãƒ«ã€Œhaarcascade_frontalface_default.xmlã€ã¯ã€ä¸‹è¨˜ã®githubã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚   [xmlãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml)  ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Ÿè¡Œãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ã¦æ‰±ã†ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚  MainForm.cs ```cs pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @\"\\haarcascade_frontalface_default.xml\"); ```  OpenCVSharpBitmap.cs ```cs using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath)) ```  ã“ã®ã‚ˆã†ã«ã€ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¾ã™ã®ã§ã€ãƒ“ãƒ«ãƒ‰ã™ã‚‹éš›ã«ã¯ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€ç·’ã«å‡ºåŠ›ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  ![image](/blog/20/visual_studio_4.png)  ã“ã‚Œã§èª¬æ˜ã¯çµ‚äº†ã§ã™ã€‚  ä»Šå›ã¯ã‚ãã¾ã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚  ç”»åƒå‡¦ç†ã®å®Ÿè£…æ–¹æ³•ãªã©ã¯æµç”¨ã§ãã¾ã™ã®ã§ã€è‡ªåˆ†å¥½ã¿ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¦ã„ãå‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/20-pc-camera-app-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/20-pc-camera-app-cs.mdx",
      "sourceFileName": "20-pc-camera-app-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/20-pc-camera-app-cs"
    },
    "type": "Post",
    "slug": "/blog/20-pc-camera-app-cs",
    "slugAsParams": "20-pc-camera-app-cs"
  },
  {
    "title": "VBA | DBæ“ä½œ â€“ ç¬¬1å›ï¼šConfigã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†",
    "description": "Excelãƒã‚¯ãƒ­ ç¬¬1å›ï¼š[Configã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†]",
    "date": "2020-04-14T00:00:00.000Z",
    "emoji": "â›",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " DBæ“ä½œã‚’è¡Œã†Excelãƒã‚¯ãƒ­ã‚’ä½œæˆã—ã¾ã—ãŸã€‚  ä»Šå›ã®ãƒã‚¯ãƒ­ã¯è¨˜è¼‰ã™ã‚‹å†…å®¹ãŒå¤šã„ãŸã‚ã€è¨ˆ4å›ã«åˆ†ã‘ã¦èª¬æ˜ã—ã¾ã™ã€‚  ç¬¬1å›ï¼š[Configã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†](/blog/21-excel1-config-sheet-excel-vba/)   ç¬¬2å›ï¼š[SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´](/blog/22-excel2-sql-select-excel-vba/)   ç¬¬3å›ï¼š[Excel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ](/blog/23-excel3-sql-insert-update-delete-excel-vba/)   ç¬¬4å›ï¼š[Excel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ](/blog/24-excel4-sql-merge-excel-vba/)      [ã€Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/template-excel-vba/tree/main/Template_OracleDB%E6%93%8D%E4%BD%9C)  â€»2021/2/5æ”¹ä¿®ç‰ˆ   ã€€ãƒ»ODBCæ¥ç¶šã‹ã‚‰OraOLEDB.Oracleæ¥ç¶šã«å¤‰æ›´   ã€€ãƒ»INSER,UPDATE,MERGEæ–‡ã®ç”Ÿæˆæ–¹æ³•ã‚’ä¿®æ­£    ___ ## æ¦‚è¦ ç¬¬1å›ç›®ã¯ã€DBæ“ä½œã§ä½¿ç”¨ã™ã‚‹å„è¨­å®šå€¤ã‚’VBAï¼ˆãƒã‚¯ãƒ­é–‹ç™ºï¼‰ã§æ‰±ã†æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ![image](/blog/21/01.png)  Oracleæ¥ç¶šã«å¿…è¦ãªã€Œã‚µãƒ¼ãƒ“ã‚¹åã€ãƒ»ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ»ã€Œãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã€ã®ï¼“ã¤ã‚’Configã‚·ãƒ¼ãƒˆã§è¨­å®šã—ã¦ã„ã¾ã™ã€‚  ä»Šå›èª¬æ˜ã™ã‚‹ Configurator ã‚¯ãƒ©ã‚¹ã‚’ä½¿ãˆã°ã€è¨­å®šå€¤æƒ…å ±ã‚’ç°¡å˜ã«è¿½åŠ ã§ãã¾ã™ã€‚   ï¼ˆã„ã‚ã‚†ã‚‹ ini ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Excelã«å–ã‚Šè¾¼ã‚“ã ã‚¤ãƒ¡ãƒ¼ã‚¸ï¼‰  ___ ### ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚ ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ä¸‹è¨˜ã«è¨˜è¼‰ï¼‰  ```text Template_ver1.x.x.xlsm â”œæ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |   â”œmodCmnGlbConst | | ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«     â”œConfigurator ```  ___ ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬  ___ ### â‘ modCmnGlbConst Excelã‚·ãƒ¼ãƒˆã‹ã‚‰è¨­å®šå€¤ã‚’æŠ½å‡ºã™ã‚‹ãŸã‚ã«ã€Config æƒ…å ±ãŒè¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ Excel ã®ã€Œã‚·ãƒ¼ãƒˆãƒ»è¡Œãƒ»åˆ—ã€ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚  ```vb Option Explicit  ' Config è¨­å®šã‚·ãƒ¼ãƒˆæƒ…å ± Public Const GLB_CONFIG_SHEET = \"Config\" Public Const GLB_CONFIG_KEY_COL = 1 Public Const GLB_CONFIG_ITEM_COL = 2 Public Const GLB_CONFIG_START_ROW = 2 ```  ä¾‹ãˆã°ã€Config ã‚·ãƒ¼ãƒˆã§ã¯ãªã„åˆ¥ã‚·ãƒ¼ãƒˆåã‚’ä½¿ã„ãŸã„å ´åˆã¯ã€ä¸Šè¨˜å®šæ•° GLB_CONFIG_SHEET ã‚’å¤‰æ›´ã—ã¾ã™ã€‚  ___ ### â‘¡Configurator Config æƒ…å ±ã‚’æŠ½å‡ºã™ã‚‹æ©Ÿèƒ½ã‚’æŒã£ãŸã‚¯ãƒ©ã‚¹ã§ã™ã€‚ è§£èª¬ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' Configurator ã‚¯ãƒ©ã‚¹ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ã€ä½¿ç”¨æ‰‹é †ã€‘ ' â‘  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ ' â‘¡ setData    ï¼šè¨­å®šå€¤ã‚’æ ¼ç´ ' â‘¢ getItem    ï¼šè¨­å®šå€¤ã‚’å–å¾— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  ' ãƒ¡ãƒ³ãƒå¤‰æ•°ï¼ˆMe.ã§å‚ç…§å¯èƒ½ã¨ã™ã‚‹ãŸã‚publicï¼‰ Public dic As Object  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub Class_Initialize()      Set Me.dic = CreateObject(\"Scripting.Dictionary\")  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : Config æƒ…å ±ã§ã‚ã‚‹è¨­å®šé …ç›®ã¨è¨­å®šå€¤ã‚’æ ¼ç´ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub setData(sheet As Worksheet, keyCol As Long, itemCol As Long, startRow As Long)      Dim i As Long     Dim row As Long      Dim key As String, item As String      i = 0     row = startRow      Do While sheet.Cells(row, keyCol) <> \"\"          key = sheet.Cells(row, keyCol)         item = sheet.Cells(row, itemCol)          Me.dic.add key, item          row = row + 1     Loop  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : setData é–¢æ•°ã§å–å¾—ã—ãŸ Config æƒ…å ±ã®è¨­å®šå€¤ã‚’å–å¾— ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Function getItem(key As String) As String      getItem = dic.item(key)  End Function ```  ___ ### â‘¢Configurator ã®ä½¿ç”¨ä¾‹ Configurator ã‚¯ãƒ©ã‚¹ã‚’ç”¨ã„ãŸä½¿ç”¨ä¾‹ã§ã™ã€‚  ä¸‹è¨˜ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒœãƒƒã‚¯ã‚¹ã« Config ã‚·ãƒ¼ãƒˆã§è¨­å®šã—ãŸ SERVICE_NAME ã®å€¤ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  ```vb Option Explicit      Dim config As Configurator  Public Sub main()      Dim servicename As String, username As String, password As String, accessPath As String      ' Config è¨­å®šã®èª­ã¿è¾¼ã¿     Set config = New Configurator     config.setData ThisWorkbook.Worksheets(GLB_CONFIG_SHEET), GLB_CONFIG_KEY_COL, GLB_CONFIG_ITEM_COL, GLB_CONFIG_START_ROW      servicename = config.getItem(\"SERVICE_NAME\")     Msgbox servicename  End Sub ```  ä»Šå›ã¯ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚  æ¬¡å›ã¯ã€Config ã‚·ãƒ¼ãƒˆã§è¨­å®šã—ãŸé …ç›®å€¤ã‚’æ‰±ã„ DB ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ "
    },
    "_id": "blog/21-excel1-config-sheet-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/21-excel1-config-sheet-excel-vba.mdx",
      "sourceFileName": "21-excel1-config-sheet-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/21-excel1-config-sheet-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/21-excel1-config-sheet-excel-vba",
    "slugAsParams": "21-excel1-config-sheet-excel-vba"
  },
  {
    "title": "VBA | DBæ“ä½œ â€“ ç¬¬2å›ï¼šSELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´",
    "description": "Excelãƒã‚¯ãƒ­ ç¬¬2å›ï¼š[SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´]",
    "date": "2020-04-15T00:00:00.000Z",
    "emoji": "â›",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " DBæ“ä½œã‚’è¡Œã†Excelãƒã‚¯ãƒ­ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ä»Šå›ã®è¨˜äº‹ã¯ã€ç¬¬2å›ã€ã¨ãªã‚Šã¾ã™ã€‚  ç¬¬1å›ï¼š[Configã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†](/blog/21-excel1-config-sheet-excel-vba/)   ç¬¬2å›ï¼š[SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´](/blog/22-excel2-sql-select-excel-vba/)   ç¬¬3å›ï¼š[Excel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ](/blog/23-excel3-sql-insert-update-delete-excel-vba/)   ç¬¬4å›ï¼š[Excel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ](/blog/24-excel4-sql-merge-excel-vba/)    [ã€Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/template-excel-vba/tree/main/Template_OracleDB%E6%93%8D%E4%BD%9C)  â€»2021/2/5æ”¹ä¿®ç‰ˆ   ã€€ãƒ»ODBCæ¥ç¶šã‹ã‚‰OraOLEDB.Oracleæ¥ç¶šã«å¤‰æ›´   ã€€ãƒ»INSER,UPDATE,MERGEæ–‡ã®ç”Ÿæˆæ–¹æ³•ã‚’ä¿®æ­£    ___ ## æ¦‚è¦ ç¬¬2å›ç›®ã¯ã€SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ![image](/blog/22/00.png)  Excelã®ã€ŒConfigã‚·ãƒ¼ãƒˆã€ã«DBæ¥ç¶šã‚’è¨­å®šã—ã€ã€ŒSQLã‚·ãƒ¼ãƒˆã€ã«ãƒ‡ãƒ¼ã‚¿æŠ½å‡ºã™ã‚‹SQLæ–‡ã‚’è¨˜è¼‰ã—ã¦ãƒã‚¯ãƒ­ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  ãã†ã™ã‚‹ã¨ã€å„ã‚·ãƒ¼ãƒˆï¼ˆSQLã‚·ãƒ¼ãƒˆã®ã‚·ãƒ¼ãƒˆåã«è¨˜è¼‰ã—ãŸåç§°ï¼‰ã«SELECTã—ãŸçµæœãŒè²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¾ã™ã€‚  ä¸‹è¨˜ã«æ“ä½œæ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚  ___ ### â‘ DBæ¥ç¶šè¨­å®š Configã‚·ãƒ¼ãƒˆã«DBæ¥ç¶šã®è¨­å®šã‚’è¨˜è¼‰ã—ã¾ã™ã€‚ï¼ˆDBã¯Oracleã®ã¿å¯¾è±¡ï¼‰  ![image](/blog/22/01.png)  SERVICE_NAMEï¼ˆã‚µãƒ¼ãƒ“ã‚¹åï¼‰ã¯Oracleã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚‚ã—ãã¯ã‚µãƒ¼ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä½œæˆãƒ»è¨­å®šã—ãŸ tnsnames.ora ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚  ä¾‹. ä¸‹è¨˜ tnsnames.ora ã®ä¾‹ã§ã¯ã€TESTDB.GRAWORãŒã‚µãƒ¼ãƒ“ã‚¹åã§ã™ã€‚  ```text TESTDB =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = ***)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = TESTDB.GRAWOR)     )   ) ``` ___ ### â‘¡Oracleæ¥ç¶šãƒ†ã‚¹ãƒˆ Oracle DBã«æ¥ç¶šã—ã€ Configã‚·ãƒ¼ãƒˆã®æ¥ç¶šè¨­å®šãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¾ã™ã€‚  ![image](/blog/22/02.png)  ã€Œã‚ªãƒ©ã‚¯ãƒ«ã¸ã®æ¥ç¶šãƒ†ã‚¹ãƒˆå®Œäº†ã€ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°ã€å•é¡ŒãªãOracle DBã«æ¥ç¶šã§ãã¦ã„ã¾ã™ã€‚  ___ ### â‘¢SQLæ–‡ã‚’å®Ÿè¡Œ SQLå®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€SQLæ–‡ã‚’å®Ÿè¡Œã—ã€å„ã‚·ãƒ¼ãƒˆã«æŠ½å‡ºãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¾ã™ã€‚  ![image](/blog/22/03.png)  ![image](/blog/22/04.png)  SQLã‚·ãƒ¼ãƒˆã®ã€Œã‚·ãƒ¼ãƒˆåã€é …ç›®ã«è¨˜è¼‰ã—ãŸåç§°ã®ã‚·ãƒ¼ãƒˆãŒä½œæˆã•ã‚Œã€SQLã®æŠ½å‡ºçµæœãŒè²¼ã‚Šä»˜ã‘ã‚‰ã‚Œã¾ã™ã€‚  ___ ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿è¨˜è¼‰ï¼‰  ```text Template_ver1.x.x.xlsm â”œæ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |   â”œmodCmnGlbConst |   â”œmodSql    | ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«     â”œConfigurator     â”œDBManager ```  ___ ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ ä»Šå›ã¯ã€modCmnGlbConst ã¨ Configurator ã®èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚  â€»ä¸Šè¨˜ã¯DBæ“ä½œ â€“ ç¬¬1å›ã«ã¦è¨˜è¼‰  ___ ### â‘ DBManager DBæ“ä½œã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ã§ã™ã€‚Oracle DBã¸ã®æ¥ç¶šã‚„SQLã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã‚’å‚™ãˆã¾ã™ã€‚  å¿…è¦ãªå¤‰æ•°ãƒ»é–¢æ•°ã‚’æŠœç²‹ã—ã€ è§£èª¬ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' DBManager ã‚¯ãƒ©ã‚¹ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ã€ä½¿ç”¨æ‰‹é † - SELECTã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿å–å¾—ã€‘ ' â‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ ' â‘¡openOracleï¼šã‚ªãƒ©ã‚¯ãƒ«ã¸ã®æ¥ç¶š or openAccessï¼šã‚¢ã‚¯ã‚»ã‚¹ã¸ã®æ¥ç¶š ' â‘¢excuteSqlï¼šSQLã®å®Ÿè¡Œ ' â‘£pasteRecordsetï¼šå®Ÿè¡Œã—ãŸSQLã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ ' â‘¤closeRecordsetï¼šãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã®ã‚¯ãƒ­ãƒ¼ã‚º ' â‘¥closeConnectionï¼šDBåˆ‡æ–­ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ã€ä½¿ç”¨æ‰‹é † - INSERT or UPDATE or DELETEã®å®Ÿè¡Œã€‘ ' â‘ ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ ' â‘¡openOracleï¼šã‚ªãƒ©ã‚¯ãƒ«ã¸ã®æ¥ç¶š or openAccessï¼šã‚¢ã‚¯ã‚»ã‚¹ã¸ã®æ¥ç¶š ' â‘¢begintransï¼šãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹ ' â‘£createAndExcuteOracleSql(s)ï¼šSQLã‚’ç”Ÿæˆã—ã¦å®Ÿè¡Œ ' â‘¤committransï¼šã‚³ãƒŸãƒƒãƒˆã€€â€»ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ rollbacktrans ' â‘¥closeConnectionï¼šDBåˆ‡æ–­ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  ' ãƒ¡ãƒ³ãƒå¤‰æ•°ï¼ˆMe.ã§å‚ç…§å¯èƒ½ã¨ã™ã‚‹ãŸã‚publicï¼‰ Public con As Object    ' Connection Public rs As Object     ' Recordset  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub Class_Initialize()      Set Me.con = CreateObject(\"Adodb.Connection\")     Set Me.rs = CreateObject(\"Adodb.Recordset\")  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚ªãƒ©ã‚¯ãƒ«ã¸ã®æ¥ç¶šå‡¦ç† ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub openOracle(servicename As String, username As String, password As String)      Dim constr As String      constr = \"DSN=\" & servicename     constr = constr & \";UID=\" & username     constr = constr & \";PWD=\" & password      Debug.Print (constr)     Me.con.ConnectionString = constr     Me.con.Open     Debug.Print \"ã‚ªãƒ©ã‚¯ãƒ«ã¸ã®æ¥ç¶šå®Œäº†\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚¢ã‚¯ã‚»ã‚¹ã¸ã®æ¥ç¶šå‡¦ç† ' note  : å¼•æ•° access_name ã¯ãƒ•ãƒ«ãƒ‘ã‚¹ï¼ˆãƒ•ã‚©ãƒ«ãƒ€åï¼‹ãƒ•ã‚¡ã‚¤ãƒ«åï¼‰ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub openAccess(access_name As String)      Me.con.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" & access_name & \";\" 'Accessãƒ•ã‚¡ã‚¤ãƒ«ã«æ¥ç¶š     Debug.Print \"ã‚¢ã‚¯ã‚»ã‚¹ã¸ã®æ¥ç¶šå®Œäº†\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹å‡¦ç† ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub begintrans()      Me.con.begintrans     Debug.Print \"ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚³ãƒŸãƒƒãƒˆå‡¦ç† ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub committrans()      Me.con.committrans     Debug.Print \"ã‚³ãƒŸãƒƒãƒˆå‡¦ç†å®Ÿæ–½\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç† ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub rollbacktrans()      Me.con.rollbacktrans     Debug.Print \"ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯å‡¦ç†å®Ÿæ–½\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : DBåˆ‡æ–­å‡¦ç† ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub closeConnection()      On Error Resume Next      Me.con.Close     Me.rs.Close      Set Me.con = Nothing     Set Me.rs = Nothing      On Error GoTo 0     ' ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®å‘½ä»¤å–ã‚Šæ¶ˆã—     Debug.Print \"DBã¸ã®åˆ‡æ–­å®Œäº†\"  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã®ã‚¯ãƒ­ãƒ¼ã‚º ' note  : SQLå®Ÿè¡Œã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚ŒãŸå¾Œã¯ã‚¯ãƒ­ãƒ¼ã‚ºå¿…è¦ '         ï¼ˆé€£ç¶šã§SQLã‚’å®Ÿè¡Œã—ã¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã‚’Openã™ã‚‹ã“ã¨ã¯ã§ããªã„ï¼‰ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub closeRecordset()     Me.rs.Close End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : SQLã®å®Ÿè¡Œ ' note  : SELECTæ–‡ã®å®Ÿè¡Œå¾Œã¯ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã‚‹ã€‚ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub excuteSql(str_sql As String)      Debug.Print str_sql & \" ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚\"     rs.Open str_sql, con  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : å®Ÿè¡Œã—ãŸSQLã§å–å¾—ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã‚’Excelã«è²¼ã‚Šä»˜ã‘ ' note  : need_filed_ -> Trueã§ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã‚‚æ›¸ãè¾¼ã¿ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub pasteRecordset(worksheet_ As Worksheet, data_start_row_ As Long, data_start_col_ As Long, need_filed_ As Boolean)      Dim i As Long      If need_filed_ = True Then          'ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã®æ›¸ãå‡ºã—         For i = 0 To rs.Fields.count - 1             worksheet_.Cells(data_start_row_, data_start_col_ + i).Value = rs.Fields(i).Name         Next i          data_start_row_ = data_start_row_ + 1      End If      'CopyFromRecordsetãƒ¡ã‚½ãƒƒãƒ‰ã§åŸºæº–ã‚»ãƒ«ã‚’æŒ‡å®šã—ã¦ãƒ‡ãƒ¼ã‚¿ã®æ›¸ãå‡ºã—     worksheet_.Cells(data_start_row_, data_start_col_).CopyFromRecordset rs  End Sub ï¼ˆï¼’ï¼‰modSql DBManagerã‚¯ãƒ©ã‚¹ã‚’åˆ©ç”¨ã—ã¦SQLã‚’å®Ÿè¡Œã—ã€Excelã‚·ãƒ¼ãƒˆã«ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚  å¿…è¦ãªå¤‰æ•°ãƒ»é–¢æ•°ã‚’æŠœç²‹ã—ã€ è§£èª¬ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  Option Explicit      ' ---- SELECTæ–‡ã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã®è¨­å®šé …ç›®     Const SQL_SHEET_NAME = \"SQL\"     Const DATA_SHEET_NAME_COL = 1     Const SQL_COL = 2     Const CONNECT_TYPE_COL = 3     Const SQL_START_ROW = 2      Dim config As Configurator     Dim dbManagerOracle As dbManager     Dim dbManagerAccess As dbManager  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚·ãƒ¼ãƒˆã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å„SELECTæ–‡ã‚’å®Ÿè¡Œ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub executeSelects()      Dim i As Long     Dim row As Long      Dim wsActive As Worksheet      Dim servicename As String, username As String, password As String, accessPath As String      Dim sqlSheet As Worksheet       ' ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚‹SQLãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚·ãƒ¼ãƒˆ      Dim dataSheetName As String     ' SQLã®SELECTãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã‚‹ã‚·ãƒ¼ãƒˆå     Dim sql As String               ' SQLï¼ˆSELECTæ–‡ï¼‰     Dim connectType As String       ' æ¥ç¶šã‚¿ã‚¤ãƒ—ï¼ˆOracle or Accessï¼‰      Set dbManagerOracle = Nothing     Set dbManagerAccess = Nothing      focus True      ' å®Ÿè¡Œæ™‚ã®ã‚·ãƒ¼ãƒˆã‚’ä¿å­˜     Set wsActive = ActiveSheet      ' Config è¨­å®šã®èª­ã¿è¾¼ã¿     Set config = New Configurator     config.setData ThisWorkbook.Worksheets(GLB_CONFIG_SHEET), GLB_CONFIG_KEY_COL, GLB_CONFIG_ITEM_COL, GLB_CONFIG_START_ROW      servicename = config.getItem(\"SERVICE_NAME\")     username = config.getItem(\"USERNAME\")     password = config.getItem(\"PASSWORD\")     accessPath = config.getItem(\"ACCESS_PATH\")      i = 0      dataSheetName = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, DATA_SHEET_NAME_COL)     sql = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, SQL_COL)     connectType = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, CONNECT_TYPE_COL)      ' ã‚·ãƒ¼ãƒˆã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å„SELECTæ–‡ã‚’å®Ÿè¡Œï¼ˆã‚·ãƒ¼ãƒˆåãŒç„¡ããªã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—ï¼‰     Do While dataSheetName <> \"\"          ' ãƒ‡ãƒ¼ã‚¿è²¼ã‚Šä»˜ã‘å…ˆã®ã‚·ãƒ¼ãƒˆã‚’å‰Šé™¤         If sheetExists(ThisWorkbook, dataSheetName) Then             Application.DisplayAlerts = False ' ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’éè¡¨ç¤º             ThisWorkbook.Worksheets(dataSheetName).Delete             Application.DisplayAlerts = True  ' ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º         End If          ' ãƒ‡ãƒ¼ã‚¿è²¼ã‚Šä»˜ã‘å…ˆã®ã‚·ãƒ¼ãƒˆã‚’ä½œæˆ         If sql <> \"\" Then             ' SQL æœ‰ã‚Šã€€â†’ã€€ã‚·ãƒ¼ãƒˆä½œæˆ             createSheet ThisWorkbook, dataSheetName          End If          ' - Oracle æ¥ç¶š         If connectType = \"Oracle\" Then              ' DBæ¥ç¶š             If (sql <> \"\") And (dbManagerOracle Is Nothing) Then                 Set dbManagerOracle = New dbManager                 dbManagerOracle.openOracle servicename, username, password             End If              ' SQLã‚’å®Ÿè¡Œ             dbManagerOracle.excuteSql sql              ' ã‚·ãƒ¼ãƒˆã«SQLã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘             dbManagerOracle.pasteRecordset ThisWorkbook.Worksheets(dataSheetName), 1, 1, True              ' ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã‚’ã‚¯ãƒ­ãƒ¼ã‚º             dbManagerOracle.closeRecordset          ' - Access æ¥ç¶š         ElseIf connectType = \"Access\" Then              ' DBæ¥ç¶š             If (sql <> \"\") And (dbManagerAccess Is Nothing) Then                 Set dbManagerAccess = New dbManager                 dbManagerAccess.openAccess accessPath             End If              ' SQLã‚’å®Ÿè¡Œ             dbManagerAccess.excuteSql sql              ' ã‚·ãƒ¼ãƒˆã«SQLã§å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘             dbManagerAccess.pasteRecordset ThisWorkbook.Worksheets(dataSheetName), 1, 1, True              ' ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚»ãƒƒãƒˆã‚’ã‚¯ãƒ­ãƒ¼ã‚º             dbManagerAccess.closeRecordset          Else             ' SQLãŒè¨˜è¼‰ã‹ã¤æ¥ç¶šã‚¿ã‚¤ãƒ—ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„å ´åˆã¯çµ‚äº†             If sql <> \"\" Then                 MsgBox SQL_SHEET_NAME & \" ã‚·ãƒ¼ãƒˆã®æ¥ç¶šã‚¿ã‚¤ãƒ—ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚çµ‚äº†ã—ã¾ã™ã€‚\"                 ThisWorkbook.Worksheets(SQL_SHEET_NAME).Activate                 End             End If         End If          i = i + 1         dataSheetName = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, DATA_SHEET_NAME_COL)         sql = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, SQL_COL)         connectType = ThisWorkbook.Worksheets(SQL_SHEET_NAME).Cells(SQL_START_ROW + i, CONNECT_TYPE_COL)      Loop      ' - Oracleåˆ‡æ–­     If Not dbManagerOracle Is Nothing Then         dbManagerOracle.closeConnection     End If      ' - Accessåˆ‡æ–­     If Not dbManagerAccess Is Nothing Then         dbManagerAccess.closeConnection     End If      wsActive.Activate     focus False      Application.StatusBar = Now & \"SQL SELECTå®Ÿè¡Œå®Œäº†\"  End Sub ```  ä»Šå›ã¯ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚  ã“ã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã™ã‚Œã°ã€ãƒœã‚¿ãƒ³ä¸€ã¤ã§ DBã‹ã‚‰æœ€æ–°ã®ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚   ä¾‹ãˆã°ã€ãƒ‡ãƒ¼ã‚¿é›†è¨ˆæ¥­å‹™ã®åŠ¹ç‡åŒ–ãªã©ã«å½¹ç«‹ã¦ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚    æ¬¡å›ã¯ã€Excelã‚·ãƒ¼ãƒˆã«å…¥åŠ›ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’åŸºã«ã€Oracle DBã«INSERTãƒ»UPDATEãƒ»DELETEã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚ "
    },
    "_id": "blog/22-excel2-sql-select-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/22-excel2-sql-select-excel-vba.mdx",
      "sourceFileName": "22-excel2-sql-select-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/22-excel2-sql-select-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/22-excel2-sql-select-excel-vba",
    "slugAsParams": "22-excel2-sql-select-excel-vba"
  },
  {
    "title": "VBA | DBæ“ä½œ â€“ ç¬¬3å›ï¼šExcel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ",
    "description": "Excelãƒã‚¯ãƒ­ ç¬¬3å›ï¼š[Excel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ]",
    "date": "2020-04-16T00:00:00.000Z",
    "emoji": "â›",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " DBæ“ä½œã‚’è¡Œã†Excelãƒã‚¯ãƒ­ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ä»Šå›ã®è¨˜äº‹ã¯ã€ç¬¬3å›ã€ã¨ãªã‚Šã¾ã™ã€‚  ç¬¬1å›ï¼š[Configã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†](/blog/21-excel1-config-sheet-excel-vba/)   ç¬¬2å›ï¼š[SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´](/blog/22-excel2-sql-select-excel-vba/)   ç¬¬3å›ï¼š[Excel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ](/blog/23-excel3-sql-insert-update-delete-excel-vba/)   ç¬¬4å›ï¼š[Excel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ](/blog/24-excel4-sql-merge-excel-vba/)    [ã€Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/template-excel-vba/tree/main/Template_OracleDB%E6%93%8D%E4%BD%9C)  â€»2021/2/5æ”¹ä¿®ç‰ˆ   ã€€ãƒ»ODBCæ¥ç¶šã‹ã‚‰OraOLEDB.Oracleæ¥ç¶šã«å¤‰æ›´   ã€€ãƒ»INSER,UPDATE,MERGEæ–‡ã®ç”Ÿæˆæ–¹æ³•ã‚’ä¿®æ­£    ___ ## æ¦‚è¦ ç¬¬3å›ç›®ã¯ã€Excelã‚·ãƒ¼ãƒˆã«æ ¼ç´ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆã‚»ãƒ«ã®å€¤ï¼‰ã‚’ã€æŒ‡å®šã—ãŸDBï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚  ![image](/blog/23/00.png)  Excelã®ã€ŒConfigã‚·ãƒ¼ãƒˆã€ã«DBæ¥ç¶šå†…å®¹ã‚’è¨­å®šã—ã€ã€ŒINSERTãƒ»UPDATEãƒ»DELETEã€ã®å„ã‚·ãƒ¼ãƒˆã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã—ã¾ã™ã€‚  |ã‚¿ã‚¤ãƒ—|æ©Ÿèƒ½| |:--|:--| INSERT|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æŒ¿å…¥ï¼‰ UPDATE|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–° ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°ï¼‰ DELETE|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼‰  ä¸‹è¨˜ã«æ“ä½œæ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚  ___ ### â‘ DBæ¥ç¶šè¨­å®š Configã‚·ãƒ¼ãƒˆã«DBæ¥ç¶šã®è¨­å®šã‚’è¨˜è¼‰ã—ã¾ã™ã€‚ï¼ˆDBã¯Oracleã®ã¿å¯¾è±¡ï¼‰  ![image](/blog/23/01.png)  SERVICE_NAMEï¼ˆã‚µãƒ¼ãƒ“ã‚¹åï¼‰ã¯Oracleã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚‚ã—ãã¯ã‚µãƒ¼ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä½œæˆãƒ»è¨­å®šã—ãŸ tnsnames.ora ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã¾ã™ã€‚  ä¾‹. ä¸‹è¨˜ tnsnames.ora ã®ä¾‹ã§ã¯ã€TESTDB.GRAWORãŒã‚µãƒ¼ãƒ“ã‚¹åã§ã™ã€‚  ```text TESTDB =   (DESCRIPTION =     (ADDRESS = (PROTOCOL = TCP)(HOST = ***)(PORT = 1521))     (CONNECT_DATA =       (SERVER = DEDICATED)       (SERVICE_NAME = TESTDB.GRAWOR)     )   ) ```  ___ ### â‘¡ç”Ÿæˆã™ã‚‹INSERTæ–‡ã®ç¢ºèª ã“ã“ã§ã¯ã€DBã«ãƒ‡ãƒ¼ã‚¿ã‚’INSERTã™ã‚‹å ´åˆã®æ‰‹é †ã‚’ç¤ºã—ã¾ã™ã€‚  ã¾ãšã€INSERTã‚·ãƒ¼ãƒˆã«æ ¼ç´ã—ãŸã„ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜è¼‰ã—ã¦ã€ç”Ÿæˆã•ã‚Œã‚‹INSERTæ–‡ã‚’ç¢ºèªã—ã¾ã™ã€‚  INSERTã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã®è¨­å®šæ–¹æ³•ã¯ä¸‹è¨˜ã®é€šã‚Šã§ã™ã€‚  1. å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æŒ‡å®šã™ã‚‹ã€‚ï¼ˆä¾‹ï¼TEST_TABLEï¼‰ 2. å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã¸æ ¼ç´ã™ã‚‹ã‚«ãƒ©ãƒ ã‚’ã‚¿ã‚¤ãƒ—ãƒ»DBã‚«ãƒ©ãƒ åã«æŒ‡å®šã™ã‚‹ã€‚   ã€€ï¼ˆä¾‹ï¼INSERTãƒ»IDã€INSERTãƒ»LINE ãƒ»ãƒ»ãƒ»INSERTãƒ»START_DATEï¼‰ 3. æŒ‡å®šã—ãŸã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦æŒ¿å…¥ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’è¨˜è¼‰ã™ã‚‹ã€‚   ã€€ï¼ˆä¾‹ï¼1000,A001,1,20200401,ãƒ»ãƒ»ãƒ»ï¼‰  ![image](/blog/23/02.png)  å•é¡Œãªã‘ã‚Œã°ã€INSERTæ–‡ã®å®Ÿè¡Œã«é€²ã¿ã¾ã™ã€‚  ___ ### â‘¢INSERTæ–‡ã®å®Ÿè¡Œ INSERTå®Ÿè¡Œã®ãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€INSERTã‚·ãƒ¼ãƒˆã«è¨˜è¼‰ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’å¯¾è±¡ã®DBãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ã™ã‚‹å‡¦ç†ãŒé–‹å§‹ã•ã‚Œã¾ã™ã€‚  ![image](/blog/23/03.png)  ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€INSERTã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€DBã®ã€ŒTEST_TABLEã€ã«ãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¾ã—ãŸã€‚  ___ ### â‘£UPDATEæ–‡ã€DELETEæ–‡ã®å ´åˆ ä»Šã¾ã§INSERTæ–‡ã®å®Ÿè¡Œã«ã¤ã„ã¦èª¬æ˜ã—ã¦ãã¾ã—ãŸãŒã€ä»–ã«ã‚‚ã€€UPDATEæ–‡ãƒ»DELETEæ–‡ã€€ã®å®Ÿè¡Œã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚  UPDATEæ–‡ãƒ»DELETEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹æ‰‹é †ã¯ã€INSERTæ–‡ã¨æ¦‚ã­åŒã˜ã§ã™ã€‚ä¸‹è¨˜ã®ç”»åƒã‚’å‚è€ƒã«è©¦ã—ã¦ã¿ã¦ãã ã•ã„ã€‚  ![image](/blog/23/04.png) ![image](/blog/23/05.png)   ___ ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿è¨˜è¼‰ï¼‰  ```text Template_ver1.x.x.xlsm â”œæ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |   â”œmodCmnGlbConst |   â”œmodSql    | ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«     â”œConfigurator     â”œDBManager ```  ___ ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ ä»Šå›ã¯ã€modCmnGlbConst ã¨ Configurator ã®èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚  â€»ä¸Šè¨˜ã¯DBæ“ä½œ â€“ ç¬¬1å›ã«ã¦è¨˜è¼‰  ___ ### â‘ æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼šmodSql INSERTã‚·ãƒ¼ãƒˆã‚’ä¾‹ã«ã™ã‚‹ã¨ã€INSERTå®Ÿè¡Œãƒœã‚¿ãƒ³ã‚’æŠ¼ä¸‹ã™ã‚‹ã¨ã€é–¢æ•°ã€ŒexecuteInsertSqlsOracle()ã€ãŒå®Ÿè¡Œã•ã‚Œã¾ã™ï¼ˆä¸‹è¨˜ï¼‰ã€‚  ã“ã®é–¢æ•°å†…ã§ã€DBManagerã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ–ã—ãŸDBManagerã‹ã‚‰INSERTæ–‡ã‚’ç”Ÿæˆã—ã¦å®Ÿè¡Œã™ã‚‹é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : A.å„INSERTæ–‡ã‚’é€£ç¶šå®Ÿè¡Œ ' note  : Oracleå¯¾å¿œ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub executeInsertSqlsOracle()      Dim servicename As String, username As String, password As String      Dim sheet As Worksheet          ' SQLã‚’ç”Ÿæˆã™ã‚‹æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚·ãƒ¼ãƒˆ     Dim tableName As String         ' æ“ä½œã™ã‚‹å¯¾è±¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«      ' Config è¨­å®šã®èª­ã¿è¾¼ã¿     Set config = New Configurator     config.setData ThisWorkbook.Worksheets(GLB_CONFIG_SHEET), GLB_CONFIG_KEY_COL, GLB_CONFIG_ITEM_COL, GLB_CONFIG_START_ROW      servicename = config.getItem(\"SERVICE_NAME\")     username = config.getItem(\"USERNAME\")     password = config.getItem(\"PASSWORD\")      ' DBæ¥ç¶š     Set dbManagerOracle = New DBManager     dbManagerOracle.openOracle servicename, username, password      Set sheet = ThisWorkbook.Worksheets(INSERT_SHEET_NAME)     tableName = sheet.Cells(TABLE_NAME_ROW, TABLE_NAME_COL)      ' ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹     dbManagerOracle.begintrans      On Error GoTo err      ' SQLå®Ÿè¡Œ     dbManagerOracle.createAndExcuteOracleSqls tableName, sheet, TYPE_DIFINED_ROW, DB_COL_NAME_DIFINED_ROW, DATA_START_ROW, DATA_START_COL      ' ã‚³ãƒŸãƒƒãƒˆ     dbManagerOracle.committrans      ' DBåˆ‡æ–­     dbManagerOracle.closeConnection      Application.StatusBar = Now & \"SQL INSERTå®Ÿè¡Œå®Œäº†\"      Exit Sub  err:     ' ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯     Debug.Print \"ã‚¨ãƒ©ãƒ¼ç•ªå·:\" & err.Number & Chr(13) & \"ã‚¨ãƒ©ãƒ¼å†…å®¹:\" & err.Description     MsgBox \"ã‚¨ãƒ©ãƒ¼ç•ªå·:\" & err.Number & Chr(13) & \"ã‚¨ãƒ©ãƒ¼å†…å®¹:\" & err.Description      MsgBox \"ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã—ã¾ã™ã€‚\"     dbManagerOracle.rollbacktrans      End  End Sub ```  UPDATEãƒ»DELETEæ–‡ã®ç”Ÿæˆãƒ»å®Ÿè¡Œã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œæ‰‹é †ã‚‚ã€ä¸Šè¨˜INSERTã®æ‰‹é †ã¨åŒã˜ã§ã™ã®ã§èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚è©³ç´°ã¯Excelãƒã‚¯ãƒ­ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã”ç¢ºèªãã ã•ã„ã€‚  ___ ### â‘¡ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼šDBManager DBManagerã¯Oracle DBã¸ã®æ¥ç¶šã«é–¢ã™ã‚‹æ©Ÿèƒ½ã‚‚å‚™ãˆã¦ã„ã¾ã™ã€‚  ãã¡ã‚‰ã¯ã€DBæ“ä½œ â€“ ç¬¬2å›ã€€ã«è¨˜è¼‰ã—ã¦ã„ã¾ã™ã®ã§èª¬æ˜ã¯çœç•¥ã—ã¾ã™ã€‚  ä»Šå›ã¯ã€ï¼ˆï¼‘ï¼‰æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼šmodSqlã€€å†…ã®é–¢æ•°ã‹ã‚‰DBManagerã‚’æ“ä½œã™ã‚‹ã“ã¨ã§ã€INSERTæ–‡ã‚’ç”Ÿæˆã—ã¦å®Ÿè¡Œã™ã‚‹ã‚½ãƒ¼ã‚¹éƒ¨åˆ†ã«é–¢ã—ã¦èª¬æ˜ã—ã¾ã™ã€‚  SQLæ–‡ã‚’ç”Ÿæˆã—ã¦å®Ÿè¡Œã™ã‚‹ã¾ã§ã«ã€ä¸‹è¨˜é–¢æ•°ã‚’çµŒç”±ã—ã¾ã™ã€‚  createAndExcuteOracleSqlsï¼ˆå…¨ãƒ¬ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰   ã€€â†“   createAndExcuteOracleSqlï¼ˆ1ãƒ¬ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œï¼‰   ã€€â†“   createOracleSqlï¼ˆSQLæ–‡ã®ç”Ÿæˆï¼‰   ã€€checkSqlTypeï¼ˆINSERTãƒ»UPDATEãƒ»DELETEæ–‡ã®é¸å®šï¼‰   ã€€â”œ ->createInsertOracleSqlï¼ˆINSERTæ–‡ã®ç”Ÿæˆï¼‰   ã€€â”œ ->createUpdateOracleSqlï¼ˆUPDATEæ–‡ã®ç”Ÿæˆï¼‰   ã€€â”” ->createDeleteOracleSqlï¼ˆDELETEæ–‡ã®ç”Ÿæˆï¼‰    ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : INSERT or UPDATE or DELETE SQLæ–‡ã‚’ä½œæˆã—ã¦å®Ÿè¡Œï¼ˆ1è¡Œï¼‰ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub createAndExcuteOracleSql(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long)      Dim sql As String      ' SQLä½œæˆ     sql = createOracleSql(table_name, sheet, sql_type_defined_row, db_col_name_defined_row, db_data_start_row, db_data_start_col)      ' SQLå®Ÿè¡Œ     excuteSql sql  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : INSERT or UPDATE or DELETE SQLæ–‡ã‚’ä½œæˆã—ã¦å®Ÿè¡Œï¼ˆè¤‡æ•°è¡Œï¼‰ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub createAndExcuteOracleSqls(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long)      Dim i As Long     Dim sql As String     Dim val     Dim db_data_end_row As Long      ' ãƒ‡ãƒ¼ã‚¿ã®æœ€çµ‚è¡Œã‚’æ¤œç´¢     i = 1     Do While sheet.Cells(db_data_start_row + i, db_data_start_col) <> \"\"         i = i + 1     Loop      db_data_end_row = db_data_start_row + i - 1      For i = db_data_start_row To db_data_end_row          createAndExcuteOracleSql table_name, sheet, sql_type_defined_row, db_col_name_defined_row, i, db_data_start_col      Next  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : INSERT or UPDATE or DELETE SQLæ–‡ã‚’ä½œæˆ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Function createOracleSql(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long) As String      Dim sql As String     sql = \"\"      Select Case checkSqlType(sheet, sql_type_defined_row, db_data_start_col)          Case \"INSERT\"             sql = createInsertOracleSql(table_name, sheet, sql_type_defined_row, db_col_name_defined_row, db_data_start_row, db_data_start_col)             createOracleSql = sql             Exit Function          Case \"UPDATE\"             sql = createUpdateOracleSql(table_name, sheet, sql_type_defined_row, db_col_name_defined_row, db_data_start_row, db_data_start_col)             createOracleSql = sql             Exit Function          Case \"DELETE\"             sql = createDeleteOracleSql(table_name, sheet, sql_type_defined_row, db_col_name_defined_row, db_data_start_row, db_data_start_col)             createOracleSql = sql             Exit Function      End Select      createOracleSql = sql  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : Excelã‹ã‚‰ä½œæˆã™ã‚‹SQLã‚¿ã‚¤ãƒ—ãŒINSERT,UPDATE,DELTEã®ã©ã‚Œã‹ãªã®ã‹ç¢ºèª ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function checkSqlType(sheet As Worksheet, type_start_row As Long, type_start_col As Long) As String      Dim start_col As Long, end_col As Long      Dim i As Long      checkSqlType = \"\"      start_col = type_start_col     end_col = getMaxColRight(sheet, type_start_row, type_start_col)      For i = start_col To end_col         Select Case sheet.Cells(type_start_row, i)              Case \"INSERT\"                 checkSqlType = \"INSERT\"                 Exit Function              Case \"UPDATE\"                 checkSqlType = \"UPDATE\"                 Exit Function              Case \"DELETE\"                 checkSqlType = \"DELETE\"                 Exit Function          End Select     Next      MsgBox \"DBManager.checkSqlType:SQLã‚¿ã‚¤ãƒ—ã®è¨­å®šãŒé–“é•ã£ã¦ã„ã¾ã™ã€‚INSERT,UPDATE,DELETEãŒå«ã¾ã‚Œã¦ã„ã¾ã›ã‚“ã€‚\"     End  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : INSERT SQLæ–‡ã‚’ä½œæˆ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function createInsertOracleSql(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long) As String      Dim i As Long, j As Long     Dim start_row As Long, start_col As Long, end_col As Long      Dim sqltype As String     Dim sql As String, sql_1 As String, sql_2 As String      start_row = db_data_start_row     start_col = db_data_start_col     end_col = getMaxColRight(sheet, start_row, start_col)      sqltype = sheet.Cells(sql_type_defined_row, start_col).Value      i = start_row      ' INSERTæ–‡ã®ç”Ÿæˆ     sql = \"\"     sql_1 = \"INSERT INTO \" & table_name & \" (\"     sql_2 = \"VALUES (\"      For j = start_col To end_col          ' DBã‚«ãƒ©ãƒ åã‚’è¿½åŠ          sql_1 = sql_1 & sheet.Cells(db_col_name_defined_row, j).Value         If j <> end_col Then             sql_1 = sql_1 & \", \"         Else             sql_1 = sql_1 & \") \"         End If          ' DBã‚«ãƒ©ãƒ åã«å¯¾ã™ã‚‹å€¤ã‚’è¿½åŠ          sql_2 = sql_2 & \"'\" & sheet.Cells(i, j).Value & \"'\"         If j <> end_col Then             sql_2 = sql_2 & \", \"         Else             sql_2 = sql_2 & \") \"         End If      Next      sql = sql_1 + sql_2      sql = Replace(sql_1 + sql_2, \", WHERE\", \" WHERE\")     If Right(sql, 1) = \",\" Then sql = Mid(sql, 1, Len(sql) - 1)     If Right(sql, 5) = \" AND \" Then sql = Mid(sql, 1, Len(sql) - 5)      createInsertOracleSql = sql  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : UPDATE SQLæ–‡ã‚’ä½œæˆ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function createUpdateOracleSql(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long) As String      Dim i As Long, j As Long     Dim start_row As Long, start_col As Long, end_col As Long      Dim sqltype As String     Dim sql As String, sql_1 As String, sql_2 As String      start_row = db_data_start_row     start_col = db_data_start_col     end_col = getMaxColRight(sheet, start_row, start_col)      sqltype = sheet.Cells(sql_type_defined_row, start_col).Value      i = start_row      ' UPDATEæ–‡ã®ç”Ÿæˆ     sql = \"\"     sql_1 = \"UPDATE \" & table_name & \" SET \"     sql_2 = \"WHERE \"      For j = start_col To end_col          If sheet.Cells(sql_type_defined_row, j).Value = \"UPDATE\" Then              ' UPDATEã™ã‚‹DBã‚«ãƒ©ãƒ åã¨å€¤ã‚’è¿½åŠ              sql_1 = sql_1 & sheet.Cells(db_col_name_defined_row, j).Value & \" = '\" _                  & sheet.Cells(i, j).Value & \"'\"             If j <> end_col Then                 sql_1 = sql_1 & \", \"             Else                 sql_1 = sql_1 & \" \"             End If          ElseIf sheet.Cells(sql_type_defined_row, j).Value = \"WHERE\" Then              ' WHEREã«å¯¾ã™ã‚‹DBã‚«ãƒ©ãƒ åã¨å€¤ã‚’è¿½åŠ              sql_2 = sql_2 & sheet.Cells(db_col_name_defined_row, j).Value & \" = '\" _                  & sheet.Cells(i, j).Value & \"'\"             If j <> end_col Then                 sql_2 = sql_2 & \" AND \"             Else                 sql_2 = sql_2 & \" \"             End If          Else             Debug.Print (\"UPDATEæ–‡ã«å¯¾ã—ã¦ã€SQLã‚¿ã‚¤ãƒ—è¨­å®šãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚è¨­å®šã‚’è¦‹ç›´ã—ã¦ä¸‹ã•ã„ã€‚\")             Exit Function         End If     Next      sql = sql_1 + sql_2      sql = Replace(sql_1 + sql_2, \", WHERE\", \" WHERE\")     If Right(sql, 1) = \",\" Then sql = Mid(sql, 1, Len(sql) - 1)     If Right(sql, 5) = \" AND \" Then sql = Mid(sql, 1, Len(sql) - 5)      createUpdateOracleSql = sql  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : DELETE SQLæ–‡ã‚’ä½œæˆ ' note  : å¼•æ•° '         ãƒ†ãƒ¼ãƒ–ãƒ«åã€ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆã€SQLã‚¿ã‚¤ãƒ—æŒ‡å®šè¡Œã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚«ãƒ©ãƒ åæŒ‡å®šè¡Œ '         ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œã€ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function createDeleteOracleSql(table_name As String, sheet As Worksheet, sql_type_defined_row As Long, db_col_name_defined_row As Long _     , db_data_start_row As Long, db_data_start_col As Long) As String      Dim i As Long, j As Long     Dim start_row As Long, start_col As Long, end_col As Long      Dim sqltype As String     Dim sql As String, sql_1 As String, sql_2 As String      start_row = db_data_start_row     start_col = db_data_start_col     end_col = getMaxColRight(sheet, start_row, start_col)      sqltype = sheet.Cells(sql_type_defined_row, start_col).Value      i = start_row      ' DELETEæ–‡ã®ç”Ÿæˆ     sql = \"\"     sql_1 = \"DELETE FROM \" & table_name & \" \"     sql_2 = \"WHERE \"      For j = start_col To end_col          If sheet.Cells(sql_type_defined_row, j).Value = \"DELETE\" Then              ' WHEREã«å¯¾ã™ã‚‹DBã‚«ãƒ©ãƒ åã¨å€¤ã‚’è¿½åŠ              sql_2 = sql_2 & sheet.Cells(db_col_name_defined_row, j).Value & \" = '\" _                  & sheet.Cells(i, j).Value & \"'\"             If j <> end_col Then                 sql_2 = sql_2 & \" AND \"             Else                 sql_2 = sql_2 & \" \"             End If          Else             Debug.Print (\"DELETEæ–‡ã«å¯¾ã—ã¦ã€SQLã‚¿ã‚¤ãƒ—è¨­å®šãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚è¨­å®šã‚’è¦‹ç›´ã—ã¦ä¸‹ã•ã„ã€‚\")             Exit Function         End If     Next      sql = sql_1 + sql_2      sql = Replace(sql_1 + sql_2, \", WHERE\", \" WHERE\")     If Right(sql, 1) = \",\" Then sql = Mid(sql, 1, Len(sql) - 1)     If Right(sql, 5) = \" AND \" Then sql = Mid(sql, 1, Len(sql) - 5)      createDeleteOracleSql = sql  End Function ```  ä»Šå›ã¯ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚  ä»Šå›èª¬æ˜ã—ãŸæ©Ÿèƒ½ã‚’æ´»ç”¨ã™ã‚Œã°ã€ä¾‹ãˆã°ã€æ¥­å‹™ã§æ‰±ã†å¸³ç¥¨ç­‰ã‚’Excelã§å…¥åŠ›ã—ã€å…¥åŠ›ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã™ã‚‹ã“ã¨ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚  æ¬¡å›ã¯ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã«å¿œã˜ã¦ã€€INSERT or UPDATEã€€ã‚’é¸æŠã™ã‚‹MERGEæ–‡ã‚’å®Ÿè¡Œã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚   æ¬¡å›ã®MERGEæ–‡ç”Ÿæˆæ©Ÿèƒ½ã¾ã§æº–å‚™ã—ã¦ãŠã‘ã°ã€Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹Excelãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã¨ã—ã¦æ‰±ãˆã‚‹ã®ã§ã¯ãªã„ã§ã—ã‚‡ã†ã‹ã€‚ "
    },
    "_id": "blog/23-excel3-sql-insert-update-delete-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/23-excel3-sql-insert-update-delete-excel-vba.mdx",
      "sourceFileName": "23-excel3-sql-insert-update-delete-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/23-excel3-sql-insert-update-delete-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/23-excel3-sql-insert-update-delete-excel-vba",
    "slugAsParams": "23-excel3-sql-insert-update-delete-excel-vba"
  },
  {
    "title": "VBA | DBæ“ä½œ â€“ ç¬¬4å›ï¼šExcel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ",
    "description": "Excelãƒã‚¯ãƒ­ ç¬¬4å›ï¼š[Excel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ]",
    "date": "2020-04-17T00:00:00.000Z",
    "emoji": "â›",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " DBæ“ä½œã‚’è¡Œã†Excelãƒã‚¯ãƒ­ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ä»Šå›ã®è¨˜äº‹ã¯ã€ç¬¬4å›ã€ã¨ãªã‚Šã¾ã™ã€‚  ç¬¬1å›ï¼š[Configã‚·ãƒ¼ãƒˆã®è¨­å®šå€¤ã‚’VBAä¸Šã§å–ã‚Šæ‰±ã†](/blog/21-excel1-config-sheet-excel-vba/)   ç¬¬2å›ï¼š[SELECTæ–‡ã«ã‚ˆã‚Šå–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’Excelã«æ ¼ç´](/blog/22-excel2-sql-select-excel-vba/)   ç¬¬3å›ï¼š[Excel ã‹ã‚‰ INSERT, UPDATE, DELETE ã‚’å®Ÿè¡Œ](/blog/23-excel3-sql-insert-update-delete-excel-vba/)   ç¬¬4å›ï¼š[Excel ã‹ã‚‰ MERGE ã‚’å®Ÿè¡Œ](/blog/24-excel4-sql-merge-excel-vba/)    [ã€Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/template-excel-vba/tree/main/Template_OracleDB%E6%93%8D%E4%BD%9C)  â€»2021/2/5æ”¹ä¿®ç‰ˆ   ã€€ãƒ»ODBCæ¥ç¶šã‹ã‚‰OraOLEDB.Oracleæ¥ç¶šã«å¤‰æ›´   ã€€ãƒ»INSER,UPDATE,MERGEæ–‡ã®ç”Ÿæˆæ–¹æ³•ã‚’ä¿®æ­£    ___ ## æ¦‚è¦ ç¬¬4å›ç›®ã¯ã€ç¬¬3å›ã§å®Ÿè£…ã—ãŸExcelã‚·ãƒ¼ãƒˆã«æ ¼ç´ã—ãŸãƒ‡ãƒ¼ã‚¿ï¼ˆã‚»ãƒ«ã®å€¤ï¼‰ã‚’ã€æŒ‡å®šã—ãŸDBï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼‰ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æŒ¿å…¥ãƒ»æ›´æ–°ãƒ»å‰Šé™¤ã™ã‚‹æ–¹æ³•ã«åŠ ãˆã¦ã€ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥ or æ›´æ–°ï¼ˆMERGEï¼‰ã‚’è¿½åŠ ã§å®Ÿè£…ã—ã¾ã—ãŸã€‚  ![image](/blog/24/01.png)  MERGEå®Ÿè¡Œæ©Ÿèƒ½ã‚’è¿½åŠ ã—ãŸã®ã§ã€ä»Šå›ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹æ©Ÿèƒ½ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚  |ã‚¿ã‚¤ãƒ—|æ©Ÿèƒ½| |:--|:--| INSERT|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æŒ¿å…¥ï¼‰ UPDATE|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–° ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰æ›´æ–°ï¼‰ DELETE|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆãƒ¬ã‚³ãƒ¼ãƒ‰å‰Šé™¤ï¼‰ MERGE|DBã®ãƒ†ãƒ¼ãƒ–ãƒ«ã«æ ¼ç´ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã‚‚ã—ãã¯æ›´æ–°  ___ ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿è¨˜è¼‰ï¼‰  ```text Template_ver1.x.x.xlsm â”œæ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |   â”œmodCmnGlbConst |   â”œmodSql    | ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«     â”œConfigurator     â”œDBManager ```  ___ ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬ å‰å›ã¾ã§ã€INSERTãƒ»UPDATEãƒ»DELETEãƒ»MERGEã®å„ã‚·ãƒ¼ãƒˆã‹ã‚‰å®Ÿè¡Œã•ã‚Œã‚‹ãƒã‚¯ãƒ­ã¯ãã‚Œãã‚Œåˆ¥é–¢æ•°ã¨ã—ã¦ç‹¬ç«‹ã•ã›ã¦ã„ã¾ã—ãŸã€‚  ãã‚Œã§ã¯ã€ä»Šå¾Œæ©Ÿèƒ½ã‚’æ‹¡å¼µã™ã‚‹éš›ã«ä¸ä¾¿ã‹ã¨æ€ã„ã¾ã—ãŸã®ã§ã€INSERTãƒ»UPDATEãƒ»DELETEãƒ»MERGEã®å„ã‚·ãƒ¼ãƒˆã‹ã‚‰å®Ÿè¡Œã—ãŸãƒã‚¯ãƒ­ã¯ã€ä¸€ã¤ã®é–¢æ•°ã‚’çµŒç”±ã—ã¦ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚¯ãƒ©ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã‚ˆã†ã«æ”¹ä¿®ã—ã¾ã—ãŸã€‚ï¼ˆã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ä¸‹è¨˜ç”»åƒï¼‰  ![image](/blog/24/02.png)  ä¾‹ãˆã°ã€MERGEæ–‡ã®å®Ÿè¡Œã§ã¯ executeMergeSqlsOracle() ã‚’å®Ÿè¡Œã—ã€ãã®ä¸­ã§ executeDmlSqlsOracle é–¢æ•°ã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚   ï¼ˆä¸‹è¨˜ã«ä¸€éƒ¨ã®ã‚³ãƒ¼ãƒ‰ã‚’è¨˜è¼‰ã—ã¦ã„ã¾ã™ãŒã€è©³ç´°ã¯Excelãƒ•ã‚¡ã‚¤ãƒ«ã®VBAã‚’ç¢ºèªã—ã¦ã¿ã¦ãã ã•ã„ã€‚ï¼‰  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : D.å„MERGEæ–‡ã‚’é€£ç¶šå®Ÿè¡Œ ' note  : Oracleå¯¾å¿œ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub executeMergeSqlsOracle()      Dim sheet As Worksheet          ' SQLã‚’ç”Ÿæˆã™ã‚‹æƒ…å ±ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹ã‚·ãƒ¼ãƒˆ     Dim tableName As String         ' æ“ä½œã™ã‚‹å¯¾è±¡ã®ãƒ†ãƒ¼ãƒ–ãƒ«      Set sheet = ThisWorkbook.Worksheets(MERGE_SHEET_NAME)     tableName = sheet.Cells(TABLE_NAME_ROW, TABLE_NAME_COL)      executeDmlSqlsOracle \"MERGE\", tableName, sheet, TYPE_DIFINED_ROW, DB_COL_NAME_DIFINED_ROW, DATA_START_ROW, DATA_START_COL  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : å„INSERT, UPDATE, DELETE, MERGEæ–‡ã‚’é€£ç¶šå®Ÿè¡Œ ' note  : Oracleå¯¾å¿œ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub executeDmlSqlsOracle(dmlType As String, tableName As String, sheet As Worksheet _     , typeDifinedRow As Long, dbColNameDifinedRow As Long, dataStartRow As Long, dataStartCol As Long)      Dim servicename As String, username As String, password As String      ' Config è¨­å®šã®èª­ã¿è¾¼ã¿     Set config = New Configurator     config.setData ThisWorkbook.Worksheets(GLB_CONFIG_SHEET), GLB_CONFIG_KEY_COL, GLB_CONFIG_ITEM_COL, GLB_CONFIG_START_ROW      servicename = config.getItem(\"SERVICE_NAME\")     username = config.getItem(\"USERNAME\")     password = config.getItem(\"PASSWORD\")      ' DBæ¥ç¶š     Set dbManagerOracle = New DBManager     dbManagerOracle.openOracle servicename, username, password      ' ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³é–‹å§‹     dbManagerOracle.begintrans      On Error GoTo err      ' SQLå®Ÿè¡Œ     dbManagerOracle.createAndExcuteOracleSqls tableName, sheet, typeDifinedRow, dbColNameDifinedRow, dataStartRow, dataStartCol      ' ã‚³ãƒŸãƒƒãƒˆ     dbManagerOracle.committrans      ' DBåˆ‡æ–­     dbManagerOracle.closeConnection      Select Case dmlType          Case \"INSERT\"             Application.StatusBar = Now & \"SQL INSERTå®Ÿè¡Œå®Œäº†\"          Case \"UPDATE\"             Application.StatusBar = Now & \"SQL UPDATEå®Ÿè¡Œå®Œäº†\"          Case \"DELETE\"             Application.StatusBar = Now & \"SQL DELETEå®Ÿè¡Œå®Œäº†\"          Case \"MERGE\"             Application.StatusBar = Now & \"SQL MERGEå®Ÿè¡Œå®Œäº†\"      End Select      Exit Sub  err:     ' ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã¯ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯     Debug.Print \"ã‚¨ãƒ©ãƒ¼ç•ªå·:\" & err.Number & Chr(13) & \"ã‚¨ãƒ©ãƒ¼å†…å®¹:\" & err.Description     MsgBox \"ã‚¨ãƒ©ãƒ¼ç•ªå·:\" & err.Number & Chr(13) & \"ã‚¨ãƒ©ãƒ¼å†…å®¹:\" & err.Description      MsgBox \"ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚’å®Ÿè¡Œã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã—ã¾ã™ã€‚\"     dbManagerOracle.rollbacktrans      End  End Sub ```  ä»Šå›ã¯ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚ã“ã‚Œã§Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒã‚¯ãƒ­ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹æ–¹æ³•ã®èª¬æ˜ã¯çµ‚äº†ã¨ãªã‚Šã¾ã™ã€‚  ã“ã‚Œã¾ã§èª¬æ˜ã—ã¦ããŸã‚ˆã†ãªã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã™ã‚‹éƒ¨åˆ†â€ã®ã¿â€ã‚’äºˆã‚è£½ä½œã—ã¦ãŠã‘ã°ã€ä»–ã®ç”¨é€”ã«å¿œã˜ã¦è¿½åŠ æ”¹é€ ã™ã‚‹ã“ã¨ã§æ§˜ã€…ãªå ´é¢ã«å¯¾å¿œã§ãã¾ã™ã€‚  åŸºæœ¬æ©Ÿèƒ½ã‚’æº–å‚™ã—ã¦ãŠãã“ã¨ã®å¤§åˆ‡ã•ã‚’å…±æ„Ÿã—ã¦é ‚ã‘ã‚Œã°å¹¸ã„ã§ã™ã€‚ "
    },
    "_id": "blog/24-excel4-sql-merge-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/24-excel4-sql-merge-excel-vba.mdx",
      "sourceFileName": "24-excel4-sql-merge-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/24-excel4-sql-merge-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/24-excel4-sql-merge-excel-vba",
    "slugAsParams": "24-excel4-sql-merge-excel-vba"
  },
  {
    "title": "VBA | åˆ¥Excelã®ãƒ‡ãƒ¼ã‚¿å–å¾—",
    "description": "åˆ¥ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹Excelãƒã‚¯ãƒ­",
    "date": "2020-05-01T00:00:00.000Z",
    "emoji": "ğŸ–‹",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " åˆ¥ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãƒã‚¯ãƒ­ã‚’è£½ä½œã—ã¾ã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚  [ã€Excelãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/template-excel-vba/tree/main/%E5%88%A5Excel%E3%81%AE%E3%83%87%E3%83%BC%E3%82%BF%E5%8F%96%E5%BE%97)  ___ ## æ¦‚è¦ Excelãƒã‚¯ãƒ­ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€æŒ‡å®šã—ãŸåˆ¥Excelã®ãƒ‡ãƒ¼ã‚¿ã‚’è»¢è¨˜ã—ã¾ã™ã€‚  ![image](/blog/25/01.png)  ___ ## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ Excelãƒã‚¯ãƒ­å†…ã®æ§‹æˆã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ ã€‚ ï¼ˆä½¿ç”¨ã™ã‚‹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã¿ä¸‹è¨˜ã«è¨˜è¼‰ï¼‰  ```text åˆ¥Excelãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‡ãƒ¼ã‚¿å–å¾—.xlsm â”œæ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« |   â”œmodCmnFunction |   â”œmodExcelExtractor | ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«     â”œExcelExtractor ```  ___ ## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰è§£èª¬  ___ ### â‘ ExcelExtractor åˆ¥Excelã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’æŠ½å‡ºã™ã‚‹æ©Ÿèƒ½ã‚’æŒã£ãŸã‚¯ãƒ©ã‚¹ã§ã™ã€‚ è§£èª¬ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ExcelExtractor ã‚¯ãƒ©ã‚¹ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  Option Explicit  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ã€æ´»ç”¨æ‰‹é †ã€€ä¾‹ã€‘ ' â‘  ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç”Ÿæˆ ' â‘¡ setFileSheet   ï¼šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€Excelæƒ…å ±ã‚’ã‚¤ãƒ³ãƒ—ãƒƒãƒˆ ' â‘¡Â´ï¼ˆãƒ‡ãƒ¼ã‚¿å–å¾—ã«æ™‚é–“ãŒæ›ã‹ã‚‹å ´åˆã€ã“ã“ã§æŠ½å‡ºå…ƒã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ãŠãï¼‰ ' â‘¢ setDataRows    ï¼šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€é–‹å§‹è¡Œã‹ã‚‰çµ‚äº†è¡Œã‚’æ±ºå®š ' â‘£ setDataArray   ï¼šç‰¹å®šã®åˆ—ã«å¯¾ã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’ä¸€æ™‚çš„ã«æ ¼ç´ ' â‘¤ pasteData      ï¼šæŒ‡å®šã—ãŸExcelãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚»ãƒ«ã«æ ¼ç´ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  ' ãƒ¡ãƒ³ãƒå¤‰æ•°ï¼ˆMe.ã§å‚ç…§å¯èƒ½ã¨ã™ã‚‹ãŸã‚publicï¼‰ Public target As String         ' ãƒ•ã‚©ãƒ«ãƒ€å + \"[\" + ãƒ•ã‚¡ã‚¤ãƒ«å + \"]\" + ã‚·ãƒ¼ãƒˆå + \"!\" Public dataFirstRow As Long     ' æŠ½å‡ºå…ƒã®Excelãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹æœ€åˆã®è¡Œ Public dataLastRow As Long      ' æŠ½å‡ºå…ƒã®Excelãƒ‡ãƒ¼ã‚¿ãŒæ ¼ç´ã•ã‚Œã¦ã„ã‚‹æœ€å¾Œã®è¡Œ  Private data() As Variant       ' æŠ½å‡ºå…ƒã®Excelãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹é…åˆ—  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub Class_Initialize()      ReDim data(0)  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã‚€å¯¾è±¡Excelã®ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆãƒ•ãƒ«ãƒ‘ã‚¹ï¼‰ã€ã‚·ãƒ¼ãƒˆåã‚’è¨­å®š ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub setFileSheet(filePath As String, sheetName As String)      Dim path As String, buf As String      ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã‘ã‚Œã°çµ‚äº†     If Dir(filePath) = \"\" Then         MsgBox (filePath & \" ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚\" & Chr(13) _             & \"ãƒ•ã‚©ãƒ«ãƒ€åã¨ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç¢ºèªã—ã¦ä¸‹ã•ã„ã€‚\")         Exit Sub     End If      ' ãƒ•ã‚¡ã‚¤ãƒ«åã«[]ã‚’ä»˜ã‘ã‚‹     path = Replace(filePath, Dir(filePath), \"[\" & Dir(filePath) & \"]\")     Debug.Print path      ' å¯¾è±¡ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆåã‚’å–å¾—     Me.target = \"'\" & path & sheetName & \"'!\"       ' ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆåãŒæ­£ã—ã„ã‹ã©ã†ã‹ã€ã¾ãšèª­ã¿è¾¼ã‚“ã§ã¿ã‚‹     On Error Resume Next     buf = ExecuteExcel4Macro(Me.target & \"R1C1\")     If Err <> 0 Then         MsgBox \"ãƒ¯ãƒ¼ã‚¯ã‚·ãƒ¼ãƒˆ [ \" & sheetName & \" ] ã‚’èª­ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚\", vbExclamation         Exit Sub     End If     On Error GoTo 0 '// ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®å‘½ä»¤å–ã‚Šæ¶ˆã—      Debug.Print target  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã£ã¦ã„ã‚‹é–‹å§‹è¡Œãƒ»çµ‚äº†è¡Œã‚’ç‰¹å®š ' note  : ã‚«ãƒ©ãƒ åãŒå­˜åœ¨ã™ã‚‹ãªã‚‰ã°ã€ãƒ‡ãƒ¼ã‚¿æ¤œç´¢é–‹å§‹è¡Œã‹ã‚‰ä¸‹å´ã«æ¤œç´¢ã‚’é€²ã‚ã¦æœ€çµ‚è¡Œã‚’ç‰¹å®šã™ã‚‹ã€‚ '         â€»ä¸‹å´ã¸ã®æ¤œç´¢æ™‚ã€ç©ºç™½æ•°ãŒé€£ç¶šã—ã¦è¨­å®šæ•°æœªæº€ã§ã‚ã‚Œã°æ¤œç´¢ã‚’é€²ã‚ã‚‹ã€‚ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub setDataRows(fieldName As String, fieldRow As Long, fieldCol As Long, dataFirstRow As Long, serchEndBlankCount As Long)      Dim i As Long     Dim buf As String     Dim blankCount As Long      ' ã‚«ãƒ©ãƒ åãŒå­˜åœ¨ã—ãªã‘ã‚Œã°çµ‚äº†     If isExistedFieldName(fieldName, fieldRow, fieldCol) = False Then         MsgBox \"Excelå°å¸³ã«ã‚«ãƒ©ãƒ å \" & fieldName & \" ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚\"         End     End If      ' ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿     i = 0     blankCount = 0      Do While blankCount < serchEndBlankCount          ' ãƒ‡ãƒ¼ã‚¿ã‚’èª­è¾¼         buf = ExecuteExcel4Macro(Me.target & \"R\" & dataFirstRow + i & \"C\" & fieldCol)          If buf = \"0\" Then blankCount = blankCount + 1 Else blankCount = 0    ' ã‚»ãƒ«ãŒç©ºç™½ãªã‚‰ãƒ–ãƒ©ãƒ³ã‚¯ã‚«ã‚¦ãƒ³ãƒˆã«+1          i = i + 1     Loop      Me.dataFirstRow = dataFirstRow     Me.dataLastRow = dataFirstRow + i - blankCount - 1     If Me.dataLastRow < Me.dataFirstRow Then Me.dataLastRow = Me.dataFirstRow      Debug.Print \"æ¤œç´¢ã«ã‚ˆã‚‹ã€€ãƒ‡ãƒ¼ã‚¿é–‹å§‹ï¼š\" & Me.dataFirstRow & \"ã€€ãƒ‡ãƒ¼ã‚¿çµ‚äº†ï¼š\" & Me.dataLastRow  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : æŒ‡å®šã—ãŸExceãƒ‡ãƒ¼ã‚¿ã‚’é…åˆ—ã«æ ¼ç´ã™ã‚‹ã€‚ ' note  : ä¸»ã« â‘  setDataArray â‘¡ pasteData ã‚’ã‚»ãƒƒãƒˆã§ä½¿ã†ã€‚ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub setDataArray(fieldName As String, fieldRow As Long, fieldCol As Long)      Dim i As Long     Dim buf As String      ' ã‚«ãƒ©ãƒ åãŒå­˜åœ¨ã—ãªã‘ã‚Œã°çµ‚äº†     If isExistedFieldName(fieldName, fieldRow, fieldCol) = False Then         MsgBox \"Excelå°å¸³ã«ã‚«ãƒ©ãƒ å \" & fieldName & \" ãŒå­˜åœ¨ã—ã¾ã›ã‚“ã€‚\"         ReDim data(0)         Exit Sub     End If      ' æ ¼ç´ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªã‚¢     Call clearData       ' ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿     For i = Me.dataFirstRow To Me.dataLastRow          buf = ExecuteExcel4Macro(Me.target & \"R\" & i & \"C\" & fieldCol)         addData buf      Next  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : æŒ‡å®šã—ãŸExcelãƒ•ã‚¡ã‚¤ãƒ«ã®ç‰¹å®šã‚»ãƒ«ã«æ ¼ç´ã—ã¦ã„ãŸãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒãƒˆ ' note  : ä¸»ã« â‘  setDataArray â‘¡ pasteData ã‚’ã‚»ãƒƒãƒˆã§ä½¿ã†ã€‚ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub pasteData(Workbook As Workbook, sheetName As String, row As Long, col As Long)      Dim i As Long      For i = 0 To countData          Workbook.Worksheets(sheetName).Cells(row + i, col) = getDataVal(i)         Debug.Print \"iï¼š\" & i & \"ã€€ã€€è¡Œï¼š\" & row + i & \"ã€€ã€€å€¤ï¼š\" & getDataVal(i)      Next  End Sub ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : åˆ¥Excelã®ã‚«ãƒ©ãƒ åãŒå­˜åœ¨ã™ã‚‹ã‹åˆ¤å®šã™ã‚‹é–¢æ•° ' note  : Excelã®è¡Œåˆ—ãŒå¤‰ã‚ã£ã¦ã„ãªã„ã‹ã©ã†ã‹ã®ãƒã‚§ãƒƒã‚¯ç”¨ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function isExistedFieldName(fieldName As String, row As Long, col As Long) As Boolean      Dim buf As String      buf = ExecuteExcel4Macro(Me.target & \"R\" & row & \"C\" & col)      If InStr(buf, fieldName) > 0 Then isExistedFieldName = True _         Else isExistedFieldName = False  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ‡ãƒ¼ã‚¿ã®å€¤ã‚’é…åˆ—ã«è¿½åŠ  ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub addData(ByVal val)     On Error Resume Next      Dim i      i = countData      If (IsEmpty(data(i)) = True) Then         data(i) = val     Else         ReDim Preserve data(i + 1)         data(i + 1) = val     End If  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : æŒ‡å®šè¦ç´ ä½ç½®ã®å€¤ã‚’å–å¾—ã™ã‚‹ ' note  : Javaã®ArrayList.Getã¨ä¸€ç·’ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function getDataVal(index)     Dim v_ret As Variant      If (index > countData) Then         v_ret = Null     Else         v_ret = data(index)     End If      getDataVal = v_ret End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ‡ãƒ¼ã‚¿é…åˆ—ã®è¦ç´ æ•°ã‚’èª¿ã¹ã‚‹ã€‚ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function countData() As Long     countData = UBound(data) End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : ãƒ‡ãƒ¼ã‚¿é…åˆ—ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ã€‚ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub clearData()     ReDim data(0) End Sub ```  ___ ## â‘¡modExcelExtractor ExcelExtractor ã‚’æ‰±ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ã™ã€‚   è§£èª¬ã¯ã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦è¨˜è¼‰ã—ã¦ã„ã¾ã™ã€‚  ```vb Option Explicit  Const MAIN_DATA_FIELD_NAME_DEFINED_ROW = 10         ' æŠ½å‡ºã™ã‚‹Excelãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åã«å«ã¾ã‚Œã‚‹æ–‡å­—åˆ—ã‚’å®šç¾©ã—ã¦ã„ã‚‹è¡Œ Const MAIN_DATA_FIELD_ROW_DEFINED_ROW = 11          ' æŠ½å‡ºã™ã‚‹Excelãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰åãŒå«ã¾ã‚Œã‚‹è¡Œã‚’å®šç¾©ã—ã¦ã„ã‚‹è¡Œ Const MAIN_DATA_FIELD_COL_DEFINED_ROW = 12          ' æŠ½å‡ºã™ã‚‹Excelãƒ‡ãƒ¼ã‚¿ã®åˆ—ã‚’å®šç¾©ã—ã¦ã„ã‚‹è¡Œ Const MAIN_DATA_START_ROW_DEFINED_ROW = 13          ' æŠ½å‡ºã™ã‚‹Excelãƒ‡ãƒ¼ã‚¿ã®é–‹å§‹è¡Œã‚’å®šç¾©ã—ã¦ã„ã‚‹è¡Œ Const MAIN_DATA_FORMAT_DEFINED_ROW = 14             ' æŠ½å‡ºã™ã‚‹Excelãƒ‡ãƒ¼ã‚¿ã®æ›¸å¼ã‚’å®šç¾©ã—ã¦ã„ã‚‹è¡Œ  Const MAIN_DATA_START_ROW = 15                      ' ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹è¡Œ Const MAIN_DATA_START_COL = 2                       ' ãƒ‡ãƒ¼ã‚¿æ ¼ç´é–‹å§‹åˆ—  Dim mainSheet As Worksheet  Dim excelPath As String Dim excelSheetName As String  Dim excelSearchFieldName As String Dim excelSearchFieldNameRow As Long Dim excelSearchFieldNameCol As Long Dim excelSearchDataStartRow As Long Dim excelSearchEndMultiBlank As Long  Dim extractor As ExcelExtractor  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : Excelã®ãƒ‡ãƒ¼ã‚¿å–å¾— ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Sub extractExcelData()      Set extractor = New ExcelExtractor      ' Excelãƒ‡ãƒ¼ã‚¿ç”¨ã®ã‚»ãƒ«ã‚¯ãƒªã‚¢     clearDataSimplified ActiveSheet, MAIN_DATA_START_ROW, MAIN_DATA_START_COL      ' Excelã‚„DBã®è¨­å®šæƒ…å ±å–å¾—     setInfo      ' ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚‹Excelã‚’è¨­å®š     extractor.setFileSheet excelPath, excelSheetName      ' Excelã‚’ã‚ªãƒ¼ãƒ—ãƒ³ï¼ˆby modCmnFunctionï¼‰     openFile excelPath      ' Excelã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚‹è¡Œã®é–‹å§‹ã¨çµ‚äº†ã‚’æ±ºå®š     extractor.setDataRows excelSearchFieldName, excelSearchFieldNameRow, excelSearchFieldNameCol, _         excelSearchDataStartRow, excelSearchEndMultiBlank      ' Excelã‹ã‚‰ãƒ‡ãƒ¼ã‚¿å–å¾—     pasteExcelData mainSheet      ' Excelã‚’ã‚¯ãƒ­ãƒ¼ã‚ºï¼ˆby modCmnFunctionï¼‰     closeOpenedFile False  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : Excelã‹ã‚‰åŸºæœ¬æƒ…å ±ã‚’ã‚»ãƒƒãƒˆ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub setInfo()      Set mainSheet = ActiveSheet      excelPath = ActiveSheet.Cells(1, 2).Value     excelSheetName = ActiveSheet.Cells(2, 2).Value      excelSearchFieldName = ActiveSheet.Cells(4, 2).Value     excelSearchFieldNameRow = ActiveSheet.Cells(5, 2).Value     excelSearchFieldNameCol = ActiveSheet.Cells(6, 2).Value     excelSearchDataStartRow = ActiveSheet.Cells(7, 2).Value     excelSearchEndMultiBlank = ActiveSheet.Cells(8, 2).Value  End Sub  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief : Excelå°å¸³ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’ã‚»ãƒƒãƒˆã™ã‚‹ã€‚ ' note  : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Function pasteExcelData(sheet As Worksheet)      Dim i As Long     Dim col As Variant      Dim field_name As String     Dim field_row As Long     Dim field_col As Long     Dim format As String      Debug.Print sheet.Name     i = 0     col = sheet.Cells(MAIN_DATA_FIELD_NAME_DEFINED_ROW, MAIN_DATA_START_COL).Value     Do While col <> \"\"          ' Excelã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ãŸã‚ã®æ¡ä»¶å–å¾—         field_name = sheet.Cells(MAIN_DATA_FIELD_NAME_DEFINED_ROW, MAIN_DATA_START_COL + i)         field_row = sheet.Cells(MAIN_DATA_FIELD_ROW_DEFINED_ROW, MAIN_DATA_START_COL + i)         field_col = sheet.Cells(MAIN_DATA_FIELD_COL_DEFINED_ROW, MAIN_DATA_START_COL + i)          ' Excelã®ãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘         extractor.setDataArray field_name, field_row, field_col         extractor.pasteData ThisWorkbook, sheet.Name, MAIN_DATA_START_ROW, MAIN_DATA_START_COL + i          ' Excelã‹ã‚‰å–å¾—ã—ãŸãƒ‡ãƒ¼ã‚¿ã®æ›¸å¼ã‚’å¤‰æ›´         format = sheet.Cells(MAIN_DATA_FORMAT_DEFINED_ROW, MAIN_DATA_START_COL + i)         changeFormatMaxRowBelow sheet, MAIN_DATA_START_ROW, MAIN_DATA_START_COL + i, format          ' æ¬¡ã®å‡¦ç†ã¸ç§»ã‚‹æº–å‚™         i = i + 1         col = sheet.Cells(MAIN_DATA_FIELD_NAME_DEFINED_ROW, MAIN_DATA_START_COL + i).Value     Loop  End Function ```  ä»Šå›ã®Excelãƒã‚¯ãƒ­ã¯ã€å˜ä½“ã§ä½¿ç”¨ã™ã‚‹å ´é¢ã¯å°‘ãªã„ã¨æ€ã„ã¾ã™ã€‚  ä¾‹ãˆã°ã€è¤‡æ•°ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’é›†ç´„ã™ã‚‹ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰æŠ½å‡ºã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç™»éŒ²ã™ã‚‹ã€ã¨ã„ã†ã‚ˆã†ã«æ‹¡å¼µã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/25-get-another-excel-data-excel-vba.mdx",
    "_raw": {
      "sourceFilePath": "blog/25-get-another-excel-data-excel-vba.mdx",
      "sourceFileName": "25-get-another-excel-data-excel-vba.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/25-get-another-excel-data-excel-vba"
    },
    "type": "Post",
    "slug": "/blog/25-get-another-excel-data-excel-vba",
    "slugAsParams": "25-get-another-excel-data-excel-vba"
  },
  {
    "title": "C# | WPF Prism ç”»é¢é·ç§»ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ãƒˆï¼‰",
    "description": "C# WPF Prism ãƒŠãƒ“ã‚²ãƒ¼ãƒˆç”»é¢ã®é·ç§»æ–¹æ³•",
    "date": "2023-02-26T00:00:00.000Z",
    "emoji": "ğŸ¤–",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " C#ã® **WPF Prism** ã§ãƒŠãƒ“ã‚²ãƒ¼ãƒˆç”»é¢ã®é·ç§»æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ä¸‹è¨˜ã®ã‚ˆã†ã«ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ç”»é¢ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹å‡¦ç†ã§ã™ã€‚ ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã§ã¯ãªãã€ç”»é¢å†…ã®è¡¨ç¤ºãŒåˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚ï¼‰  ![image](/blog/26/1.gif)  ## å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼‰  ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸‹è¨˜ã® **Aï½C** ã§ã™ã€‚  ```text Views/  |-MainWindowView.xamlï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥A  |-SampleNavigationView.xaml(ç”»é¢é·ç§»å…ˆ)  ViewModels/  |-MainWindowViewModel.csï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥B  |-SampleNavigationViewModel.cs(ç”»é¢é·ç§»å…ˆ)ã€€ï½¥ï½¥ï½¥C  App.xaml.csã€€ï½¥ï½¥ï½¥D ```  ## MainWindowView.xamlï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥A  ### â‘ ãƒœã‚¿ãƒ³ã«Commandã‚’è¿½åŠ   ç”»é¢é·ç§»å…ƒã®Viewã®ãƒœã‚¿ãƒ³ã«å¯¾ã—ã¦ã€Commandã«Bindingã§ãƒ‡ãƒªã‚²ãƒ¼ãƒˆã‚³ãƒãƒ³ãƒ‰åç§°ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚  ```xml <Button Content=\"SampleãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢\"         FontSize=\"14\"         Margin=\"10\"         Padding=\"5\"         Command=\"{Binding SampleNavigationViewButton}\"/> ```  ## MainWindowViewModel.csï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥B  ### â‘¡ViewModelã«IRegionManagerã®å¤‰æ•°ã‚’è¿½åŠ   ç”»é¢é·ç§»å…ƒã®ViewModelã«ã€IRegionManagerã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå¤‰æ•°ã‚’è¿½åŠ ã—ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚  ### â‘¢ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ   ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹ãƒ‡ãƒªã‚²ãƒ¼ãƒˆã‚³ãƒãƒ³ãƒ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®Excuteãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  â–¼ä¸Šè¨˜â‘¡ï½â‘¢ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ ```cs private IRegionManager _regionManager;  //// ç”»é¢é·ç§»ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰  //// ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ public MainWindowViewModel(IRegionManager regionManager) {     //// ç”»é¢é·ç§»ç”¨ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰     _regionManager = regionManager;      SampleNavigationViewButton = new DelegateCommand(SampleNavigationViewButtonExecute); }  public DelegateCommand SampleNavigationViewButton { get; }  private void SampleNavigationViewButtonExecute() {    //// ç”»é¢é·ç§»å‡¦ç†ï¼ˆãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰    _regionManager.RequestNavigate(\"ContentRegion\", nameof(SampleNavigationView)); } ```  ## SampleNavigationViewModel.cs(ç”»é¢é·ç§»å…ˆ)ã€€ï½¥ï½¥ï½¥C  ### â‘£INavigationAwareã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£… ç”»é¢é·ç§»å…ˆã®ViewModelã«ã€**INavigationAwareã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** ã¨ **IRegionMemberLifetimeã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹**ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  â€»2023/3/5 è¿½è¨˜ ViewModelã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ãƒ¡ãƒ¢ãƒªé–‹æ”¾ã®ãŸã‚ã€IRegionMemberLifetimeã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®Ÿè£…ã‚’è¿½åŠ ã—ã¾ã—ãŸã€‚  ### â‘¤ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¤‰æ›´ INavigationAwareã‚’å®Ÿè£…ã—ãŸäº‹ã§è¿½åŠ ã•ã‚Œã‚‹ IsNavigationTarget ã® æˆ»ã‚Šå€¤ã‚’ true ã¨ã—ã€KeepAlive ã‚’ false ã«ã—ã¦ä¸‹ã•ã„ã€‚ãã†ã™ã‚Œã°ã€ç”»é¢ç ´æ£„ã§ãƒ¡ãƒ¢ãƒªãŒé–‹æ”¾ã•ã‚Œã¾ã™ã€‚  â–¼ä¸Šè¨˜â‘£ï½â‘¤ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ ```cs public class SampleTableEditViewModel : BindableBase, INavigationAware, IRegionMemberLifetime {     /// <summary>     /// ViewModelç ´æ£„ã«ä¼´ã„ãƒ¡ãƒ¢ãƒªé–‹æ”¾ã™ã‚‹éš›ã¯false     /// </summary>     public bool KeepAlive { get; set; } = false;      //// å„ç¨®å‡¦ç†      public bool IsNavigationTarget(NavigationContext navigationContext)     {         //// RegionMemberLifetime(KeepAlive = false)ã§ViewModelã‚’ç ´æ£„ã™ã‚‹ãŸã‚ã€ã“ã¡ã‚‰ã¯True         return true;     }      public virtual void OnNavigatedFrom(NavigationContext navigationContext)     {     }      public virtual void OnNavigatedTo(NavigationContext navigationContext)     {     } } ```  ## App.xaml.csã€€ï½¥ï½¥ï½¥D  ### â‘¥RegisterTypeså†…ã§Viewã‚’ç™»éŒ²  ```cs protected override void RegisterTypes(IContainerRegistry containerRegistry) {     //// ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢     containerRegistry.RegisterForNavigation<SampleNavigationView>(); } ```  containerRegistry.RegisterForNavigationã«è¨­å®šã—ãŸViewãŒç”»é¢é·ç§»å¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚ "
    },
    "_id": "blog/26-navigation-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/26-navigation-wpf-prism-cs.mdx",
      "sourceFileName": "26-navigation-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/26-navigation-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/26-navigation-wpf-prism-cs",
    "slugAsParams": "26-navigation-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism ç”»é¢é·ç§»ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰",
    "description": "C# WPF Prism ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”»é¢ã®é·ç§»æ–¹æ³•",
    "date": "2023-02-27T00:00:00.000Z",
    "emoji": "ğŸ”¨",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " C#ã® **WPF Prism** ã§ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”»é¢ï¼ˆåˆ¥ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ï¼‰ã‚’è¡¨ç¤ºã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚   ## å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼‰  ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸‹è¨˜ã® **Aï½D** ã§ã™ã€‚  ```text Views/  |-MainWindowView.xamlï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥A  |-SampleTableEditView.xaml(ç”»é¢é·ç§»å…ˆ)  ViewModels/  |-MainWindowViewModel.csï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥B  |-SampleTableEditViewModel.cs(ç”»é¢é·ç§»å…ˆ)ã€€ï½¥ï½¥ï½¥Cã€€  App.xaml.csã€€ï½¥ï½¥ï½¥D ```  ## MainWindowView.xamlï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥A  ### â‘ ãƒœã‚¿ãƒ³ã«Commandã‚’è¿½åŠ   ç”»é¢é·ç§»å…ƒã®Viewã®ãƒœã‚¿ãƒ³ã«å¯¾ã—ã¦ã€Commandã«Bindingã§ãƒ‡ãƒªã‚²ãƒ¼ãƒˆã‚³ãƒãƒ³ãƒ‰åç§°ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚  ```xml <Button Content=\"SampleTableç·¨é›†\"         FontSize=\"14\"         Margin=\"10\"         Padding=\"5\"         Command=\"{Binding SampleTableEditViewButton}\"/> ```  ## MainWindowViewModel.csï¼ˆç”»é¢é·ç§»å…ƒï¼‰ã€€ï½¥ï½¥ï½¥B  ### â‘¡ViewModelã«IDialogServiceã®å¤‰æ•°ã‚’è¿½åŠ   ç”»é¢é·ç§»å…ƒã®ViewModelã«ã€IDialogServiceã®ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå¤‰æ•°ã‚’è¿½åŠ ã—ã€ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã‚»ãƒƒãƒˆã—ã¾ã™ã€‚  ### â‘¢ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®å®Ÿè¡Œãƒ¡ã‚½ãƒƒãƒ‰ã‚’è¿½åŠ   ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹ãƒ‡ãƒªã‚²ãƒ¼ãƒˆã‚³ãƒãƒ³ãƒ‰ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹æ™‚ã®Excuteãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  ä¸Šè¨˜â‘¡ï½â‘¢ã®ã‚³ãƒ¼ãƒ‰ä¾‹ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚  ```cs //// ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ public MainWindowViewModel(IDialogService dialogService) {     //// ç”»é¢é·ç§»ç”¨ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰     _dialogService = dialogService;      SampleTableEditViewButton = new DelegateCommand(SampleTableEditViewButtonExecute); }  public DelegateCommand SampleTableEditViewButton { get; }  private void SampleTableEditViewButtonExecute() {     //// ç”»é¢é·ç§»å‡¦ç†ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰     _dialogService.ShowDialog(nameof(SampleTableEditView), null, null); } ```  ## SampleTableEditViewModel.cs(ç”»é¢é·ç§»å…ˆ)ã€€ï½¥ï½¥ï½¥Cã€€  ### â‘£IDialogAwareã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£… ç”»é¢é·ç§»å…ˆã®ViewModelã«ã€**IDialogAwareã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹** ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  ### â‘¤CanCloseDialogãƒ¡ã‚½ãƒƒãƒ‰ã‚’å¤‰æ›´ IDialogAwareã‚’å®Ÿè£…ã—ãŸäº‹ã§è¿½åŠ ã•ã‚Œã‚‹ CanCloseDialog() ãƒ¡ã‚½ãƒƒãƒ‰ã«ã€ retun true ã‚’è¨˜è¼‰ã—ã¾ã™ã€‚ trueã‚’è¿”ã™äº‹ã§ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‰ã˜ã‚‹äº‹ãŒå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚  â–¼ä¸Šè¨˜â‘£ï½â‘¤ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ ```cs public class SampleTableEditViewModel : BindableBase, IDialogAware {    //// å„ç¨®å‡¦ç†    public bool CanCloseDialog()   {       return true;    //// true:ç”»é¢ã‚’é–‰ã˜ã‚‹äº‹ãŒå¯èƒ½   } } ```  ## App.xaml.csã€€ï½¥ï½¥ï½¥D  ### â‘¥RegisterTypeså†…ã§Viewã‚’ç™»éŒ²  ```cs protected override void RegisterTypes(IContainerRegistry containerRegistry) {     //// ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”»é¢ï¼ˆåˆ¥ç”»é¢ã«è¡¨ç¤ºï¼‰ â€»ViewModelã«IDialogAwareå®Ÿè£…ãŒå¿…è¦     containerRegistry.RegisterDialog<SampleTableEditView, SampleTableEditViewModel>();  } ```  containerRegistry.RegisterDialogã«è¨­å®šã—ãŸViewãŒãƒ€ã‚¤ã‚¢ãƒ­ã‚°è¡¨ç¤ºå¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚ "
    },
    "_id": "blog/27-dialog-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/27-dialog-wpf-prism-cs.mdx",
      "sourceFileName": "27-dialog-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/27-dialog-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/27-dialog-wpf-prism-cs",
    "slugAsParams": "27-dialog-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism DataGrid Columnã®Visibilityã‚’ãƒã‚¤ãƒ³ãƒ‰",
    "description": "C# WPF Prism ã§ DataGrido ã‚«ãƒ©ãƒ ã® Visibility ã‚’ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹æ–¹æ³•",
    "date": "2023-02-27T00:00:00.000Z",
    "emoji": "ğŸ”©",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " C#ã® **WPF Prism** ã§DataGridoã‚«ãƒ©ãƒ ã®Visibilityã‚’ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚  ä¾‹ãˆã°ã€DataGridå†…ã®ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦ã‚³ãƒ³ãƒœãƒœãƒƒã‚¯ã‚¹ï¼ˆã®é¸æŠè‚¢ï¼‰ã‚’ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã•ã›ã‚‹å ´åˆã€RelativeSource FindAncestor ã‚’ç”¨ã„ãŸæ–¹æ³•ãŒè€ƒãˆã‚‰ã‚Œã¾ã™ã€‚   ã—ã‹ã—ã€**DataGridã®ã‚«ãƒ©ãƒ ã®Visibilityã«ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹å ´åˆã€RelativeSourceã‚’ç”¨ã„ãŸæ–¹æ³•ã¯ä½¿ãˆã¾ã›ã‚“**ã€‚  ãã®ãŸã‚ã€ViewModelã‚’å‚ç…§å¯èƒ½ã¨ã™ã‚‹ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¦å¯¾å¿œã—ã¾ã™ã€‚   ## å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼‰  ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸‹è¨˜ã® **Aï½C** ã§ã™ã€‚  ```text WPF/  |-Services/  |  |-BindingProxy.cs ï½¥ï½¥ï½¥A  |  |-Views/  |  |-SampleView.xaml ï½¥ï½¥ï½¥B    |  |-ViewModels/  |  |-SampleViewModel.cs ï½¥ï½¥ï½¥C   ```  ## BindingProxy.csã€€ï½¥ï½¥ï½¥A  é€šå¸¸ã€ItemsSourceã‚’ä½¿ã†ã¨ãƒã‚¤ãƒ³ãƒ‰ã—ã¦ã„ã‚‹ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®å„è¦ç´ ãŒDataContextã¨ãªã‚‹ãŸã‚ã€ DataGridå†…ã§ã¯ItemsSourceä»¥å¤–ã®ãƒã‚¤ãƒ³ãƒ‰ãŒå‡ºæ¥ãªããªã‚Šã¾ã™ã€‚  â€»DataContextï¼šBindingã®å¯¾è±¡  ãã“ã§ã€DataGridå†…ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ç›´æ¥ViewModelã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã¨ã™ã‚‹**ã€ŒBindingProxyã€**ã‚¯ãƒ©ã‚¹ã‚’æº–å‚™ã—ã¾ã™ã€‚  â–¼BindingProxy.cs  ```cs using System.Windows;  namespace Template2.WPF.Services {     /// <summary>     /// ViewModelã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚½ãƒ¼ã‚¹ã®ä»£ç†ã¨ã—ã¦åƒãã‚¯ãƒ©ã‚¹ã§ã™ã€‚     /// </summary>     public class BindingProxy : Freezable     {         /// <summary>         /// Freezableã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ç”Ÿæˆã—ã¾ã™ã€‚         /// </summary>         /// <returns></returns>         protected override Freezable CreateInstanceCore()         {             return new BindingProxy();         }          /// <summary>         /// é–“ã‚’ã¨ã‚Šã‚‚ã¤ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£         /// ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã—ãŸå ´åˆã¯ã€ã“ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãŒViewModelã®ä»£ã‚ã‚Šã«ãªã‚‹ã€‚         /// </summary>         public object Data         {             get { return (object)GetValue(DataProperty); }             set { SetValue(DataProperty, value); }         }          /// <summary>         /// Data ã®ä¾å­˜é–¢ä¿‚ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£å®šç¾©         /// </summary>         public static readonly DependencyProperty DataProperty =             DependencyProperty.Register(\"Data\", typeof(object), typeof(BindingProxy), new UIPropertyMetadata(null));     } } ```  ## SampleView.xaml ï½¥ï½¥ï½¥B    ### â‘ Viewã®xamlã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¯ãƒ©ã‚¹å‚ç…§ã‚’è¿½åŠ   Windowã‚‚ã—ãã¯UserControlè¦ç´ ã«ã€BindingProxyã‚¯ãƒ©ã‚¹ã®namespaceå‚ç…§ã‚’è¿½åŠ ã—ã¾ã™ã€‚  ä¾‹ï¼‰BindingProxy.cs ã® namespace ãŒã€Template2.WPF.Services ã®å ´åˆ   **`xmlns:services=\"clr-namespace:Template2.WPF.Services\"`**  â–¼SampleView.xaml ```xml <UserControl x:Class=\"Template2.WPF.Views.Sample002View\"              xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"              xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"              xmlns:prism=\"http://prismlibrary.com/\"                           prism:ViewModelLocator.AutoWireViewModel=\"True\"              xmlns:materialDesign=\"http://materialdesigninxaml.net/winfx/xaml/themes\"              xmlns:i=\"http://schemas.microsoft.com/xaml/behaviors\"              Background=\"{StaticResource backgroundColor}\"              xmlns:services=\"clr-namespace:Template2.WPF.Services\"              > ```  ### â‘¡DataGridã®ãƒªã‚½ãƒ¼ã‚¹ã«BindingProxyå‚ç…§ã‚’è¿½åŠ   ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¦DataGridå†…ã§BindingProxyã‚’åˆ©ç”¨å¯èƒ½ã¨ã—ã¾ã™ã€‚  ```xml <DataGrid.Resources>     <!--DataGridã®ItemSourceã¨ã¯åˆ¥ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’Bindã™ã‚‹ãŸã‚ã«å¿…è¦-->     <services:BindingProxy x:Key=\"Proxy\" Data=\"{Binding}\"/> </DataGrid.Resources> ```  ä¾‹ï¼‰DataGridã¸ã®çµ„è¾¼ã¿ä¾‹  â–¼SampleView.xaml ```xml <DataGrid Style=\"{StaticResource commonDataGrid}\"           ItemsSource=\"{Binding WorkerMstEntities}\"           SelectedItem=\"{Binding WorkerMstEntitiesSlectedItem}\"           VerticalAlignment=\"Top\"           HorizontalAlignment=\"Left\"           IsReadOnly=\"False\"           CanUserAddRows=\"False\"           Cursor=\"Hand\">                  <DataGrid.Resources>                     <!--DataGridã®ItemSourceã¨ã¯åˆ¥ã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’Bindã™ã‚‹ãŸã‚ã«å¿…è¦-->                     <services:BindingProxy x:Key=\"Proxy\" Data=\"{Binding}\"/>                 </DataGrid.Resources>                  ï¼ˆçœç•¥ï¼‰ ```  ### â‘¢DataGridã‚«ãƒ©ãƒ ã®Visibilityã‚’ãƒã‚¤ãƒ³ãƒ‰  DataGridã®Columnè¦ç´ ã«ã€Visibilityã‚’è¿½åŠ ã—ã¾ã™ã€‚  **ãƒã‚¤ãƒ³ãƒˆ** - Binding:Data.XXX ã‚’è¨˜è¼‰ã™ã‚‹ã“ã¨ - Source:StaticResourceã‚’è¨˜è¼‰ã™ã‚‹ã“ã¨  â–¼SampleView.xaml ```xml <DataGrid.Columns>     <!-- ã‚«ãƒ©ãƒ ã®Visibilityã¯ã€BindingProxyã‚¯ãƒ©ã‚¹ã‚’åˆ©ç”¨ã—ã¦ViewModelã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å‚ç…§ã™ã‚‹å¿…è¦æœ‰ã‚Š -->     <materialDesign:DataGridTextColumn Header=\"ä½œæ¥­è€…åç§°\"            Binding=\"{Binding WorkerName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}\"            Visibility=\"{Binding Data.WorkerNameVisibility, Source={StaticResource Proxy}}\">      ï¼ˆçœç•¥ï¼‰ ```  ## SampleViewModel.cs ï½¥ï½¥ï½¥C      ### â‘£ViewModelã«Visibilityãƒã‚¤ãƒ³ãƒ‰ç”¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’æº–å‚™  é€šå¸¸ã®WPF Prismã§ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹æ–¹æ³•ã¨åŒæ§˜ã«ã€Visibilityã‚’ãƒã‚¤ãƒ³ãƒ‰ã—ãŸåç§°ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¨ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆå¤‰æ•°ã‚’è¿½åŠ ã—ã¾ã™ã€‚  â–¼SampleViewModel.cs ```cs private Visibility _workerNameVisibility = Visibility.Visible; public Visibility WorkerNameVisibility {     get { return _workerNameVisibility; }     set { SetProperty(ref _workerNameVisibility, value); } } ```  ä»¥ä¸Šã§ã™ã€‚ "
    },
    "_id": "blog/28-bind-datagrid-column-visibility-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/28-bind-datagrid-column-visibility-wpf-prism-cs.mdx",
      "sourceFileName": "28-bind-datagrid-column-visibility-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/28-bind-datagrid-column-visibility-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/28-bind-datagrid-column-visibility-wpf-prism-cs",
    "slugAsParams": "28-bind-datagrid-column-visibility-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism DataGrid ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³æ›¿ãˆ",
    "description": "C# WPF ã§ã€ DataGrid ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³æ›¿ãˆã‚‹å‡¦ç†",
    "date": "2023-03-02T00:00:00.000Z",
    "emoji": "ğŸ¥„",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " C#ã® **WPF** ã§ã€DataGridã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³æ›¿ãˆã‚‹å‡¦ç†ã‚’èª¬æ˜ã—ã¾ã™ã€‚  ![image](/blog/29/1.gif)  ## å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆä¾‹ï¼‰  ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒå¿…è¦ãªãƒ•ã‚¡ã‚¤ãƒ«ã¯ä¸‹è¨˜ã® **Aï½B** ã§ã™ã€‚  ```text Services/  |-BindingDragDropRowBehavior.cs ï½¥ï½¥ï½¥A  Views/  |-SampleView.xaml ï½¥ï½¥ï½¥B ```  ## BindingDragDropRowBehavior.cs ï½¥ï½¥ï½¥A  ### â‘ DataGripã®è¡Œã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ãƒ“ãƒ˜ã‚¤ãƒ“ã‚¢ã‚’æº–å‚™  DataGripã®è¡Œã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ãƒ“ãƒ˜ã‚¤ãƒ“ã‚¢ã‚’æº–å‚™ã—ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚   namespaece ã¯ã€é©å®œå¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  â–¼BindingDragDropRowBehavior.cs ```cs using System; using System.Windows; using System.Windows.Controls; using System.Windows.Controls.Primitives; using System.Windows.Input; using System.Collections; using System.Windows.Data; using System.Windows.Media;  namespace Template2.WPF.Services {     /// <summary>     /// DataGridã®è¡Œã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³å¤‰ãˆã‚‹ãƒ“ãƒ˜ã‚¤ãƒ“ã‚¢     /// è¤‡é›‘ãªDataGridæ§‹é€ ã«ã¯å¯¾å¿œã—ã¦ã„ãªã„ãŸã‚æ³¨æ„     ///     /// ã€€åˆ©ç”¨å¯èƒ½ãªDataGridã®ä¾‹     /// ã€€ãƒ»è‡ªå‹•åˆ—ç”Ÿæˆã®ã¿     /// ã€€ãƒ»DataGridTextColumnã®ã¿     /// </summary>     public static class BindingDragDropRowBehavior     {         private static DataGrid dataGrid;          private static Popup popup;          private static bool enable;          private static object draggedItem;          public static object DraggedItem         {             get { return BindingDragDropRowBehavior.draggedItem; }             set { BindingDragDropRowBehavior.draggedItem = value; }         }          public static Popup GetPopupControl(DependencyObject obj)         {             return (Popup)obj.GetValue(PopupControlProperty);         }          public static void SetPopupControl(DependencyObject obj, Popup value)         {             obj.SetValue(PopupControlProperty, value);         }          // Using a DependencyProperty as the backing store for PopupControl.  This enables animation, styling, binding, etc...         public static readonly DependencyProperty PopupControlProperty =             DependencyProperty.RegisterAttached(\"PopupControl\", typeof(Popup), typeof(BindingDragDropRowBehavior), new UIPropertyMetadata(null, OnPopupControlChanged));          private static void OnPopupControlChanged(DependencyObject depObject, DependencyPropertyChangedEventArgs e)         {             if (e.NewValue == null || !(e.NewValue is Popup))             {                 throw new ArgumentException(\"Popup Control should be set\", \"PopupControl\");             }             popup = e.NewValue as Popup;              dataGrid = depObject as DataGrid;             // Check if DataGrid             if (dataGrid == null)                 return;               if (enable && popup != null)             {                 dataGrid.BeginningEdit += new EventHandler<DataGridBeginningEditEventArgs>(OnBeginEdit);                 dataGrid.CellEditEnding += new EventHandler<DataGridCellEditEndingEventArgs>(OnEndEdit);                 dataGrid.MouseLeftButtonUp += new System.Windows.Input.MouseButtonEventHandler(OnMouseLeftButtonUp);                 dataGrid.PreviewMouseLeftButtonDown += new MouseButtonEventHandler(OnMouseLeftButtonDown);                 dataGrid.MouseMove += new MouseEventHandler(OnMouseMove);             }             else             {                 dataGrid.BeginningEdit -= new EventHandler<DataGridBeginningEditEventArgs>(OnBeginEdit);                 dataGrid.CellEditEnding -= new EventHandler<DataGridCellEditEndingEventArgs>(OnEndEdit);                 dataGrid.MouseLeftButtonUp -= new System.Windows.Input.MouseButtonEventHandler(OnMouseLeftButtonUp);                 dataGrid.MouseLeftButtonDown -= new MouseButtonEventHandler(OnMouseLeftButtonDown);                 dataGrid.MouseMove -= new MouseEventHandler(OnMouseMove);                  dataGrid = null;                 popup = null;                 draggedItem = null;                 IsEditing = false;                 IsDragging = false;             }         }          public static bool GetEnabled(DependencyObject obj)         {             return (bool)obj.GetValue(EnabledProperty);         }          public static void SetEnabled(DependencyObject obj, bool value)         {             obj.SetValue(EnabledProperty, value);         }          // Using a DependencyProperty as the backing store for Enabled.  This enables animation, styling, binding, etc...         public static readonly DependencyProperty EnabledProperty =             DependencyProperty.RegisterAttached(\"Enabled\", typeof(bool), typeof(BindingDragDropRowBehavior), new UIPropertyMetadata(false, OnEnabledChanged));          private static void OnEnabledChanged(DependencyObject depObject, DependencyPropertyChangedEventArgs e)         {             //Check if value is a Boolean Type             if (e.NewValue is bool == false)                 throw new ArgumentException(\"Value should be of bool type\", \"Enabled\");              enable = (bool)e.NewValue;          }          public static bool IsEditing { get; set; }          public static bool IsDragging { get; set; }          private static void OnBeginEdit(object sender, DataGridBeginningEditEventArgs e)         {             IsEditing = true;             //in case we are in the middle of a drag/drop operation, cancel it...             if (IsDragging) ResetDragDrop();         }          private static void OnEndEdit(object sender, DataGridCellEditEndingEventArgs e)         {             IsEditing = false;         }           /// <summary>         /// Initiates a drag action if the grid is not in edit mode.         /// </summary>         private static void OnMouseLeftButtonDown(object sender, MouseButtonEventArgs e)         {             if (IsEditing) return;              var row = UIHelpers.TryFindFromPoint<DataGridRow>((UIElement)sender, e.GetPosition(dataGrid));             if (row == null || row.IsEditing) return;              //set flag that indicates we're capturing mouse movements             IsDragging = true;             DraggedItem = row.Item;         }          /// <summary>         /// Completes a drag/drop operation.         /// </summary>         private static void OnMouseLeftButtonUp(object sender, MouseButtonEventArgs e)         {             if (!IsDragging || IsEditing)             {                 return;             }              //get the target item             var targetItem = dataGrid.SelectedItem;              if (targetItem == null || !ReferenceEquals(DraggedItem, targetItem))             {                 //get target index                 var targetIndex = ((dataGrid).ItemsSource as IList).IndexOf(targetItem);                  //remove the source from the list                 ((dataGrid).ItemsSource as IList).Remove(DraggedItem);                  //move source at the target's location                 ((dataGrid).ItemsSource as IList).Insert(targetIndex, DraggedItem);                  //select the dropped item                 dataGrid.SelectedItem = DraggedItem;             }              //reset             ResetDragDrop();         }          /// <summary>         /// Closes the popup and resets the         /// grid to read-enabled mode.         /// </summary>         private static void ResetDragDrop()         {             IsDragging = false;             popup.IsOpen = false;             dataGrid.IsReadOnly = false;         }          /// <summary>         /// Updates the popup's position in case of a drag/drop operation.         /// </summary>         private static void OnMouseMove(object sender, MouseEventArgs e)         {             if (!IsDragging || e.LeftButton != MouseButtonState.Pressed) return;              popup.DataContext = DraggedItem;             //display the popup if it hasn't been opened yet             if (!popup.IsOpen)             {                 //switch to read-only mode                 dataGrid.IsReadOnly = true;                  //make sure the popup is visible                 popup.IsOpen = true;             }               Size popupSize = new Size(popup.ActualWidth, popup.ActualHeight);             popup.PlacementRectangle = new Rect(e.GetPosition(dataGrid), popupSize);              //make sure the row under the grid is being selected             Point position = e.GetPosition(dataGrid);             var row = UIHelpers.TryFindFromPoint<DataGridRow>(dataGrid, position);             if (row != null) dataGrid.SelectedItem = row.Item;         }     }     public static class UIHelpers     {          #region find parent          /// <summary>         /// Finds a parent of a given item on the visual tree.         /// </summary>         /// <typeparam name=\"T\">The type of the queried item.</typeparam>         /// <param name=\"child\">A direct or indirect child of the         /// queried item.</param>         /// <returns>The first parent item that matches the submitted         /// type parameter. If not matching item can be found, a null         /// reference is being returned.</returns>         public static T TryFindParent<T>(DependencyObject child)           where T : DependencyObject         {             //get parent item             DependencyObject parentObject = GetParentObject(child);              //we've reached the end of the tree             if (parentObject == null) return null;              //check if the parent matches the type we're looking for             T parent = parentObject as T;             if (parent != null)             {                 return parent;             }             else             {                 //use recursion to proceed with next level                 return TryFindParent<T>(parentObject);             }         }           /// <summary>         /// This method is an alternative to WPF's         /// <see cref=\"VisualTreeHelper.GetParent\"/> method, which also         /// supports content elements. Do note, that for content element,         /// this method falls back to the logical tree of the element.         /// </summary>         /// <param name=\"child\">The item to be processed.</param>         /// <returns>The submitted item's parent, if available. Otherwise         /// null.</returns>         public static DependencyObject GetParentObject(DependencyObject child)         {             if (child == null) return null;             ContentElement contentElement = child as ContentElement;              if (contentElement != null)             {                 DependencyObject parent = ContentOperations.GetParent(contentElement);                 if (parent != null) return parent;                  FrameworkContentElement fce = contentElement as FrameworkContentElement;                 return fce != null ? fce.Parent : null;             }              //if it's not a ContentElement, rely on VisualTreeHelper             return VisualTreeHelper.GetParent(child);         }          #endregion           #region update binding sources          /// <summary>         /// Recursively processes a given dependency object and all its         /// children, and updates sources of all objects that use a         /// binding expression on a given property.         /// </summary>         /// <param name=\"obj\">The dependency object that marks a starting         /// point. This could be a dialog window or a panel control that         /// hosts bound controls.</param>         /// <param name=\"properties\">The properties to be updated if         /// <paramref name=\"obj\"/> or one of its childs provide it along         /// with a binding expression.</param>         public static void UpdateBindingSources(DependencyObject obj,                                   params DependencyProperty[] properties)         {             foreach (DependencyProperty depProperty in properties)             {                 //check whether the submitted object provides a bound property                 //that matches the property parameters                 BindingExpression be = BindingOperations.GetBindingExpression(obj, depProperty);                 if (be != null) be.UpdateSource();             }              int count = VisualTreeHelper.GetChildrenCount(obj);             for (int i = 0; i < count; i++)             {                 //process child items recursively                 DependencyObject childObject = VisualTreeHelper.GetChild(obj, i);                 UpdateBindingSources(childObject, properties);             }         }          #endregion           /// <summary>         /// Tries to locate a given item within the visual tree,         /// starting with the dependency object at a given position.          /// </summary>         /// <typeparam name=\"T\">The type of the element to be found         /// on the visual tree of the element at the given location.</typeparam>         /// <param name=\"reference\">The main element which is used to perform         /// hit testing.</param>         /// <param name=\"point\">The position to be evaluated on the origin.</param>         public static T TryFindFromPoint<T>(UIElement reference, Point point)           where T : DependencyObject         {             DependencyObject element = reference.InputHitTest(point)                                          as DependencyObject;             if (element == null) return null;             else if (element is T) return (T)element;             else return TryFindParent<T>(element);         }     } } ```  ## SampleView.xaml ï½¥ï½¥ï½¥B  ### â‘¡Viewã«ã€BindingDragDropRowBehaviorã®å‚ç…§ã‚’è¿½åŠ   ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ä¸¦ã³æ›¿ãˆã‚’ã—ãŸã„DataGridã«ã€ BindingDragDropBehavior ã‚’è¨­å®šã—ã¾ã™ã€‚  ãã®ãŸã‚ã«ã€ã¾ãšã¯Viewï¼ˆxamlï¼‰ã‹ã‚‰ BindingDragDropRowBehaviorï¼ˆæ­£å¼ã«ã¯namespaceï¼‰ã‚’å‚ç…§å¯èƒ½ã¨ã™ã‚‹è¨­å®šã‚’è¿½åŠ ã—ã¾ã™ã€‚  **`xmlns:services=\"clr-namespace:Template2.WPF.Services\"`**  â–¼SampleView.xamlï¼ˆSampleViewãŒUserControlã®å ´åˆï¼‰ ```xml <UserControl x:Class=\"Template2.WPF.Views.SampleView\"              xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"              xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"              xmlns:prism=\"http://prismlibrary.com/\"                           prism:ViewModelLocator.AutoWireViewModel=\"True\"              xmlns:services=\"clr-namespace:Template2.WPF.Services\">     ï½¥ï½¥ï½¥ ```  ã“ã‚Œã§ã€SampleViewã§ã¯ã€servicesã«æ ¼ç´ã•ã‚ŒãŸã‚¯ãƒ©ã‚¹ï¼ˆBindingDragDropBehaviorï¼‰ãŒåˆ©ç”¨å¯èƒ½ã¨ãªã‚Šã¾ã™ã€‚  ### â‘¢DataGridã«ã€ BindingDragDropRowBehavior ã®è¨­å®šã‚’è¿½åŠ  æ¬¡ã«ã€DataGridã«ä¸‹è¨˜ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚ `services:BindingDragDropRowBehavior`ã¯ã€ä¸Šè¨˜â‘¡ãŒè¨­å®šæ¸ˆã¿ã§ã‚ã‚Œã°å‚ç…§å¯èƒ½ã§ã™ã€‚  DataGdidã«ä¸‹è¨˜ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¿½åŠ ã—ã¾ã™ã€‚ ```xml x:Name=\"WorkerGroupMstEntitiesName\" SelectionMode=\"Single\" services:BindingDragDropRowBehavior.Enabled=\"True\" services:BindingDragDropRowBehavior.PopupControl=\"{Binding ElementName=DraggingPopup}\" AllowDrop=\"True\" ```  å®Ÿéš›ã®å®Ÿè£…ä¾‹ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚  â–¼SampleView.xamlï¼ˆDataGridã¸ã®å®Ÿè£…ä¾‹ï¼‰ ```xml <DataGrid Style=\"{StaticResource commonDataGrid}\"             ItemsSource=\"{Binding WorkerGroupMstEntities}\"             Cursor=\"Hand\"             Margin=\"5\"                          x:Name=\"WorkerGroupMstEntitiesName\"             SelectionMode=\"Single\"             services:BindingDragDropRowBehavior.Enabled=\"True\"             services:BindingDragDropRowBehavior.PopupControl=\"{Binding ElementName=DraggingPopup}\"             AllowDrop=\"True\"> ```  ä¸Šè¨˜ã‚³ãƒ¼ãƒ‰ã®`services:BindingDragDropRowBehavior.PopupControl=\"{Binding ElementName=DraggingPopup}`ã¯ã€å¾Œè¿°ã™ã‚‹ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºã«å¿…è¦ã¨ãªã‚Šã¾ã™ã€‚  ### â‘£DataGridãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—æ™‚ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤ºè¨­å®šã‚’è¿½åŠ   ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ã¯ã€ãƒ‰ãƒ©ãƒƒã‚°ä¸­ã«ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã§ã™ã€‚   é¸æŠã€ã¤ã¾ã‚Šãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ã„ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒåˆ†ã‹ã‚Šæ˜“ããªã‚Šã¾ã™ã€‚    å®Ÿè£…ã§ã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã« **Popup** ã‚’ **DataGrid ã®å¤–å´** ã«é…ç½®ã—ã¾ã™ã€‚  â–¼SampleView.xaml ```xml <!-- DataGridã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã—ãŸéš›ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—è¡¨ç¤º --> <Popup  x:Name=\"DraggingPopup\"         AllowsTransparency=\"True\"         IsHitTestVisible=\"False\"         Placement=\"RelativePoint\"         PlacementTarget=\"{Binding ElementName=WorkerGroupMstEntitiesName}\">     <!--  Popup construction Use properties of DraggedObject inside for Binding  -->     <TextBlock Text=\"{Binding Path=WorkerGroupName}\"/> </Popup>  <DataGrid Style=\"{StaticResource commonDataGrid}\"             ItemsSource=\"{Binding WorkerGroupMstEntities}\"             Cursor=\"Hand\"             Margin=\"5\"                          x:Name=\"WorkerGroupMstEntitiesName\"             SelectionMode=\"Single\"             services:BindingDragDropRowBehavior.Enabled=\"True\"             services:BindingDragDropRowBehavior.PopupControl=\"{Binding ElementName=DraggingPopup}\"             AllowDrop=\"True\">      <DataGrid.Columns>         <DataGridTextColumn Header=\"ä½œæ¥­è€…ã‚°ãƒ«ãƒ¼ãƒ—ã‚³ãƒ¼ãƒ‰\"                             Binding=\"{Binding WorkerGroupCode}\"                             IsReadOnly=\"True\">         </DataGridTextColumn>         <DataGridTextColumn Header=\"ä½œæ¥­è€…ã‚°ãƒ«ãƒ¼ãƒ—åç§°\"                             Binding=\"{Binding WorkerGroupName}\"                             MinWidth=\"400\"                             IsReadOnly=\"True\">         </DataGridTextColumn>     </DataGrid.Columns>  </DataGrid> ```  Popup ã®`Name`ã¯ã€DataGrid ã®`PopupControl`ã§è¨­å®šã—ãŸåç§°ã§ã™ã€‚  â–¼`<Popup>`ã®ä¸­   ```xml x:Name=\"**DraggingPopup**\"   ```  ãŒã€    â–¼`<DataGdid>`ã®ä¸­   ```xml services:BindingDragDropRowBehavior.PopupControl=\"{Binding ElementName=**DraggingPopup**}\"   ```  ã«å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚    ã¾ãŸã€ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«Popupè¡¨ç¤ºã•ã›ã‚‹ãƒ†ã‚­ã‚¹ãƒˆã¯ã€ä¸‹è¨˜ã®éƒ¨åˆ†ã§è¨­å®šã—ã¦ã„ã¾ã™ã€‚  â–¼`<Popup>`ã®ä¸­   ```xml <TextBlock Text=\"{Binding Path=WorkerGroupName}\"/>   ```  ä¸Šè¨˜ã® **Popup ãƒ†ã‚­ã‚¹ãƒˆãƒ–ãƒ­ãƒƒã‚¯ã® Binding Path ã§è¨­å®šã—ãŸãƒ—ãƒ­ãƒ‘ãƒ†ã‚£**ï¼ˆä¸Šè¨˜ã®å ´åˆã€WorkerGroupNameï¼‰ãŒ**ãƒ‰ãƒ©ãƒƒã‚°æ™‚ã«è¡¨ç¤º**ã•ã‚Œã¾ã™ã€‚  ä»¥ä¸Šã§ã™ã€‚"
    },
    "_id": "blog/29-datagrid-drag-and-drop-to-sort-wpf-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/29-datagrid-drag-and-drop-to-sort-wpf-cs.mdx",
      "sourceFileName": "29-datagrid-drag-and-drop-to-sort-wpf-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/29-datagrid-drag-and-drop-to-sort-wpf-cs"
    },
    "type": "Post",
    "slug": "/blog/29-datagrid-drag-and-drop-to-sort-wpf-cs",
    "slugAsParams": "29-datagrid-drag-and-drop-to-sort-wpf-cs"
  },
  {
    "title": "VBS | Retrieving Data from an ini File",
    "description": "This guide explains how to retrieve data stored in a Config.ini file.",
    "date": "2020-02-25T00:00:00.000Z",
    "emoji": "ğŸ”§",
    "tags": ["vbs"],
    "published": true,
    "body": {
      "raw": " This guide explains how to retrieve data stored in a Config.ini file.  ## Folder Structure Retrieve data contained within the Config.ini as shown in the structure below:  ``` textfile Any Folder  â”œ Config.ini  â”” GetIniData.vbs ```  ## Sample Source  Config.ini:  ``` ini [test1] data1=00000 data2=11111 [test2] data3=abcde data4=fghij ```  GetIniData.vbs:  ``` vb Option Explicit  Msgbox GetIniData(GetCurrentDirectory() & \"\\Config.ini\", \"test1\", \"data1\")  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief: Get the current directory. ' note:  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Function GetCurrentDirectory()      Dim objWshShell     ' WshShell object      Set objWshShell = WScript.CreateObject(\"WScript.Shell\")     If Err.Number <> 0 Then         WScript.Echo \"Error: \" & Err.Description         wscript.quit(1)     End If     GetCurrentDirectory = objWshShell.CurrentDirectory  End Function  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief: Retrieve data from an INI file using section name and parameter name. ' note : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Function GetIniData(strIniFileName, strSection, strKey)      Dim objFSO, objIniFile, objSectionDic, strReadLine, objKeyDic, arrReadLine     Dim strTempSection, objTempdic      ' File I/O constants     Const conForReading = 1, conForWriting = 2, conForAppending = 8     Set objFSO = CreateObject(\"Scripting.FileSystemObject\")      ' Open the file     Set objIniFile = objFSO.OpenTextFile(strIniFileName, conForReading, False)     If Err.Number <> 0 Then         ' Output an error message         wscript.echo \"INI File Name: \" & strIniFileName         wscript.quit(1)     End If      ' Create a storage Dictionary object     Set objSectionDic = CreateObject(\"Scripting.Dictionary\")      ' Read from the file     strReadLine = objIniFile.ReadLine     Do While objIniFile.AtEndofStream = False         ' Search for the start of a statement         If (strReadLine <> \" \") And (StrComp(\"[]\", (Left(strReadLine, 1) & Right(strReadLine, 1))) = 0) Then             ' Retrieve the section name             strTempSection = Mid(strReadLine, 2, (Len(strReadLine) - 2))             ' Create a Dictionary object for keys             Set objKeyDic = CreateObject(\"Scripting.Dictionary\")             ' Loop until the end of the file             Do While objIniFile.AtEndofStream = False                 strReadLine = objIniFile.ReadLine                 If (strReadLine <> \"\") And (StrComp(\";\", Left(strReadLine, 1)) <> 0) Then                     ' Exit loop when the next statement starts                     If StrComp(\"[]\", (Left(strReadLine, 1) & Right(strReadLine, 1))) = 0 Then                         Exit Do                     End If                     ' Store definitions within a section in the Dictionary object                     arrReadLine = Split(strReadLine, \"=\", 2, vbTextCompare)                     objKeyDic.Add UCase(arrReadLine(0)), arrReadLine(1)                 End If             Loop             ' Store in the object             objSectionDic.Add UCase(strTempSection), objKeyDic         Else             strReadLine = objIniFile.ReadLine         End If     Loop     ' Close the file     objIniFile.Close      ' Retrieve data corresponding to the specified section and parameter from the INI array     strSection = UCase(strSection)  ' Convert to uppercase     strKey = UCase(strKey)          ' Convert to uppercase      If objSectionDic.Exists(strSection) Then         Set objTempdic = objSectionDic.Item(strSection)         If objTempdic.Exists(strKey) Then             GetIniData = objSectionDic(strSection)(strKey)             Exit Function         End If     End If     GetIniData = \"\"  End Function ```  ## Explanation  When extracting data from an INI file, each data from the `Settings.ini` is stored in a dictionary object. Then, you retrieve the data based on the section (e.g., `[test1]`) and parameter name (e.g., `data1`).  In the provided sample, the code is set to read an INI file from the current directory. If you want to reference a different folder, you can modify the code to specify the path of the INI file."
    },
    "_id": "blog/3-get-ini-data-vbs.mdx",
    "_raw": {
      "sourceFilePath": "blog/3-get-ini-data-vbs.mdx",
      "sourceFileName": "3-get-ini-data-vbs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/3-get-ini-data-vbs"
    },
    "type": "Post",
    "slug": "/blog/3-get-ini-data-vbs",
    "slugAsParams": "3-get-ini-data-vbs"
  },
  {
    "title": "Hexo | ãƒãƒ†ãƒªã‚¢ãƒ«ï¼ˆmaterialï¼‰ãƒ†ãƒ¼ãƒã®é©ç”¨ãƒ»è¨­å®šæ–¹æ³•",
    "description": "Hexo ã« ãƒãƒ†ãƒªã‚¢ãƒ«ãƒ†ãƒ¼ãƒã‚’é©ç”¨ã™ã‚‹æ–¹æ³•",
    "date": "2023-03-04T00:00:00.000Z",
    "emoji": "ğŸŒ¸",
    "tags": ["hexo"],
    "published": true,
    "body": {
      "raw": " ãƒ–ãƒ­ã‚°ã‚’Wordpressã‹ã‚‰Hexoã«å¤‰æ›´ã—ã€material ãƒ†ãƒ¼ãƒã‚’é©ç”¨ã—ã¾ã—ãŸã€‚   material ãƒ†ãƒ¼ãƒã¯ã€GogleãŒæ¨å¥¨ã—ã¦ã„ã‚‹ãƒãƒ†ãƒªã‚¢ãƒ«ãƒ‡ã‚¶ã‚¤ãƒ³ã‚’ãƒ™ãƒ¼ã‚¹ã¨ã—ãŸç¾ã—ã„ãƒ‡ã‚¶ã‚¤ãƒ³ã§ã™ã€‚    Hexoã¯ãƒ†ãƒ¼ãƒã‚’Githubã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦å®Ÿè£…ã—ã¾ã™ãŒã€material ãƒ†ãƒ¼ãƒã«ã¯ãƒã‚°ãŒæ®‹ã£ã¦ãŠã‚Šã€ãã®ã¾ã¾åˆ©ç”¨ã™ã‚‹äº‹ãŒå‡ºæ¥ã¾ã›ã‚“ã§ã—ãŸã€‚  ä»Šå›ã€material ãƒ†ãƒ¼ãƒé©ç”¨ã«å¿…è¦ãªä¿®æ­£ç‰ˆã®ãƒ†ãƒ¼ãƒãƒ•ã‚¡ã‚¤ãƒ«æä¾›ã¨è¨­å®šæ‰‹é †ã‚’è¨˜è¼‰ã—ã¦ãŠãã¾ã™ã€‚  ![image](/blog/30/1.png)  ## å‰æ - OS:Windows  ## Hexoç’°å¢ƒæ§‹ç¯‰  ### Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  Hexoã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã® **npmã‚³ãƒãƒ³ãƒ‰** ã‚’ä½¿ãˆã‚‹ã‚ˆã†ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚   ãã®ãŸã‚ã«ã€ã¾ãšã¯Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚    ä¸‹è¨˜ãƒªãƒ³ã‚¯å…ˆã‹ã‚‰ **Node.jsã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰** ã—ã¦ä¸‹ã•ã„ã€‚    https://nodejs.org/ja/    æ¬¡ã«ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ**Windows Installer(.msi)ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**ã—ã¾ã™ã€‚    ### Hexoã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ ```cmd npm install hexo-cli -g ```  ã“ã‚Œã§ã€**Hexoã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†**ã§ã™ã€‚  ### Hexoã®ç’°å¢ƒæ§‹ç¯‰  Hexoç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼ˆãƒ•ã‚©ãƒ«ãƒ€ï¼‰ã‚’æº–å‚™ã—ã¾ã™ã€‚   ä¾‹ã¨ã—ã¦`ã€ŒC:\\hexo-blogã€`ã‚’Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¨ã—ã¾ã™ã€‚    ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§`init`ã‚’å®Ÿè¡Œã—ã€ã‚µã‚¤ãƒˆç”¨ã®ãƒ•ã‚©ãƒ«ãƒ€ã‚’ç”Ÿæˆã—ã¾ã™ã€‚ ```cmd npx hexo init Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª  ä¾‹ï¼‰ npx hexo init C:\\hexo-blog ```  `cd Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª`ã§ç§»å‹•ã—ã€  ```cmd npm install ```  Hexoãƒ–ãƒ­ã‚°ç”¨ã®å„ç¨®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒç”Ÿæˆã•ã‚Œã¦ã„ã‚Œã°å®Œäº†ã§ã™ã€‚  ## material ãƒ†ãƒ¼ãƒç’°å¢ƒæ§‹ç¯‰  ### material ãƒ†ãƒ¼ãƒã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰  [ã‚ªãƒªã‚¸ãƒŠãƒ«](https://github.com/iblh/hexo-theme-material)ã¯ãƒã‚°ãŒæ®‹ã£ã¦ã„ã¾ã™ã®ã§ã€ä¿®æ­£ç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä¸‹ã•ã„ã€‚  â†“ä¿®æ­£ç‰ˆ   [https://github.com/atman-33/hexo-theme-material](https://github.com/atman-33/hexo-theme-material)    Code > Download ZIP ã§zipãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚   ![image](/blog/30/2.png)  ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãŒå®Œäº†ã™ã‚Œã°ã€zipã‚’è§£å‡ã—ã€ä¸­èº«ã‚’Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªç›´ä¸‹ã®**themes/materialãƒ•ã‚©ãƒ«ãƒ€**ã«æ ¼ç´ã—ã¾ã™ã€‚  ```text Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\ |-themes\\    |-material\\       â†‘ã“ã®ä¸­ã«zipãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸­èº«ãŒä¿å­˜ã•ã‚Œã¦ã„ã‚Œã°OK  ```  ![image](/blog/30/3.png)  ### material ãƒ†ãƒ¼ãƒã‚’è¨­å®š  æ¬¡ã«ã€material ãƒ†ãƒ¼ãƒ ã‚’èª­ã¿è¾¼ã‚€ã‚ˆã†ã«ä¿®æ­£ã—ã¾ã™ã€‚   Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã®ã€Œ_config.ymlã€ã‚’ ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ ã§é–‹ãã€theme ã‚’ material ã«å¤‰æ›´ã—ã¾ã™ã€‚    â–¼Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª/_config.yml   ![image](/blog/30/4.png)  ã“ã®æ™‚ç‚¹ã§Hexoãƒ–ãƒ­ã‚°ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã‚µãƒ¼ãƒãƒ¼ã§ç¢ºèªå¯èƒ½ã§ã™ã€‚   ç¢ºèªã™ã‚‹ã«ã¯ã€ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚    ```cmd cd Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª hexo server -g ```  ãƒ–ãƒ©ã‚¦ã‚¶ã§URLã«`ã€Œhttp://localhost:4000ã€`ã‚’å…¥åŠ›ã™ã‚Œã°ã€Hexoãƒ–ãƒ­ã‚°ã‚’ç¢ºèªã§ãã¾ã™ã€‚  ## Hexo/material ã® config è¨­å®š  Hexo åŠã³ material ãƒ†ãƒ¼ãƒã¯åˆæœŸè¨­å®šã®ã¾ã¾ã§ã¯æ‰±ã„è¾›ã„ãŸã‚ã€è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚  Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªå†…ã«ã¯ã€2ã¤ã®_config.ymlãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ã¾ã™ã€‚   èª¬æ˜æ™‚ã«ã©ã¡ã‚‰ã®_config.ymlã‚’ç¤ºã—ã¦ã„ã‚‹ã®ã‹æ˜ç¢ºã«ã™ã‚‹ãŸã‚ã€ã“ã“ã‹ã‚‰ã¯ä»¥ä¸‹ã®åç§°ã§è¨˜è¼‰ã™ã‚‹äº‹ã¨ã—ã¾ã™ã€‚   - â‘ ãƒ«ãƒ¼ãƒˆ_config.yml - â‘¡ãƒ†ãƒ¼ãƒ_config.yml  ```text Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\ |-_config.mlãƒ»ãƒ»ãƒ»â‘ ãƒ«ãƒ¼ãƒˆ_config.yml |-themes\\    |-material       |-_config.ymlãƒ»ãƒ»ãƒ»â‘¡ãƒ†ãƒ¼ãƒ_config.yml ```  ### è¨€èªè¨­å®š  Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‹ã‚‰ã€ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿ã§ ãƒ«ãƒ¼ãƒˆ_config.yml ãƒ•ã‚¡ã‚¤ãƒ«ã® language ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’è¨­å®šã—ã¾ã™ã€‚  â–¼ãƒ«ãƒ¼ãƒˆ_config.yml   ![image](/blog/30/5.png)  language ã‚’ ja ã«ã—ã¦ã€æ—¥æœ¬èªã«ã—ã¾ã™ã€‚  ### è¨˜äº‹ã«å¯¾å¿œã—ãŸç”»åƒä¿å­˜ç”¨ãƒ•ã‚©ãƒ«ãƒ€  ãƒ«ãƒ¼ãƒˆ_config.yml ã® post_asset_folder ã®å€¤ã‚’å¤‰æ›´ã—ã¦ãŠãã¾ã™ã€‚  `post_asset_folder: `**`true`**  post_asset_folder ã®å€¤ã‚’ true ã«ã™ã‚‹ã¨ã€_postãƒ•ã‚©ãƒ«ãƒ€ç›´ä¸‹ã«æ–°è¦è¨˜äº‹ä½œæˆæ™‚ã«è¨˜äº‹ã«å¯¾å¿œã—ãŸãƒ•ã‚©ãƒ«ãƒ€ãŒè‡ªå‹•çš„ã«ç”Ÿæˆã•ã‚Œã¾ã™ã€‚   è¨˜äº‹ã§ä½¿ç”¨ã™ã‚‹ç”»åƒã‚’ã€ãã®ãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ã¦ãŠã‘ã°ã€è¨˜äº‹ä¸­ã«å‚ç…§ã™ã‚‹äº‹ãŒå¯èƒ½ã§ã™ã€‚    â–¼è¨˜äº‹å†…ã§assetãƒ•ã‚©ãƒ«ãƒ€ã®ç”»åƒã‚’èª­ã¿è¾¼ã‚€å ´åˆã®è¨˜è¿°   ```yml {% asset_img ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«å.jpg %} ```  ### ãƒ–ãƒ­ã‚°ã®ã‚¢ã‚¤ã‚³ãƒ³ãƒ»ç”»åƒ  ã“ã“ã‹ã‚‰ã¯ã€ãƒ†ãƒ¼ãƒ_configy.ymlã‚’è¨­å®šã—ã¦ã„ãã¾ã™ã€‚   ãƒ–ãƒ­ã‚°ã®ã‚¢ã‚¤ã‚³ãƒ³ã‚„ç”»åƒã¯ä»¥ä¸‹ã®éƒ¨åˆ†ã§è¨­å®šã—ã¦ã„ã¾ã™ã€‚    â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/6.png)  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/7.png)  å‚ç…§å…ƒã®ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ç½®å ´ã¯ä¸‹è¨˜ã«ã‚ã‚Šã¾ã™ã®ã§ã€å¿…è¦ã«å¿œã˜ã¦ä¿®æ­£ã—ã¾ã™ã€‚   **`Hexoç”¨\\themes\\material\\source\\img`**    ### SEOã‚’æœ€é©åŒ– ã“ã®è¨­å®šã‚’æœ‰åŠ¹ã«ã™ã‚‹ã¨ã€æ§‹é€ åŒ–ãƒ‡ãƒ¼ã‚¿ãŒãƒšãƒ¼ã‚¸ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã«ç”Ÿæˆã•ã‚Œã€Google ãªã©ã®æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã® SEO ã‚’æ”¹å–„ã™ã‚‹ã®ã«å½¹ç«‹ã¡ã¾ã™ã€‚   ãŸã ã—ã€`hexo g` ã« å•é¡ŒãŒã‚ã‚‹å ´åˆã¯ `false` ã«è¨­å®šã—ã¦ã¿ã¦ãã ã•ã„ã€‚    â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/8.png)  ### ã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ã¨èƒŒæ™¯è‰²  ã‚¹ãƒ­ãƒ¼ã‚¬ãƒ³ï¼ˆãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®æ¦‚è¦æ–‡ï¼‰ã¨èƒŒæ™¯è‰²ã¯ä¸‹è¨˜ã‹ã‚‰è¨­å®šã—ã¾ã™ã€‚  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/9.png)  ### ãƒšãƒ¼ã‚¸ã®JavaScriptã‚¨ãƒ•ã‚§ã‚¯ãƒˆ  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/10.png)  ### æŠ•ç¨¿ãƒšãƒ¼ã‚¸è¦æ—¨ã®å˜èªæ•°  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/11.png)  ### æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã®ã‚µãƒ ãƒã‚¤ãƒ«  material ãƒ†ãƒ¼ãƒã¯ 19 æšã®ã‚·ãƒ³ãƒ—ãƒ«ãªç”»åƒãŒæº–å‚™ã•ã‚Œã¦ã„ã¾ã™ã€‚æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã«ã‚µãƒ ãƒã‚¤ãƒ«ãŒå®šç¾©ã•ã‚Œã¦ã„ãªã„å ´åˆã€ãƒ†ãƒ¼ãƒã¯ãƒ©ãƒ³ãƒ€ãƒ ãƒ•ã‚©ãƒ«ãƒ€ï¼ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\themes\\material\\source\\img\\randomï¼‰ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ ã«å†™çœŸã‚’é¸æŠã—ã¾ã™ã€‚    ãƒ©ãƒ³ãƒ€ãƒ ã«è¡¨ç¤ºã™ã‚‹ç”»åƒæ•°ã¯ä¸‹è¨˜ã‹ã‚‰è¨­å®šã—ã¾ã™ã€‚  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/12.png)  æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã«ã‚µãƒ ãƒã‚¤ãƒ«ã‚’è¨­å®šã™ã‚‹å ´åˆã¯ã€æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã®mdãƒ•ã‚¡ã‚¤ãƒ«ã®ä¸Šéƒ¨ã«**thumbnail**ã‚’è¨­å®šã™ã‚Œã°OKã§ã™ã€‚   ã‚µãƒ³ãƒ—ãƒ«ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚    â–¼æŠ•ç¨¿ãƒšãƒ¼ã‚¸ã®ãƒ•ã‚¡ã‚¤ãƒ«.md   ![image](/blog/30/13.png)  ä¸Šè¨˜ã®ä¾‹ã§ã¯ã€ã€ŒHexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\themes\\material\\source\\img\\thumbnailsã€ãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆã—ã€ãã“ã«ä¿å­˜ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚µãƒ ãƒã‚¤ãƒ«ã¨ã—ã¦åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚  ### ãƒ•ã‚©ãƒ³ãƒˆ  ãƒ•ã‚©ãƒ³ãƒˆã¯ã€åˆæœŸè¨­å®šã ã¨æ—¥æœ¬èªã®è¦‹æ „ãˆãŒè‰¯ããªã‹ã£ãŸãŸã‚ã€ä¸‹è¨˜ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/14.png)  ### ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ã®å¼·èª¿è¡¨ç¤º  material ãƒ†ãƒ¼ãƒã¯ã€2 ç¨®é¡ã®ã‚³ãƒ¼ãƒ‰ã®å¼·èª¿è¡¨ç¤ºã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚   - prettify - hanabi  ä¸Šè¨˜ã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ã€ãƒ«ãƒ¼ãƒˆ_config.yml å†…ã®ã‚³ãƒ¼ãƒ‰ã®å¼·èª¿è¡¨ç¤ºã‚’ã‚ªãƒ•ã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚   ï¼ˆãã†ã—ãªã‘ã‚Œã°ç«¶åˆã—ã¦ã—ã¾ã„ã¾ã™ã€‚ï¼‰  ä»¥ä¸‹ã¯ã€habani ã®è¨­å®šä¾‹ã§ã™ã€‚  â–¼ãƒ«ãƒ¼ãƒˆ_config.yml   ![image](/blog/30/15.png)  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/16.png)  hanabi è¡¨ç¤ºåŠ¹æœã®ã‚µãƒ³ãƒ—ãƒ«ã‚’è¼‰ã›ã¦ãã¾ã™ã€‚   ![image](/blog/30/17.png)  ### SNSè¨­å®š  å¿…è¦ç„¡ã„ãƒªãƒ³ã‚¯ã¯ç©ºç™½ã§OKã§ã™ã€‚  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/18.png)  ### ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®š  ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/19.png)  ã“ã®è¨­å®šã®å ´åˆã€ä¸‹è¨˜ã®ã‚ˆã†ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  ![image](/blog/30/20.png)  ã‚¢ã‚¤ã‚³ãƒ³ã¯ã€**Google ã® Material Icon** ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ã€‚   ã€€â†“   [https://fonts.google.com/icons?icon.set=Material+Icons](https://fonts.google.com/icons?icon.set=Material+Icons)  åˆ©ç”¨ã—ãŸã„ã‚¢ã‚¤ã‚³ãƒ³ã‚’è¦‹ã¤ã‘ã¦ã€ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€Œicon: **ã‚³ã‚³**ã€ã«è¨­å®šã—ã¦ä¸‹ã•ã„ã€‚  **â€»Google ã® material icon ãŒå…¨ã¦åˆ©ç”¨ã§ãã‚‹ã‚ã‘ã§ã¯ãªãã€è¡¨ç¤ºãŒåæ˜ ã•ã‚Œãªã„ã‚¢ã‚¤ã‚³ãƒ³ã‚‚ã‚ã‚Šã¾ã™**ã®ã§ã”æ³¨æ„ä¸‹ã•ã„ã€‚ç†ç”±ã¯ä¸æ˜ã§ã™ã€‚    ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€Œã‚¿ã‚°ã€ãƒ»ã€Œãƒªãƒ³ã‚¯ã€ãƒ»ã€Œå•ã„åˆã‚ã›ã€ã¯å°‚ç”¨ã®ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ–¹æ³•ã¯å¾Œè¿°ã—ã¾ã™ã€‚  ### ã‚¿ã‚°ãƒšãƒ¼ã‚¸ä½œæˆ  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/21.png)  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‹ãã€Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å…¥åŠ›ã—ã¾ã™ã€‚  â–¼ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ```cmd cd Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª hexo new page \"tags\" ```  `Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\tags` ãƒ•ã‚©ãƒ«ãƒ€å†…ã® `index.md` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚    â–¼Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\tags\\index.md  ```md --- title: tags date: 2023-02-26 15:50:54 layout: tags --- ```  **`layout: tags` ãŒå¿…é ˆ**ã§ã™ã€‚    ### ãƒªãƒ³ã‚¯ãƒšãƒ¼ã‚¸ä½œæˆ  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/22.png)  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‹ãã€Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å…¥åŠ›ã—ã¾ã™ã€‚  â–¼ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ```cmd cd Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª hexo new page \"links\" ```  `Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\links` ãƒ•ã‚©ãƒ«ãƒ€å†…ã® `index.md` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ç·¨é›†ã—ã¾ã™ã€‚  â–¼Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\links\\index.md  ```md --- title: links date: 2023-02-27 18:03:34 layout: links --- ```  **`layout: links` ãŒå¿…é ˆ**ã§ã™ã€‚    ã¾ãŸã€`Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source` ãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã€Œ**\\_data**ã€ãƒ•ã‚©ãƒ«ãƒ€ ã‚’ä½œæˆã—ã€ãã®ç›´ä¸‹ã«ã€Œ**links.yml**ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¦ç·¨é›†ã—ã¾ã™ã€‚    ç·¨é›†å†…å®¹ã®ã‚µãƒ³ãƒ—ãƒ«ã¯ä¸‹è¨˜ã¨ãªã‚Šã¾ã™ã€‚ãƒªãƒ³ã‚¯ã‚’è¤‡æ•°ã«å¢—ã‚„ã™å ´åˆã¯ã€ç¶šã‘ã¦è¨˜è¼‰ã—ã¦ã„ã‘ã°OKã§ã™ã€‚    â–¼Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\\\_data\\links.yml   ```yml Github atman-33:      link: https://github.com/atman-33     avatar: https://avatars.githubusercontent.com/u/41929192?v=4     descr: \"Github ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸\"  Google Material Icons:      link: https://fonts.google.com/icons?icon.set=Material+Icons     avatar: https://www.gstatic.com/images/icons/material/apps/fonts/1x/catalog/v5/favicon.svg     descr: \"Google ãƒãƒ†ãƒªã‚¢ãƒ«ã‚¢ã‚¤ã‚³ãƒ³\"   ```  ### å•ã„åˆã‚ã›ãƒšãƒ¼ã‚¸ä½œæˆ  â–¼ãƒ†ãƒ¼ãƒ_config.yml   ![image](/blog/30/23.png)  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‹ãã€Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ç§»å‹•ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ã«å…¥åŠ›ã—ã¾ã™ã€‚  â–¼ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ ```cmd cd Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª hexo new page \"about\" ```  `Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\about` ãƒ•ã‚©ãƒ«ãƒ€å†…ã® `index.md` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç·¨é›†ã—ã¾ã™ã€‚    â–¼Hexoç”¨ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª\\source\\about\\index.md    ```md --- title: å•ã„åˆã‚ã› date: 2023-02-27 18:14:12 ---  ã”é–²è¦§é ‚ãã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚  è³ªå•ãƒ»è¦æœ›ãªã©ã‚ã‚Šã¾ã—ãŸã‚‰ã€Twitterã§é€£çµ¡ãã ã•ã„ã€‚  â€»ã“ã“ã«Twitterã®URLãªã©  ```  ã“ã®ãƒšãƒ¼ã‚¸ã¯ã€é€šå¸¸ã®å›ºå®šãƒšãƒ¼ã‚¸ã§ã™ã€‚   ãã“ã«Twitterãªã©ã®URLã‚’æ²è¼‰ã™ã‚Œã°ã€å•åˆã›å…ˆã¨ã—ã¦åˆ©ç”¨å¯èƒ½ã§ã™ã€‚    ___  ä»¥ä¸Šã§ã™ã€‚"
    },
    "_id": "blog/30-material-theme-hexo.mdx",
    "_raw": {
      "sourceFilePath": "blog/30-material-theme-hexo.mdx",
      "sourceFileName": "30-material-theme-hexo.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/30-material-theme-hexo"
    },
    "type": "Post",
    "slug": "/blog/30-material-theme-hexo",
    "slugAsParams": "30-material-theme-hexo"
  },
  {
    "title": "Hexo | ãŠã™ã™ã‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³",
    "description": "Hexo ã®ãŠã™ã™ã‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³",
    "date": "2023-03-05T00:00:00.000Z",
    "emoji": "â›…",
    "tags": ["hexo"],
    "published": true,
    "body": {
      "raw": " Hexoã®ãŠã™ã™ã‚ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚  ### ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤‰æ›´ã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã«å³æ™‚åæ˜   ```shell npm install -g browser-sync  npm install hexo-browsersync --save ```  ### GitHub page ã«ãƒ‡ãƒ—ãƒ­ã‚¤  ```shell npm install hexo-deployer-git --save ```  ### ã‚µã‚¤ãƒˆãƒãƒƒãƒ—ä½œæˆ  ```shell npm install hexo-generator-seo-friendly-sitemap --save ```  `_config.yml`ã«è¿½è¨˜    â–¼Hexoãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª   `_config.yml`    ```yml sitemap:   path: sitemap.xml   tag: true   category: true ```  ### robots.txtç”Ÿæˆ  ```shell pm install hexo-generator-robotstxt --save ```  â–¼Hexoãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª    `_config.yml`    ```yml robotstxt:   useragent: \"*\"   disallow:     - /about/     - /gallery/     - /privacy-policy/     - /archives/     - /css/     - /img/     - /js/   allow:   sitemap: /sitemap.xml ``` "
    },
    "_id": "blog/31-recommended-plugins-hexo.mdx",
    "_raw": {
      "sourceFilePath": "blog/31-recommended-plugins-hexo.mdx",
      "sourceFileName": "31-recommended-plugins-hexo.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/31-recommended-plugins-hexo"
    },
    "type": "Post",
    "slug": "/blog/31-recommended-plugins-hexo",
    "slugAsParams": "31-recommended-plugins-hexo"
  },
  {
    "title": "C# | WPF Prism ç”»é¢é·ç§»ãƒ¡ãƒ¢ãƒªé–‹æ”¾",
    "description": "C# WPF Prism ã®ç”»é¢é·ç§»æ™‚ã«ãŠã‘ã‚‹ãƒ¡ãƒ¢ãƒªè§£æ”¾æ–¹æ³•",
    "date": "2023-03-05T00:00:00.000Z",
    "emoji": "ğŸ’»",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " WPF Prism ã§ã¯ã€Regionã¨ã„ã†æ©Ÿèƒ½ã§ç”»é¢é·ç§»ã—ã¾ã™ã€‚  ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã®ç”»é¢é·ç§»ï¼ˆç”»é¢ã®ä¸€éƒ¨ã§ã‚ã‚‹Regionéƒ¨åˆ†ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‹å‡¦ç†ï¼‰ã§ã¯ã€é·ç§»å…ˆã« INavigaitionAware ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  ãã®éš›ã«ç”Ÿæˆã•ã‚Œã‚‹ **IsNavigationTarget ãƒ¡ã‚½ãƒƒãƒ‰**ã¯ã€ViewModelã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ã„å›ã™ã‹ã©ã†ã‹ã‚’ æˆ»ã‚Šå€¤ã® bool ã§åˆ¤æ–­ã—ã¾ã™ãŒã€**return false ã¨ã—ã¦ã‚‚ãƒ¡ãƒ¢ãƒªã¯é–‹æ”¾ã•ã‚Œã¾ã›ã‚“**ã€‚  **ã€IsNavigationTargetã®æˆ»ã‚Šå€¤**   - true : ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ã„å›ã™ã€‚æ¬¡å›ã®ç”»é¢èµ·å‹•æ™‚ã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå‘¼ã°ã‚Œãªã„ã€‚ - false: ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½¿ã„å›ã•ãªã„ã€‚æ¬¡å›ã®ç”»é¢èµ·å‹•æ™‚ã«ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒå‘¼ã°ã‚Œã‚‹ã€‚ãŸã ã—ã€**ãƒ¡ãƒ¢ãƒªã¯é–‹æ”¾ã•ã‚Œãªã„**ã€‚  ## ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ç”»é¢é·ç§»æ™‚ã«ãƒ¡ãƒ¢ãƒªã‚’é–‹æ”¾ã™ã‚‹æ–¹æ³•  ViewModelã«**IRegionMemberLifetimeã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…**ã—ã€**KeepAliveãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å€¤ã‚’false**ã«ã—ã¾ã™ã€‚  ã¾ãŸã€**INavigationAwareã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚‚åˆã‚ã›ã¦å®Ÿè£…**ã—ã¦ã„ã‚‹å ´åˆã€**IsNavigationTarget ã¯ True**ã«ã—ã¦ãŠãã¾ã™ã€‚  ViewModelã¸ã®å®Ÿè£…ä¾‹ã§ã™ã€‚  â–¼SampleViewModel.cs ```cs public class SampleViewModel : BindableBase, INavigationAware, IRegionMemberLifetime {     /// <summary>     /// ViewModelç ´æ£„ã«ä¼´ã„ãƒ¡ãƒ¢ãƒªé–‹æ”¾ã™ã‚‹éš›ã¯false     /// </summary>     public bool KeepAlive { get; set; } = false;      public SampleViewModel()     {     }      public bool IsNavigationTarget(NavigationContext navigationContext)     {         //// RegionMemberLifetime(KeepAlive = false)ã§ViewModelã‚’ç ´æ£„ã™ã‚‹ãŸã‚ã€ã“ã¡ã‚‰ã¯True         return true;     }      public virtual void OnNavigatedFrom(NavigationContext navigationContext)     {     }      public virtual void OnNavigatedTo(NavigationContext navigationContext)     {     } } ```  ä»¥ä¸Šã§ã™ã€‚"
    },
    "_id": "blog/32-delete-view-instance-cash-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/32-delete-view-instance-cash-wpf-prism-cs.mdx",
      "sourceFileName": "32-delete-view-instance-cash-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/32-delete-view-instance-cash-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/32-delete-view-instance-cash-wpf-prism-cs",
    "slugAsParams": "32-delete-view-instance-cash-wpf-prism-cs"
  },
  {
    "title": "C# | Prism Xamarin Forms ã€Œå‚ç…§ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ å¯¾å‡¦",
    "description": "Visual Studioã§ã€Prismã®ã€ŒXamarin Formsã€ã‚’åˆ©ç”¨æ™‚ã€UWPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‰ãšã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹éš›ã®å¯¾å‡¦æ–¹æ³•",
    "date": "2023-03-11T00:00:00.000Z",
    "emoji": "ğŸœ",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " Visual Studioã§ã€Prismã®ã€ŒXamarin Formsã€ã‚’åˆ©ç”¨ã—ã¦ã„ãŸéš›ã€UWPãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ“ãƒ«ãƒ‰ãŒé€šã‚‰ãªãã¦ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã„ã¾ã—ãŸã€‚  å¯¾å‡¦æ–¹æ³•ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚  ## ç¾è±¡  ç’°å¢ƒã¯ä»¥ä¸‹  - Windows 10 - Visual Studio 2022 - Prism Template Pack ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿  ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ã“ã¡ã‚‰ã§ã™ã€‚  ![image](/blog/33/1.png)  > .NETCore,Version=v5.0 ã®å‚ç…§ã‚¢ã‚»ãƒ³ãƒ–ãƒªãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã“ã®å•é¡Œã‚’è§£æ±ºã™ã‚‹ã«ã¯ã€ã“ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã® Developer Pack (SDK/Targeting Pack) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‹ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚’å†è¨­å®šã—ã¦ãã ã•ã„ã€‚https://aka.ms/msbuild/developerpacks ã§ .NET Framework Developer Pack ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚   ## å¯¾å‡¦  Visual Studio ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‹ã‚‰ã€**ãƒ¦ãƒ‹ãƒãƒ¼ã‚µãƒ« Windows ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ é–‹ç™ºã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«**ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  ![image](/blog/33/3.png)  æ¤œè¨¼ã§ãã¦ã„ã¾ã›ã‚“ãŒã€åˆã‚ã›ã¦ã€Œ.NET ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  ã‚¢ãƒ—ãƒªã® UIé–‹ç™ºã€ã‚‚å¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚   ï¼ˆä»Šå›ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸéš›ã€ãƒãƒ«ãƒãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ UIé–‹ç™ºã¯æ—¢ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã ã£ãŸãŸã‚ï¼‰    ä»¥ä¸Šã§ã™ã€‚"
    },
    "_id": "blog/33-prism-xamarin-form-uwp-assembly-error-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/33-prism-xamarin-form-uwp-assembly-error-cs.mdx",
      "sourceFileName": "33-prism-xamarin-form-uwp-assembly-error-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/33-prism-xamarin-form-uwp-assembly-error-cs"
    },
    "type": "Post",
    "slug": "/blog/33-prism-xamarin-form-uwp-assembly-error-cs",
    "slugAsParams": "33-prism-xamarin-form-uwp-assembly-error-cs"
  },
  {
    "title": "Oracle 21c XE æ§‹ç¯‰æ‰‹é †",
    "description": "Windows PCã«ã€ã€ŒOracle Database 21c Express Edition (XE)ã€ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦åˆ©ç”¨ã™ã‚‹æ–¹æ³•",
    "date": "2023-03-11T00:00:00.000Z",
    "emoji": "ğŸ’¿",
    "tags": ["oracle"],
    "published": true,
    "body": {
      "raw": "Windows PCã«ã€ã€ŒOracle Database 21c Express Edition (XE)ã€ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦åˆ©ç”¨ã™ã‚‹æ–¹æ³•ã‚’è¨˜ã—ã¦ãŠãã¾ã™ã€‚  ## Oracle XE ã¨ã¯  ç‰¹å¾´ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚  - ç„¡å„Ÿã‹ã¤æœ¬ç•ªç’°å¢ƒã§Oracle Database XEã‚’ä½¿ç”¨å¯èƒ½ - æœ€å¤§12GBã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ»ãƒ‡ãƒ¼ã‚¿ - æœ€å¤§2GBã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹RAM - æœ€å¤§2ã¤ã®CPUã‚¹ãƒ¬ãƒƒãƒ‰  ç§ã¯ã‚¢ãƒ—ãƒªé–‹ç™ºç”¨ã§ã€å€‹äººPCã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã¾ã™ã€‚  â€»å…¬å¼HPã®Oracle XEèª¬æ˜   [Oracle XE èª¬æ˜](https://www.oracle.com/jp/database/technologies/appdev/xe.html)    ## æ‰‹é †  ### 1. ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰  Webã‹ã‚‰ã€ŒOracle Database XEã€ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚  [Oracle XE ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://www.oracle.com/jp/database/technologies/xe-downloads.html)  ![image](/blog/34/1.png)  ã€ŒOracle Database 21c Express Edition for Windows x64ã€ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’é–‹å§‹ã—ã¾ã™ã€‚  ### 2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã€ŒOracleXE213_Win64.zipã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è§£å‡ã—ã¾ã™ã€‚  è§£å‡ã—ã¦ä½œæˆã•ã‚ŒãŸãƒ•ã‚©ãƒ«ãƒ€å†…ã®ã€Œsetup.exeã€ã‚’**ç®¡ç†è€…ã¨ã—ã¦**å®Ÿè¡Œã—ã¾ã™ã€‚  ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³æŠ¼ä¸‹ã€ã€Œä½¿ç”¨è¨±è«¾æ¡é …ã®å—ã‘å…¥ã‚Œã€ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦é€²ã‚ã¾ã™ã€‚  å®›å…ˆãƒ•ã‚©ãƒ«ãƒ€ç”»é¢ã§ã€ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã‚’è¨­å®šã—ã¾ã™ã€‚ç§ã¯ä¸‹è¨˜ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚  `å®›å…ˆãƒ•ã‚©ãƒ«ãƒ€ï¼š C:\\oracle\\product\\21c\\`  ä¸Šè¨˜ã®å ´åˆã€Oracleç’°å¢ƒå¤‰æ•°ã‚‚åˆã‚ã›ã¦å¤‰æ›´ã•ã‚Œã¾ã™ã€‚  `Oracleãƒ›ãƒ¼ãƒ ï¼š C:\\oracle\\product\\21c\\dbhomeXE\\` `Oracleãƒ™ãƒ¼ã‚¹ï¼š C:\\oracle\\product\\21c\\`  Oracle Databaseæƒ…å ±ã§ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™ã€‚   ï¼ˆSYSã€SYSTEMã€PDBADMINã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰  `ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¾‹ï¼‰sys`  æ­£å¸¸ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†å¾Œã€DBé–¢é€£æƒ…å ±ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  ![image](/blog/34/2.png)  ã“ã‚Œã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å®Œäº†ã§ã™ã€‚  ### 3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚‚ã—ãã¯ power shell ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã„ãã¾ã™ã€‚  Oracle 21c XEã«æ¥ç¶š ```shell sqlplus / as sysdba ```  æ¥ç¶šå…ˆã‚’ç¢ºèª ```sql SQL> show con_name  â†“  CON_NAME ------------------------------ CDB$ROOT ``` ã‚³ãƒ³ãƒ†ãƒŠãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆCDBï¼‰ã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒ—ãƒ©ã‚¬ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ï¼ˆPDBï¼‰ã«æ¥ç¶šã‚’åˆ‡ã‚Šæ›¿ãˆã¾ã™ã€‚  å­˜åœ¨ã™ã‚‹ãƒ—ãƒ©ã‚¬ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ç¢ºèªã—ã¾ã™ã€‚ ```sql SQL> show pdbs  â†“      CON_ID CON_NAME                       OPEN MODE  RESTRICTED ---------- ------------------------------ ---------- ----------          2 PDB$SEED                       READ ONLY  NO          3 XEPDB1                         READ WRITE NO ````  æ—¢ã«å­˜åœ¨ã™ã‚‹ã€ŒXEPDB1ã€ã‚’åˆ©ç”¨ã™ã‚‹äº‹ã¨ã—ã¾ã™ã€‚  ```sql SQL> ALTER SESSION SET CONTAINER=XEPDB1;  â†“  ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚ ```  ```sql SQL> show con_name  â†“  CON_NAME ------------------------------ XEPDB1  ``` ã€ŒXEPDB1ã€ã«æ¥ç¶šã—ã¾ã—ãŸã€‚  ç¶šã„ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆã—ã¾ã™ã€‚  - ãƒ¦ãƒ¼ã‚¶ãƒ¼: atman - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: atman  ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ŒDEFAULTã€ã‚’è¨­å®šã—ã¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æœŸé™ã‚’ç„¡æœŸé™ã«ã—ã¾ã™ã€‚  ```sql SQL >  CREATE USER atman IDENTIFIED BY atman; GRANT CONNECT, RESOURCE TO atman; ALTER USER atman QUOTA UNLIMITED ON users; ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED; ```  ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ã¿ã¾ã™ã€‚ ```sql SQL > select username, profile from dba_users where username = 'ATMAN'; ``` ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ŒDEFAULTã€ã¨ãªã£ã¦ã„ã¾ã—ãŸã€‚  ```sql SQL > SELECT * FROM DBA_PROFILES WHERE RESOURCE_NAME = 'PASSWORD_LIFE_TIME'; ``` ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«DEFAULTã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç„¡æœŸé™ã¨ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚  ã“ã‚Œã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã¯å®Œäº†ã§ã™ã€‚  è£œè¶³ã§ã™ãŒã€è¡¨é ˜åŸŸã¯ä¸‹è¨˜ã«ãªã£ã¦ã„ã¾ã™ã€‚  - è¡¨é ˜åŸŸ: USERS - ä¸€æ™‚è¡¨é ˜åŸŸ: TEMP  ç¢ºèªç”¨ã®SQLã§ã™ã€‚ ```sql SELECT username,default_tablespace,temporary_tablespace  FROM DBA_USERS WHERE username='ATMAN'; ```   ### 4. tnsnames.ora ç·¨é›†  æœ€å¾Œã«ã€ä»Šå›åˆ©ç”¨ã—ãŸãƒ—ãƒ©ã‚¬ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ã€tnsnames.oraã‚’ç·¨é›†ã—ã¾ã™ã€‚  ___ >è£œè¶³    >tnsnames.ora ã®ä¿å­˜å ´æ‰€ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•ã§ã™ã€‚   > >ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’é–‹ã„ã¦ã€**tnsping ã‚’ã‚ã–ã¨å¤±æ•—**ã•ã›ã¾ã™ã€‚   >ä¾‹ãˆã° `tnsping aaa`ã¨å®Ÿè¡Œã—ã¾ã™ã€‚ï¼ˆaaaã¯ä»®ã€‚å­˜åœ¨ã—ãªã„TNSåã§ãªã‘ã‚Œã°ä½•ã§ã‚‚OKï¼‰    ```shell C:\\Repos\\computing-atman> tnsping aaa  â†“  TNS Ping Utility for 64-bit Windows: Version 21.0.0.0.0 - Production on 11-3æœˆ -2023 22:52:44  Copyright (c) 1997, 2021, Oracle.  All rights reserved.  ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã—ãŸ: C:\\oracle\\product\\21c\\homes\\OraDB21Home1\\network\\admin\\sqlnet.ora  TNS-03505: åå‰ã®è§£æ±ºã«å¤±æ•—ã—ã¾ã—ãŸã€‚ ```  ä¸Šè¨˜ã®**sqlnet.oraãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿å­˜ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã€tnsnames.oraã‚‚ä¿å­˜**ã•ã‚Œã¦ã„ã¾ã™ã€‚ ___  tnsnames.oraã®æœ€å¾Œã«ã€ä»¥ä¸‹ã®è¨˜è¿°ã‚’è¿½åŠ ã—ã¾ã™ã€‚  ```text XEPDB1= (DESCRIPTION=   (LOAD_BALANCE=off)    (ADDRESS=     (PROTOCOL=tcp)       (HOST=localhost)       (PORT=1521)   )    (CONNECT_DATA=     (SERVICE_NAME=XEPDB1)      (FAILOVER_MODE=       (TYPE=select)        (METHOD=basic)     )   ) ) ```  ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã§ã€tnspingã§æ¥ç¶šç¢ºèªã—ã¾ã™ã€‚ ```shell tnsping XEPDB1 ```  OKã¨è¡¨ç¤ºã•ã‚Œã‚Œã°ã€å•é¡Œç„¡ã—ã§å®Œäº†ã§ã™ã€‚  > ã‚‚ã—ä¸Šè¨˜ã§æ§‹ç¯‰ã—ãŸOracleã«å¯¾ã—ã¦ã€ä»–PCã‚„ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰æ¥ç¶šã™ã‚‹å ´åˆã¯ã€Windows FireWall ã®è¨­å®šã‚’å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ > æ–¹æ³•ã¯ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚’æ¤œç´¢ã™ã‚Œã°æ‰‹é †ãŒè¦‹ã¤ã‹ã‚Šã¾ã™ã®ã§ã€ã“ã“ã§ã®èª¬æ˜ã¯å‰²æ„›ã—ã¾ã™ã€‚"
    },
    "_id": "blog/34-install-oracle-xe.mdx",
    "_raw": {
      "sourceFilePath": "blog/34-install-oracle-xe.mdx",
      "sourceFileName": "34-install-oracle-xe.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/34-install-oracle-xe"
    },
    "type": "Post",
    "slug": "/blog/34-install-oracle-xe",
    "slugAsParams": "34-install-oracle-xe"
  },
  {
    "title": "C# | Xamarin ã§ Android å®Ÿæ©Ÿã«æ¥ç¶š",
    "description": "Visual Studio ã® Xamarin Forms ã‹ã‚‰ã€Androidç«¯æœ«ã®å®Ÿæ©Ÿã«æ¥ç¶šã™ã‚‹æ‰‹é †",
    "date": "2023-03-12T00:00:00.000Z",
    "emoji": "ğŸ“±",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " Visual Studio ã® Xamarin Forms ã‹ã‚‰ã€Androidç«¯æœ«ã®å®Ÿæ©Ÿã«æ¥ç¶šã™ã‚‹æ‰‹é †ã‚’è¨˜ã—ã¾ã™ã€‚  Androidç«¯æœ«ã®ç¨®é¡ã«ã‚‚ä¾ã‚‹ã¨æ€ã„ã¾ã™ãŒã€Webã«æ²è¼‰ã•ã‚Œã¦ã„ã‚‹æ‰‹é †ã§ä¸Šæ‰‹ãã„ã‹ãªã„å ´åˆã«å‚è€ƒã«ã—ã¦ä¸‹ã•ã„ã€‚  ## æ‰‹é †  ç’°å¢ƒã¯ä»¥ä¸‹ã¨ãªã‚Šã¾ã™ã€‚  - Visual Studio 2023 - Androidç«¯æœ« : Galaxy S10 - Androidãƒãƒ¼ã‚¸ãƒ§ãƒ³ : 12 - PCã¨Andoroidç«¯æœ«ã¯USBæ¥ç¶š  ### 1. Xamarin ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ  Visual Studio ã§ Xamarin ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¦é–‹ãã¾ã™ã€‚  ### 2. Android SDK Managerã‚’èµ·å‹•  ã‚¿ãƒ–ã® ãƒ„ãƒ¼ãƒ« > Android > Android SDK Manager ã‚’èµ·å‹•ã—ã¾ã™ã€‚  ### 3. Androidé–¢é€£ã®ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  æ¥ç¶šã™ã‚‹Androidç«¯æœ«ã®Androiãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«å¯¾å¿œã—ãŸSDK Platformã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  Androidãƒãƒ¼ã‚¸ãƒ§ãƒ³12ã®å ´åˆ - ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ  > Andoroid 12.0 - S > Android SDK Platform 31  ã¾ãŸã€Andoroidç«¯æœ«ã¨USBæ¥ç¶šã™ã‚‹ã®ã§ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚‚å¿…è¦ã§ã™ã€‚ - ãƒ„ãƒ¼ãƒ« > è¿½åŠ  > Google USB Driver  ### 4. PCã‚’é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´  è¨­å®š > é–‹ç™ºè€…å‘ã‘ ã§è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚ - é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ : ON - ãƒ‡ãƒã‚¤ã‚¹ã®æ¤œå‡º : ON  ![image](/blog/35/1.png)  ### 5. Androidç«¯æœ«ã‚’é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ã«å¤‰æ›´  Galaxyã®å ´åˆã¯ä»¥ä¸‹ã®æ‰‹é †ã§ã™ã€‚  - è¨­å®šã‚¢ãƒ—ãƒª > ç«¯æœ«æƒ…å ±ã€€ã‚’é–‹ã - ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢æƒ…å ±ã€€ã‚’é¸æŠ - ãƒ“ãƒ«ãƒ‰ç•ªå· ã‚’ 7å›é€£ç¶š ã§ã‚¿ãƒƒãƒ—  ã“ã‚Œã§é–‹ç™ºè€…ãƒ¢ãƒ¼ãƒ‰ãŒONã¨ãªã‚Šã€è¨­å®šã‚¢ãƒ—ãƒªã®ä¸€ç•ªä¸‹ã«ã€Œé–‹ç™ºè€…å‘ã‘ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚  ### 6. Andoroidç«¯æœ«ã®USBãƒ‡ãƒãƒƒã‚°ã‚’æœ‰åŠ¹  å¼•ãç¶šãã€Andoroidç«¯æœ«ã®ã€Œé–‹ç™ºè€…å‘ã‘ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚ - USBãƒ‡ãƒãƒƒã‚° : ON ã«å¤‰æ›´  ã“ã®æ™‚ç‚¹ã§ã€PCã¨Andoroidç«¯æœ«ã‚’USBã‚±ãƒ¼ãƒ–ãƒ«ã§æ¥ç¶šã—ã€Visual Studio ã® Androidãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‹ã‚‰ãƒ‡ãƒãƒƒã‚°èµ·å‹•ã™ã‚‹éš›ã«ã€ŒAndoroidç«¯æœ«ã€ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚Œã°å•é¡Œç„¡ãå®Œäº†ã§ã™ã€‚  ã‚‚ã—ã€ã“ã®æ™‚ç‚¹ã§ã‚‚Visual Studioä¸Šã§Andoroidç«¯æœ«ã‚’èªè­˜ã—ã¦ã„ãªã„ã‚ˆã†ã§ã‚ã‚Œã°ã€ä»¥ä¸‹ã‚’è©¦ã—ã¦ä¸‹ã•ã„ã€‚  ### 7. USBã‚±ãƒ¼ãƒ–ãƒ«å¤‰æ›´  PCã¨Andoroidç«¯æœ«ã‚’USBæ¥ç¶šã—ã¦ã„ã‚‹ã«ã‚‚é–¢ã‚ã‚‰ãšã€PCã®ã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ä¸Šã«Andoroidç«¯æœ«ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ãªã„å ´åˆã€**USBã‚±ãƒ¼ãƒ–ãƒ«ãŒå¯¾å¿œã—ã¦ã„ãªã„å¯èƒ½æ€§**ãŒã‚ã‚Šã¾ã™ã€‚  USBã‚±ãƒ¼ãƒ–ãƒ«ã‚’å¤‰æ›´ã—ã€WindowsãŒAndoroidç«¯æœ«ã‚’èªè­˜ã—ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„ã€‚   ï¼ˆé€šå¸¸ã€USBæ¥ç¶šã—ãŸæ™‚ç‚¹ã§ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ç­‰ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼‰  ### 8. Android ã®USBè¨­å®šã‚’å¤‰æ›´  Andoroidç«¯æœ«ã®ã€Œé–‹ç™ºè€…å‘ã‘ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€è¨­å®šã‚’å¤‰æ›´ã—ã¾ã™ã€‚ - æ¨™æº–USBè¨­å®š > **ç”»åƒã‚’è»¢é€** ã‚’é¸æŠ  ã“ã“ã¾ã§ã®è¨­å®šã§æ¦‚ã­ä¸Šæ‰‹ãã„ãã¨æ€ã„ã¾ã™ã€‚  ã“ã‚Œã§ã‚‚PCãŒAndoroidç«¯æœ«ã‚’èªè­˜ã—ãªã„å ´åˆã¯ä»¥ä¸‹ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚  ### 9. Samsungãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« PCã«Samsungãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã¿ã¾ã™ã€‚  [https://developer.samsung.com/android-usb-driver](https://developer.samsung.com/android-usb-driver)  ãã‚Œã§ã‚‚ä¸Šæ‰‹ãã„ã‹ãªã„å ´åˆã¯ã€ä»–ã‚µã‚¤ãƒˆã‚’å‚è€ƒã«ã—ã¦ãƒˆãƒ©ã‚¤ã—ã¦ã„ãã—ã‹ãªã„ã§ã—ã‚‡ã†ã€‚ ___  ä»¥ä¸Šã§ã™ã€‚    "
    },
    "_id": "blog/35-xamarin-connect-android-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/35-xamarin-connect-android-cs.mdx",
      "sourceFileName": "35-xamarin-connect-android-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/35-xamarin-connect-android-cs"
    },
    "type": "Post",
    "slug": "/blog/35-xamarin-connect-android-cs",
    "slugAsParams": "35-xamarin-connect-android-cs"
  },
  {
    "title": "C# | WPF Prism MainWindow ã‹ã‚‰ ContentRegion ã® View ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•",
    "description": "WPF Prismã§ã¯ã€ä¸»è¦ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦(Main Window)ã¨ãã®ä¸­ã«å«ã¾ã‚Œã‚‹ä¸€é€£ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³(Region)ã§æ§‹æˆã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚‰ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¯ã€ãƒ“ãƒ¥ãƒ¼(View)ã‚„ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«(ViewModel)ãŒé…ç½®ã•ã‚Œã€ç›¸äº’ã«é€šä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚Main Windowã‹ã‚‰Content Regionã«ã‚ã‚‹ãƒ“ãƒ¥ãƒ¼ã‚„ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚",
    "date": "2023-03-19T00:00:00.000Z",
    "emoji": "ğŸŒ·",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " WPF Prismã§ã¯ã€ä¸»è¦ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦(Main Window)ã¨ãã®ä¸­ã«å«ã¾ã‚Œã‚‹ä¸€é€£ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³(Region)ã§æ§‹æˆã•ã‚Œã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚   ã“ã‚Œã‚‰ã®ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã«ã¯ã€ãƒ“ãƒ¥ãƒ¼(View)ã‚„ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«(ViewModel)ãŒé…ç½®ã•ã‚Œã€ç›¸äº’ã«é€šä¿¡ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  Main Windowã‹ã‚‰Content Regionã«ã‚ã‚‹ãƒ“ãƒ¥ãƒ¼ã‚„ãƒ“ãƒ¥ãƒ¼ãƒ¢ãƒ‡ãƒ«ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã¨ã—ã¦ã€ä»¥ä¸‹ã®æ‰‹é †ã®æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚  ### 1. Main Windowã‹ã‚‰Content Regionã«ã‚ã‚‹ãƒ“ãƒ¥ãƒ¼ã‚’å–å¾—ã™ã‚‹  ```cs var contentRegion = regionManager.Regions[\"ContentRegion\"]; var contentView = contentRegion.Views.FirstOrDefault() as YourContentView; ```  ### 2. å–å¾—ã—ãŸãƒ“ãƒ¥ãƒ¼ã‹ã‚‰ViewModelã‚’å–å¾—ã™ã‚‹  ```cs var contentViewModel = (YourContentViewModel)contentView.DataContext; ```  ### 3. ViewModelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™  ```cs contentViewModel.YourMethod(); ```  ãŸã ã—ã€ã“ã®æ–¹æ³•ã¯Content Regionã«ç¾åœ¨è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãƒ“ãƒ¥ãƒ¼ã«å¯¾ã—ã¦ã®ã¿æ©Ÿèƒ½ã—ã¾ã™ã€‚   Content Regionã«è¤‡æ•°ã®ãƒ“ãƒ¥ãƒ¼ãŒã‚ã‚‹å ´åˆã¯ã€ã©ã®ãƒ“ãƒ¥ãƒ¼ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã‹ã‚’æ˜ç¤ºçš„ã«æŒ‡å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚  ã¾ãŸã€ã“ã®æ–¹æ³•ã¯ã€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ã®åå‰ãŒ\"ContentRegion\"ã§ã‚ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚   ã‚‚ã—ç•°ãªã‚‹åå‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚"
    },
    "_id": "blog/36-mainwindow-call-content-region-view-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/36-mainwindow-call-content-region-view-wpf-prism-cs.mdx",
      "sourceFileName": "36-mainwindow-call-content-region-view-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/36-mainwindow-call-content-region-view-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/36-mainwindow-call-content-region-view-wpf-prism-cs",
    "slugAsParams": "36-mainwindow-call-content-region-view-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism éƒ¨åˆ†Viewã‹ã‚‰MainWindowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•",
    "description": "WPF Prismã§ã¯ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚Prismã®ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ViewModelé–“ã®ç›´æ¥çš„ãªå‚ç…§ã‚’å›é¿ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç°¡å˜ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚",
    "date": "2023-03-19T00:00:00.000Z",
    "emoji": "ğŸ‡",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " WPF Prismã§ã¯ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚  Prismã®ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ViewModelé–“ã®ç›´æ¥çš„ãªå‚ç…§ã‚’å›é¿ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç°¡å˜ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚    ä»¥ä¸‹ã¯ã€Aggregatorã‚’ä½¿ç”¨ã—ã¦ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ViewModelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã®ä¾‹ã§ã™ã€‚  ### 1. Main Windowã®ViewModelã«ã€å‘¼ã³å‡ºã—ãŸã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚  ```cs public class MainWindowViewModel : BindableBase {     private readonly IEventAggregator _eventAggregator;      public MainWindowViewModel(IEventAggregator eventAggregator)     {         _eventAggregator = eventAggregator;     }      public void SomeMethod()     {         // Do something     } } ```  ### 2. éƒ¨åˆ†Viewã«ã€ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’æ³¨å…¥ã—ã¾ã™ã€‚  ```cs public class PartialView : UserControl {     private readonly IEventAggregator _eventAggregator;      public PartialView(IEventAggregator eventAggregator)     {         _eventAggregator = eventAggregator;     } } ```  ### 3. éƒ¨åˆ†Viewå†…ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã¾ã™ã€‚  ãŸã¨ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã€\"SomeEvent\"ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  ```cs _eventAggregator.GetEvent<SomeEvent>().Publish(); ```  ãã®ã¾ã¾ã ã¨ã€SomeEventã‚¯ãƒ©ã‚¹ãŒç„¡ã„ãŸã‚ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚ ãã®ãŸã‚ã€æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¦ PubSubEvent ã‚’ç¶™æ‰¿ã—ãŸSomeEventã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ ```cs public class SomeEvent : PubSubEvent { } ```  è£œè¶³ã§ã™ãŒã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ã‚Šã®ã‚¤ãƒ™ãƒ³ãƒˆç”¨æ„ã™ã‚‹å ´åˆã¯ã€PubSubEventã®ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ã«å®šç¾©ã—ã¾ã™ã€‚ ```cs public class SomeEvent : PubSubEvent<string> { } ```  ### 4. Main Windowã®ViewModelã«ã€\"SomeEvent\"ã‚’è³¼èª­ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚  ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºè¡Œã•ã‚ŒãŸã¨ãã«ã€è©²å½“ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚  ```cs public class MainWindowViewModel : BindableBase {     private readonly IEventAggregator _eventAggregator;      public MainWindowViewModel(IEventAggregator eventAggregator)     {         _eventAggregator = eventAggregator;         _eventAggregator.GetEvent<SomeEvent>().Subscribe(OnSomeEvent);     }      public void OnSomeEvent()     {         SomeMethod();     }      public void SomeMethod()     {         // Do something     } } ```  ã“ã‚Œã§ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ViewModelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚   éƒ¨åˆ†Viewå†…ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ã§ã€Main Windowã®ViewModelã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã€å¿…è¦ãªå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚"
    },
    "_id": "blog/37-partialview-call-mainwindow-method-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/37-partialview-call-mainwindow-method-wpf-prism-cs.mdx",
      "sourceFileName": "37-partialview-call-mainwindow-method-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/37-partialview-call-mainwindow-method-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/37-partialview-call-mainwindow-method-wpf-prism-cs",
    "slugAsParams": "37-partialview-call-mainwindow-method-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”»é¢å†…ã«Regionï¼ˆContentControlï¼‰ã‚’é…ç½®ã™ã‚‹æ–¹æ³•",
    "description": "WPF Prismã§ã¯ã€Dialogç”»é¢å†…ã®ContentControlã«åˆ¥ã®Viewã‚’è¡¨ç¤ºã•ã›ã‚‹æ–¹æ³•",
    "date": "2023-03-19T00:00:00.000Z",
    "emoji": "ğŸ¦“",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " WPF Prismã§ã¯ã€Dialogç”»é¢å†…ã®ContentControlã«åˆ¥ã®Viewã‚’è¡¨ç¤ºã•ã›ã‚‹æ–¹æ³•ã¨ã—ã¦ã€ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  ### ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®Viewã‚’ä½œæˆ  1. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®Viewã‚’ä½œæˆã—ã¾ã™ã€‚ä¾‹ãˆã°ã€\"MyDialogView\"ã¨ã„ã†åå‰ã®Viewã‚’ä½œæˆã—ã¾ã™ã€‚ 2. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®ViewModelã‚’ä½œæˆã—ã¾ã™ã€‚ä¾‹ãˆã°ã€\"MyDialogViewModel\"ã¨ã„ã†åå‰ã®ViewModelã‚’ä½œæˆã—ã¾ã™ã€‚ 3. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®Viewã«ã€ContentControlã‚’è¿½åŠ ã—ã¾ã™ã€‚  ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªXAMLã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ContentControlã‚’è¿½åŠ ã—ã¾ã™ã€‚  ```xml <UserControl x:Class=\"MyNamespace.MyDialogView\"     xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"     xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"     xmlns:prism=\"http://www.codeplex.com/prism\"     prism:ViewModelLocator.AutoWireViewModel=\"True\"     Width=\"300\"     Height=\"300\">         <ContentControl          prism:RegionManager.RegionManager=\"{Binding MainRegionManager}\"          prism:RegionManager.RegionName=\"{Binding ContentRegionName}\"/> </UserControl> ```  ### ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã®ä¸€éƒ¨ã«è¡¨ç¤ºã•ã›ã‚‹Viewã‚’ä½œæˆ  4. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®Viewã«ã€è¡¨ç¤ºã•ã›ãŸã„Viewã‚’å®šç¾©ã—ã¾ã™ã€‚ä¾‹ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ãªXAMLã‚³ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€è¡¨ç¤ºã•ã›ãŸã„Viewã‚’å®šç¾©ã—ã¾ã™ã€‚  ```xml <UserControl x:Class=\"MyNamespace.MyContentView\"     xmlns=\"http://schemas.microsoft.com/winfx/2006/xaml/presentation\"     xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\">     <Grid>         <!-- è¡¨ç¤ºã•ã›ãŸã„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®å®šç¾© -->     </Grid> </UserControl> ```  ### ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®ViewModelã«å‡¦ç†ã‚’è¿½åŠ   5. ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”¨ã®ViewModelã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã§ã€è¡¨ç¤ºã•ã›ãŸã„Viewã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®å‡¦ç†ã‚’è¿½åŠ ã—ã¾ã™ã€‚  ```cs public MyDialogView(IRegionManager regionManager) {     MainRegionManager = regionManager;       MainRegionManager.RegisterViewWithRegion(_contentRegionName, nameof(MyContentView)); }  private IRegionManager _mainRegionManager; public IRegionManager MainRegionManager {     get { return _mainRegionManager; }     set { SetProperty(ref _mainRegionManager, value); } }  private readonly string _contentRegionName = \"dialogRegionName\"; public string ContentRegionName {     get { return _contentRegionName; } } ```  **Dialogã®å ´åˆã€Dialogã®RegionManagerã«ã€æ³¨å…¥ã•ã‚ŒãŸRegionManagerã‚’è¨­å®š**ã™ã‚‹å¿…è¦ã‚ã‚‹ã®ã§è¦æ³¨æ„ã§ã™ã€‚  ã“ã‚Œã‚‰ã®æ‰‹é †ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ã§ã€ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ç”»é¢å†…ã®ContentControlã«åˆ¥ã®Viewã‚’è¡¨ç¤ºã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚   ãŸã ã—ã€Viewã®è¡¨ç¤ºæ–¹æ³•ã‚„ViewModelã®ä½œæˆæ–¹æ³•ã¯ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦ç•°ãªã‚‹å ´åˆãŒã‚ã‚‹ãŸã‚ã€é©å®œå¤‰æ›´ã—ã¦ãã ã•ã„ã€‚"
    },
    "_id": "blog/38-dialog-display-partial-region-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/38-dialog-display-partial-region-wpf-prism-cs.mdx",
      "sourceFileName": "38-dialog-display-partial-region-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/38-dialog-display-partial-region-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/38-dialog-display-partial-region-wpf-prism-cs",
    "slugAsParams": "38-dialog-display-partial-region-wpf-prism-cs"
  },
  {
    "title": "C# | WPF Prism å‹•ç”»ï¼ˆMediaElementï¼‰ã‚’MVVMãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã™ã‚‹æ–¹æ³•",
    "description": "WPF Prism ã®å‹•ç”»å†ç”Ÿï¼ˆMediaElement.Play()ï¼‰ã‚’ã€MVVM ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã™ã‚‹æ–¹æ³•",
    "date": "2023-03-19T00:00:00.000Z",
    "emoji": "ğŸ¡",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " WPF Prism ã®å‹•ç”»å†ç”Ÿï¼ˆMediaElement.Play()ï¼‰ã‚’ã€MVVM ãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚  ### IMediaService ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹  1. IMediaService ã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ã‚¤ã‚¹ã‚’å°å…¥ã—ã¾ã™ã€‚  ```cs public Interface IMediaService {     void Play();     void Pause();     void Stop();     void Rewind();     void FastForward();     bool IsPlaying(); } ```  ### View ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰  2. ãƒ“ãƒ¥ãƒ¼ã« IMediaService ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  ```cs public partial class DemoView : UserControl, IMediaService {     public DemoView()     {         InitializeComponent();     }      void IMediaService.FastForward()     {         this.MediaPlayer.Position += TimeSpan.FromSeconds(10);     }      void IMediaService.Pause()     {         this.MediaPlayer.Pause();     }      void IMediaService.Play()     {         this.MediaPlayer.Play();     }      void IMediaService.Rewind()     {         this.MediaPlayer.Position -= TimeSpan.FromSeconds(10);     }      void IMediaService.Stop()     {         this.MediaPlayer.Stop();     }      bool IMediaService.IsPlaying()     {         // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°å®Œäº†æ™‚ã¯true         return this.MediaPlayer.Position < this.MediaPlayer.NaturalDuration;     } } ```  ### View Xaml  3. æ¬¡ã«ã€DemoView.XAML ã«ã„ãã¤ã‹ã®ã‚³ãƒ¼ãƒ‰ã‚’åŠ ãˆã¾ã™ã€‚  - MediaElement ã«åå‰ã‚’ä»˜ã‘ã¦ã€ã‚³ãƒ¼ãƒ‰ ãƒ“ãƒã‚¤ãƒ³ãƒ‰ãŒä¸Šè¨˜ã®ã‚ˆã†ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚      `<MediaElement Source=\"{Binding CurrentMedia}\" x:Name=\"MediaPlayer\"/>`  - ãƒ“ãƒ¥ãƒ¼ã«åå‰ã‚’ä»˜ã‘ã¦ã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ã¨ã—ã¦æ¸¡ã™ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ - ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªåå‰ç©ºé–“ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ãŠãã¾ã™ã€‚ï¼ˆä»–ã«ã‚‚å¿…è¦ãªåå‰ç©ºé–“ã¯çœç•¥ï¼‰  ```xml    <UserControl x:Class=\"Test.DemoView\"      xmlns:x=\"http://schemas.microsoft.com/winfx/2006/xaml\"      xmlns:i=\"http://schemas.microsoft.com/expression/2010/interactivity\"      x:Name=\"MediaService\"> ```  - ãƒˆãƒªã‚¬ãƒ¼ã‚’ä»‹ã—ã¦ Loaded ã‚¤ãƒ™ãƒ³ãƒˆã‚’æ¥ç¶šã—ã€ã‚³ãƒãƒ³ãƒ‰ã‚’ä»‹ã—ã¦ãƒ“ãƒ¥ãƒ¼è‡ªä½“ï¼ˆx:Name=MediaServiceï¼‰ã‚’ãƒ“ãƒ¥ãƒ¼ ãƒ¢ãƒ‡ãƒ«ã«æ¸¡ã—ã¾ã™ã€‚  ```xml    <i:Interaction.Triggers>          <i:EventTrigger EventName=\"Loaded\">              <i:InvokeCommandAction Command=\"{Binding MediaServiceLoaded}\" CommandParameter=\"{Binding ElementName=MediaService}\"></i:InvokeCommandAction>          </i:EventTrigger>      </i:Interaction.Triggers> ``` - MediaElement ã‚’æ“ä½œã™ã‚‹ãƒœã‚¿ãƒ³ï¼ˆã‚³ãƒãƒ³ãƒ‰ï¼‰ã‚’æº–å‚™ã—ã¦ãŠãã¾ã™ã€‚ ```xml    <Button Command=\"{Binding MoviePlayButton}\" Content=\"Play\"></Button>     <Button Command=\"{Binding MovieStopButton}\" Content=\"Stop\"></Button>  ```  ### ViewModel  4. ViewModel ã§ MediaElement ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã›ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚  ```cs public class DemoViewModel : BindableBase {     public DemoViewModel()     {         MediaServiceLoaded = new DelegateCommand<IMediaService>(MediaServiceLoadedExecute);         MoviePlayButton = new DelegateCommand(MoviePlayButtonExecute);          // ...     }      public IMediaService MediaService {get; private set;}      public DelegateCommand<IMediaService> MediaServiceLoaded { get; }     private void MediaServiceLoadedExecute(IMediaService mediaService)     {         this.MediaService = mediaService;     }      public DelegateCommand MoviePlayButton { get; }     private void MoviePlayButtonExecute()     {         if (MediaService == null)         {             return;         }          MediaService.Play();     }      // ... } ```  ã“ã‚Œã‚‰ã®æ‰‹é †ã«å¾“ã†ã“ã¨ã§ã€ViewModelå†…ã§MediaElementã‚’å†ç”ŸãŠã‚ˆã³åœæ­¢ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚   å°‘ã€…ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€MVVMãƒ‘ã‚¿ãƒ¼ãƒ³ã¯å®ˆã‚‰ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã«ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚"
    },
    "_id": "blog/39-mvvm-media-element-wpf-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/39-mvvm-media-element-wpf-prism-cs.mdx",
      "sourceFileName": "39-mvvm-media-element-wpf-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/39-mvvm-media-element-wpf-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/39-mvvm-media-element-wpf-prism-cs",
    "slugAsParams": "39-mvvm-media-element-wpf-prism-cs"
  },
  {
    "title": "Scrolling the code embedded in a post of the WordPress Hestia theme horizontally.",
    "description": "This is an article for those using the WordPress theme \"Hestia. \"When embedding source code on a post page, is there a concern that it might wrap and become hard to read?",
    "date": "2020-02-26T00:00:00.000Z",
    "emoji": "ğŸµ",
    "tags": ["wordpress", "css"],
    "published": true,
    "body": {
      "raw": " This is an article for those using the WordPress theme \"Hestia.\"  When embedding source code on a post page, is there a concern that it might wrap and become hard to read?  This time, we will explain a solution using additional CSS.  Added on 3/22/2020: It has been discovered that by \"â‘  selecting the (source code) block\" and then choosing \"â‘¡ change block type to Preformatted, \" you can achieve scrollability. This feature is sufficient.  ![image](/blog/4/seikeizumi.png)  ## Making Source Code Display on the Web More Readable  If you have lengthy code samples displayed horizontally like the one below, they might automatically wrap and become difficult to read.  ```py def __line(self, message):     if len(self.line_notify_token) > 0:         requests.post('https://notify-api.line.me/api/notify', headers={'Authorization': 'Bearer ' + self.line_notify_token}, data={'message': '\\n' + message}) ```  ## Additional CSS Setup  Now, let's set up additional CSS to achieve horizontal scrolling for the source code. First, navigate to the Customizer of WordPress and go to the edit screen for additional CSS.  ![image](/blog/4/main.png)  Next, enter the following code:  ![image](/blog/4/add_css.png)  ```css pre.scrollable-code {     overflow-x: auto;     margin-bottom: 1em;     white-space: pre;     max-width: 770px;     word-wrap: normal; } ```  ## Editing Code in the Post Editor  To apply the additional CSS, edit the code directly in the post editor. On the post editing screen, switch to the \"Code Editor\" view.  ![image](/blog/4/code_editer. PNG)  Since it will display HTML, look for the block where you embedded the source code.   It's the part enclosed in `<pre class=\"wp-block-code\"><code>...</code></pre>`.  ```html <!-- wp:code --> <pre class=\"wp-block-code\"><code>    def __line(self, message):         if len(self.line_notify_token) > 0:             requests.post('https://notify-api.line.me/api/notify', headers={'Authorization': 'Bearer ' + self.line_notify_token}, data={'message': '\\n' + message}) </code></pre> <!-- /wp:code --> ```  For the above code, do the following two things: 1. Change the `pre class` from \"wp-block-code\" to \"scrollable-code\". 2. Remove the ``<wp:code></wp:code>`` tags.  It should look like the code below:  ```html <!-- wp:code --> <pre class=\"scrollable-code\">    def __line(self, message):     if len(self.line_notify_token) > 0:         requests.post('https://notify-api.line.me/api/notify', headers={'Authorization': 'Bearer ' + self.line_notify_token}, data={'message': '\\n' + message}) </pre> <!-- /wp:code --> ```  Here is the completed code sample with horizontal scrolling support:  ![image](/blog/4/sample.png)  That's all. "
    },
    "_id": "blog/4-scroll-code-wordpress-hestia.mdx",
    "_raw": {
      "sourceFilePath": "blog/4-scroll-code-wordpress-hestia.mdx",
      "sourceFileName": "4-scroll-code-wordpress-hestia.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/4-scroll-code-wordpress-hestia"
    },
    "type": "Post",
    "slug": "/blog/4-scroll-code-wordpress-hestia",
    "slugAsParams": "4-scroll-code-wordpress-hestia"
  },
  {
    "title": "C# | Xamarin Prism Androidç«¯æœ«ã§ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Š",
    "description": "Xamarin Prism ã«ã‚ˆã‚Šã€Androidç«¯æœ«ã§ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆQRã‚³ãƒ¼ãƒ‰ï¼‰èª­ã¿è¾¼ã¿ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•",
    "date": "2023-03-29T00:00:00.000Z",
    "emoji": "ğŸ·",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " Xamarin Prism ã«ã‚ˆã‚Šã€Androidç«¯æœ«ã§ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ï¼ˆQRã‚³ãƒ¼ãƒ‰ï¼‰èª­ã¿è¾¼ã¿ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚     ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šç”¨ã®ç”»é¢ã§èª­ã¿å–ã‚ŠãŒå®Œäº†ã—ãŸå¾Œã€èª­ã¿å–ã‚Šã—ãŸãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’å‰ã®ç”»é¢ã«è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚  Xamarin Prismã§ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ã‚’å®Ÿè£…ã™ã‚‹ã«ã¯ã€ZXingãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚   ä»¥ä¸‹ã¯ã€ZXingã‚’ä½¿ç”¨ã—ãŸãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ã®å®Ÿè£…ä¾‹ã§ã™ã€‚    ## å®Ÿè£…æ‰‹é †  ### 1. NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ã¾ãšã€ZXingã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚   NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚    - ZXing.Net.Mobile - ZXing.Net.Mobile.Forms  ### 2. Androidã®MainActivity.csã«ã‚³ãƒ¼ãƒ‰è¿½åŠ   æ¬¡ã«Androidã®MainActivity.csã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚  â–¼MainActivity.cs  ```cs [Activity(Theme = \"@style/MainTheme\",             ConfigurationChanges = ConfigChanges.ScreenSize | ConfigChanges.Orientation | ConfigChanges.UiMode | ConfigChanges.ScreenLayout | ConfigChanges.SmallestScreenSize)] public class MainActivity : global::Xamarin.Forms.Platform.Android.FormsAppCompatActivity {     protected override void OnCreate(Bundle savedInstanceState)     {         base.OnCreate(savedInstanceState);          //// QRã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ç”¨ã«è¿½åŠ  ã“ã“ã‹ã‚‰         ZXing.Net.Mobile.Forms.Android.Platform.Init();         //// QRã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ç”¨ã«è¿½åŠ  ã“ã“ã¾ã§          global::Xamarin.Forms.Forms.Init(this, savedInstanceState);          LoadApplication(new App(new AndroidInitializer()));     }      public override void OnRequestPermissionsResult(int requestCode, string[] permissions, Android.Content.PM.Permission[] grantResults)     {         //// QRã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ç”¨ã«è¿½åŠ  ã“ã“ã‹ã‚‰         global::ZXing.Net.Mobile.Android.PermissionsHandler.OnRequestPermissionsResult(requestCode, permissions, grantResults);         //// QRã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ç”¨ã«è¿½åŠ  ã“ã“ã¾ã§          base.OnRequestPermissionsResult(requestCode, permissions, grantResults);     } }  public class AndroidInitializer : IPlatformInitializer {     public void RegisterTypes(IContainerRegistry containerRegistry)     {         // Register any platform specific implementations     } } ```  ### 3. Androidã®AndroidManifest.xmlã«ã‚³ãƒ¼ãƒ‰è¿½åŠ   æ¬¡ã«Androidã®AndroidManifest.xmlã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚   AndroidManifest.xmlã¯ã€Visual Studio ã§ã‚ã‚Œã°ã€Propertiesã®ç›´ä¸‹ã«å­˜åœ¨ã—ã¾ã™ã€‚    â–¼AndroidManifest.xml ```xml <?xml version=\"1.0\" encoding=\"utf-8\"?> <manifest xmlns:android=\"http://schemas.android.com/apk/res/android\" android:versionCode=\"1\" android:versionName=\"1.0\" package=\"com.companyname.appname\"> \t<uses-sdk android:minSdkVersion=\"21\" android:targetSdkVersion=\"29\" />  \t<!-- ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ã«å¿…è¦ ã“ã“ã‹ã‚‰ --> \t<uses-permission android:name = \"android.permission.CAMERA\" /> \t<uses-permission android:name = \"android.permission.FLASHLIGHT\" /> \t<!-- ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿ã«å¿…è¦ ã“ã“ã¾ã§ -->  \t<application android:label=\"@string/app_name\" android:icon=\"@mipmap/icon\"> \t</application> </manifest> ```  ### 4. ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šç”»é¢ã‚’å®Ÿè£…  ä»Šå›ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ã€2ã¤ã®ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚  â– MainPage   - ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šã™ã‚‹ãƒšãƒ¼ã‚¸ï¼ˆScannerViewï¼‰ã«ç§»å‹• - ScannerViewãƒšãƒ¼ã‚¸ã§èª­ã¿å–ã£ãŸãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’ç”»é¢ã«è¡¨ç¤º  â– ScannerView   - ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šå¾Œã€èª­ã¿å–ã£ãŸãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’MainPageã«è¿”ã™  ã¾ãšã¯MainPageã®å®Ÿè£…ã§ã™ã€‚  â–¼MainPage.xml ```xml <?xml version=\"1.0\" encoding=\"utf-8\" ?> <ContentPage     x:Class=\"Template.Views.MainPage\"     xmlns=\"http://xamarin.com/schemas/2014/forms\"     xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"     xmlns:prism=\"http://prismlibrary.com\"     prism:ViewModelLocator.AutowireViewModel=\"True\">      <Grid>         <StackLayout>             <Button Command=\"{Binding ScannerViewButton}\" Text=\"ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿é–‹å§‹\" />              <StackLayout Orientation=\"Horizontal\">                 <Label Text=\"ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿è¾¼ã¿çµæœ: \" />                 <Label Text=\"{Binding ScannedResultLabel}\" />             </StackLayout>         </StackLayout>     </Grid> </ContentPage> ```  â–¼MainPageViewModel.cs ```cs using Prism.Commands; using Prism.Navigation; using Prism.Services; using Template.Views;  namespace Template.ViewModels {     /// <summary>     /// QRã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿     /// </summary>     public class MainPageViewModel : ViewModelBase \t{         public Page003ViewModel(             INavigationService navigationService)             : base(navigationService)         {             ScannerViewButton = new DelegateCommand(ScannerViewButtonExecute);         }          public override void OnNavigatedTo(INavigationParameters parameters)         {             //// ScannerViewï¼ˆãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šç”»é¢ï¼‰ã§å–å¾—ã—ãŸãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’å–å¾—             var scannedResult = parameters[nameof(ScannerViewModel.ScannedResult)] as string;             if (scannedResult == null)             {                 ScannedResultLabel = string.Empty;             }              //// ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã®å€¤ã‚’ç”»é¢ã®ãƒ©ãƒ™ãƒ«ã«åæ˜              ScannedResultLabel = scannedResult;         }          private string _scannedResultLabel = string.Empty;         public string ScannedResultLabel         {             get { return _scannedResultLabel; }             set { SetProperty(ref _scannedResultLabel, value); }         }          public DelegateCommand ScannerViewButton { get; }          private void ScannerViewButtonExecute()         {             //// ScannerViewï¼ˆãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šç”»é¢ï¼‰ã«é·ç§»             base.NavigationService.NavigateAsync(nameof(ScannerView));         }     } } ```  æ¬¡ã«ã€ScannerViewã®å®Ÿè£…ã§ã™ã€‚  â–¼ScannerView.xaml ```xml <?xml version=\"1.0\" encoding=\"utf-8\" ?> <zxing:ZXingScannerPage     x:Class=\"Template.Views.ScannerView\"     xmlns=\"http://xamarin.com/schemas/2014/forms\"     xmlns:x=\"http://schemas.microsoft.com/winfx/2009/xaml\"     xmlns:behaviors=\"clr-namespace:Prism.Behaviors;assembly=Prism.Forms\"     xmlns:zxing=\"clr-namespace:ZXing.Net.Mobile.Forms;assembly=ZXing.Net.Mobile.Forms\">      <zxing:ZXingScannerPage.Behaviors>         <behaviors:EventToCommandBehavior             Command=\"{Binding ScanResultCommand}\"             EventArgsParameterPath=\"Result\"             EventName=\"ScanFinished\" />     </zxing:ZXingScannerPage.Behaviors> </zxing:ZXingScannerPage> ```  â–¼ScannerView.xaml.cs ```cs using System; using Template.ExtendedEventArgs; using ZXing.Net.Mobile.Forms;  namespace Template.Views {     public partial class ScannerView : ZXingScannerPage     {         public ScannerView()         {             InitializeComponent();              DefaultOverlayTopText = \"ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿å–ã‚Šã¾ã™\";             DefaultOverlayBottomText = \"\";              this.OnScanResult += (result) =>             {                 this.ScanFinished?.Invoke(this, new ScanFinishedEventArgs(result));                 this.IsScanning = false;             };         }          //// ScanFinishedEventArgs ã¯åˆ¥ã‚¯ãƒ©ã‚¹ã§å®Ÿè£…ãŒå¿…è¦         public event EventHandler<ScanFinishedEventArgs> ScanFinished;     } } ```  ScanFinishedEventArgs ã¯ã€Viewï¼ˆxamlï¼‰ã«å®Ÿè£…ã—ã¦ã„ã‚‹EventToCommandBehaviorã§ã€   ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šçµ‚äº†ã‚¤ãƒ™ãƒ³ãƒˆã‚’ViewModelã¸ãƒã‚¤ãƒ³ãƒ‰ã™ã‚‹ãŸã‚ã«å¿…è¦ãªã‚¯ãƒ©ã‚¹ã§ã™ã€‚  ScanFinishedEventArgs ã‚’å®Ÿè£…ã—ã¾ã™ã€‚  â–¼ScanFinishedEventArgs .cs ```cs using System;  namespace Template.ExtendedEventArgs {     public class ScanFinishedEventArgs :EventArgs     {         public ScanFinishedEventArgs(ZXing.Result result)         {             Result = result;         }          public ZXing.Result Result { get; private set; }     } } ```  æœ€å¾Œã«ã€ViewModelã‚’å®Ÿè£…ã—ã¾ã™ã€‚  â–¼ScannerViewModel.cs ```cs using Prism.Commands; using Prism.Navigation; using Prism.Services;  namespace Template.ViewModels {     public class ScannerViewModel : ViewModelBase     {         public ScannerViewModel(             INavigationService navigationService,             IPageDialogService pageDialogService,             IDeviceService deviceService)             : base(navigationService)         {             PageDialogService = pageDialogService;             DeviceService = deviceService;              ScanResultCommand = new DelegateCommand<ZXing.Result>(ScanResultCommandExecute);         }          public IPageDialogService PageDialogService { get; private set; }         public IDeviceService DeviceService { get; private set; }          /// <summary>         /// ãƒãƒ¼ã‚³ãƒ¼ãƒ‰ã‚¹ã‚­ãƒ£ãƒ³çµæœ         /// </summary>         public string ScannedResult { get; private set; }          public DelegateCommand<ZXing.Result> ScanResultCommand { get; }          private void ScanResultCommandExecute(ZXing.Result result)         {             DeviceService.BeginInvokeOnMainThread(() =>             {                 ScannedResult = result.Text;                  var param = new NavigationParameters                 {                     {nameof(ScannedResult), ScannedResult }                 };                  NavigationService.GoBackAsync(param);                 PageDialogService.DisplayAlertAsync(\"ã‚¹ã‚­ãƒ£ãƒ³å®Œäº†\", ScannedResult, \"OK\");             });         }     } } ```  ã“ã‚Œã‚‰ã®æ‰‹é †ã§ã€ãƒãƒ¼ã‚³ãƒ¼ãƒ‰èª­ã¿å–ã‚Šã—ãŸå€¤ã‚’å‰ã®ãƒšãƒ¼ã‚¸ã«æˆ»ã—ã¦è¡¨ç¤ºã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚   ScannerViewã¯ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ãŒã€ä»–ã¯MVVMãƒ‘ã‚¿ãƒ¼ãƒ³ã«ãªã£ã¦ã„ã‚‹ã¨æ€ã„ã¾ã™ã€‚    ## å‚è€ƒãƒªãƒ³ã‚¯  ã€Xamarin.Formsã€‘QRã‚³ãƒ¼ãƒ‰ã®èª­ã¿å–ã‚Šã‚’ã™ã‚‹æ–¹æ³•   [https://takataka430.hatenablog.com/entry/2019/03/21/184259](https://takataka430.hatenablog.com/entry/2019/03/21/184259)  ã€Xamarin 002ã€‘QRã‚³ãƒ¼ãƒ‰ãƒ©ã‚¤ãƒ–ãƒ©ãƒª Zxing.Net.Mobile.Forms ã‚’ Prism ã£ã½ãä½¿ã£ã¦ã¿ãŸ   [https://johnny06r.hatenablog.com/entry/2018/08/29/012710](https://johnny06r.hatenablog.com/entry/2018/08/29/012710) "
    },
    "_id": "blog/40-android-barcode-scanner-xamarin-prism-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/40-android-barcode-scanner-xamarin-prism-cs.mdx",
      "sourceFileName": "40-android-barcode-scanner-xamarin-prism-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/40-android-barcode-scanner-xamarin-prism-cs"
    },
    "type": "Post",
    "slug": "/blog/40-android-barcode-scanner-xamarin-prism-cs",
    "slugAsParams": "40-android-barcode-scanner-xamarin-prism-cs"
  },
  {
    "title": "C# | Xamarin Androidç«¯æœ«ã®Xamarin.Essentialså®Ÿè£…æ–¹æ³•ï¼ˆconfig.xmlã®ä»£æ›¿ï¼‰",
    "description": "Xamarin.Essentialsã‚’ä½¿ç”¨ã—ãŸAndroidç«¯æœ«ã®è¨­å®šãƒ‡ãƒ¼ã‚¿èª­ã¿æ›¸ãã®å®Ÿè£…ä¾‹",
    "date": "2023-03-29T00:00:00.000Z",
    "emoji": "ğŸ•",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " Xamarinã§ã¯ã€è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹Configãƒ•ã‚¡ã‚¤ãƒ«ã‚’å–ã‚Šæ‰±ãˆã¾ã›ã‚“ã€‚   ä»£ã‚ã‚Šã«Xamarin.Essentialsã‚’åˆ©ç”¨ã™ã‚Œã°ã€å¾“æ¥ã®config.xmlãƒ•ã‚¡ã‚¤ãƒ«åŒæ§˜ã«è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’æ®‹ã™äº‹ãŒã§ãã¾ã™ã€‚    ä»¥ä¸‹ã¯ã€Xamarin.Essentialsã‚’ä½¿ç”¨ã—ãŸAndroidç«¯æœ«ã®è¨­å®šãƒ‡ãƒ¼ã‚¿èª­ã¿æ›¸ãã®å®Ÿè£…ä¾‹ã§ã™ã€‚  ## å®Ÿè£…æ‰‹é †  ### 1. NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ã¾ãšã€Xamarin.Essentialsã‚’ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è¿½åŠ ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚   NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚    - Xamarin.Essentials  ### 2. Androidã®MainActivity.csã«ã‚³ãƒ¼ãƒ‰è¿½åŠ   æ¬¡ã«Androidã®MainActivity.csã«ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚  â–¼MainActivity.cs  ```cs [Activity(Theme = \"@style/MainTheme\",             ConfigurationChanges = ConfigChanges.ScreenSize | ConfigChanges.Orientation | ConfigChanges.UiMode | ConfigChanges.ScreenLayout | ConfigChanges.SmallestScreenSize)] public class MainActivity : global::Xamarin.Forms.Platform.Android.FormsAppCompatActivity {     protected override void OnCreate(Bundle savedInstanceState)     {         base.OnCreate(savedInstanceState);          //// Xamarin.Essentialsç”¨ã«è¿½åŠ  ã“ã“ã‹ã‚‰         Xamarin.Essentials.Platform.Init(this, savedInstanceState);         //// Xamarin.Essentialsç”¨ã«è¿½åŠ  ã“ã“ã¾ã§          global::Xamarin.Forms.Forms.Init(this, savedInstanceState);          LoadApplication(new App(new AndroidInitializer()));     }      public override void OnRequestPermissionsResult(int requestCode, string[] permissions, Android.Content.PM.Permission[] grantResults)     {         //// Xamarin.Essentialsç”¨ã«è¿½åŠ  ã“ã“ã‹ã‚‰         Xamarin.Essentials.Platform.OnRequestPermissionsResult(requestCode, permissions, grantResults);         //// Xamarin.Essentialsç”¨ã«è¿½åŠ  ã“ã“ã¾ã§          base.OnRequestPermissionsResult(requestCode, permissions, grantResults);     } }  public class AndroidInitializer : IPlatformInitializer {     public void RegisterTypes(IContainerRegistry containerRegistry)     {         // Register any platform specific implementations     } } ```  ### 3. è¨­å®šãƒ‡ãƒ¼ã‚¿ä¿å­˜ç”¨ã®ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…  è¨­å®šãƒ‡ãƒ¼ã‚¿ã¯1ã¤ã®ã‚¯ãƒ©ã‚¹ã«ã¾ã¨ã‚ãŸæ–¹ãŒå–ã‚Šæ‰±ã„æ˜“ã„ãŸã‚ã€å°‚ç”¨ã®ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚  ä¾‹ãˆã°ã€Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹ãŸã‚ã®æƒ…å ±ã‚’èª­ã¿æ›¸ãã—ãŸã„å ´åˆã®ä¾‹ã§ã™ã€‚   ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ã«ã—ãŸã„ãŸã‚ã€static ã§ã‚¯ãƒ©ã‚¹ã¨ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚    â–¼Shared.cs ```cs using Xamarin.Essentials;  namespace Template.Domain {     public static class Shared     {         public static string OracleUser         {             get => Preferences.Get(nameof(OracleUser), \"atman\");             set => Preferences.Set(nameof(OracleUser), value);         }          public static string OraclePassword         {             get => Preferences.Get(nameof(OraclePassword), \"atman\");             set => Preferences.Set(nameof(OraclePassword), value);         }          public static string OracleHost         {             get => Preferences.Get(nameof(OracleHost), \"192.168.3.16\");             set => Preferences.Set(nameof(OracleHost), value);         }          public static string OracleServiceName         {             get => Preferences.Get(nameof(OracleServiceName), \"XEPDB1\");             set => Preferences.Set(nameof(OracleServiceName), value);         }          public static string OracleDataSource         {             get => $\"(DESCRIPTION = (ADDRESS = (PROTOCOL = TCP)(HOST = {OracleHost})(PORT = 1521))(CONNECT_DATA = (SERVER = DEDICATED)(SERVICE_NAME = {OracleServiceName})))\";         }     } }  ```  ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã¯ã€Preferences.Get ã«è¨­å®šã•ã‚ŒãŸå€¤ã«ãªã‚Šã¾ã™ã€‚   ä¾‹ã®OracleUserãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ã‚ã‚Œã°ã€atman ã§ã™ã€‚   `get => Preferences.Get(nameof(OracleUser), \"atman\");`  æœ€å¾Œã«ã€ã‚µãƒ³ãƒ—ãƒ«ã®Shared.csã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã‚’èª­ã¿æ›¸ãã™ã‚‹å ´åˆã¯ã€ä»¥ä¸‹ã®ã‚ˆã†ã«è¨˜è¼‰ã—ã¾ã™ã€‚    ```cs //// è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’æ›¸ãè¾¼ã¿ Shared.OracleUser = æ–°è¦ã®å€¤; Shared.OraclePassword = æ–°è¦ã®å€¤;  //// è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ var host = Shared.OracleHost; var serviceName = Shared.OracleServiceName; ```  ã“ã‚Œã‚‰ã®æ‰‹é †ã§ã€Androidç«¯æœ«ã®è¨­å®šãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿æ›¸ãã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚"
    },
    "_id": "blog/41-xamarin-essentials-shared-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/41-xamarin-essentials-shared-cs.mdx",
      "sourceFileName": "41-xamarin-essentials-shared-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/41-xamarin-essentials-shared-cs"
    },
    "type": "Post",
    "slug": "/blog/41-xamarin-essentials-shared-cs",
    "slugAsParams": "41-xamarin-essentials-shared-cs"
  },
  {
    "title": "C# | Xamarin Androidç«¯æœ«ã‹ã‚‰ç›´æ¥OracleDBã«æ¥ç¶šã™ã‚‹æ–¹æ³•",
    "description": "Xamarinã§Androidç«¯æœ«ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹å®Ÿè£…ä¾‹",
    "date": "2023-03-29T00:00:00.000Z",
    "emoji": "ğŸœ",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " C# Xamarinã§ã¯ã€Oracle.ManagedDataAccess.Coreã‚’åˆ©ç”¨ã™ã‚Œã°ã€Androidç«¯æœ«ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  æœ¬æ¥ã€Oracleç­‰ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«Androidç«¯æœ«ã‹ã‚‰æ¥ç¶šã™ã‚‹å ´åˆã¯ã€WebAPIçµŒç”±ãŒæ¨å¥¨ã•ã‚Œã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚   ã—ã‹ã—ã€ç¤¾å†…ç­‰ã®ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã§å°è¦æ¨¡ã§ã‚ã‚Œã°ã€ç›´æ¥DBã«æ¥ç¶šã™ã‚‹æ–¹æ³•ã‚‚ä¸€ã¤ã®æ‰‹æ®µã¨ãªã‚Šã¾ã™ã€‚    ä»¥ä¸‹ã¯ã€Xamarinã§Androidç«¯æœ«ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã™ã‚‹å®Ÿè£…ä¾‹ã§ã™ã€‚   ï¼ˆiOSã‚‚åŒæ§˜ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€æœªç¢ºèªã§ã™ã€‚ï¼‰   ## å®Ÿè£…æ‰‹é †  ### 1. NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ã¾ãšã€NuGetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã§Oracle.ManagedDataAccess.Coreãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚   ã“ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã€Oracle Databaseã«é«˜é€Ÿã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ADO.NETãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã§ã™ã€‚   Oracle Clientã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯ä¸è¦ã§ã™ã€‚    - Oracle.ManagedDataAccess.Core  ### 2. Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¸ã®æ¥ç¶šä¾‹  ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã¯ã€Oracle Databaseã«æ¥ç¶šã—ã¦ã€EMPãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å¾“æ¥­å“¡ã®åå‰ã¨çµ¦ä¸ã‚’å–å¾—ã™ã‚‹ã‚‚ã®ã§ã™ã€‚   ç°¡å˜ã«è©¦ã™å ´åˆã¯ã€Xamarinã§ã¯Viewã®ã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ï¼ˆPrismã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€ViewModelï¼‰ã«è¨˜è¼‰ã™ã‚Œã°ã‚ˆã„ã§ã™ã€‚    ```cs using System; using System.Diagnostics; using Oracle.ManagedDataAccess.Client;  namespace Template.Views {     public partial class MainPage     {         public MainPage()         {             InitializeComponent();              // æ¥ç¶šæ–‡å­—åˆ—ã‚’è¨­å®šã—ã¾ã™ã€‚             string user = \"atman\";             string password = \"atman\";             string dataSource = \"(DESCRIPTION =(ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.3.16)(PORT = 1521))(CONNECT_DATA =(SERVER = DEDICATED)(SERVICE_NAME = XEPDB1)))\";             string connectionString = \"User Id=\" + user + \";Password=\" + password + \";Data Source=\" + dataSource;              // OracleConnectionã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚             using (OracleConnection connection = new OracleConnection(connectionString))             {                 // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã¾ã™ã€‚                 connection.Open();                  // SQLæ–‡ã‚’è¨­å®šã—ã¾ã™ã€‚                 string sql = \"SELECT ename, sal FROM emp\";                  // OracleCommandã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚                 using (OracleCommand command = new OracleCommand(sql, connection))                 {                     // OracleDataReaderã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’å–å¾—ã—ã¾ã™ã€‚                     using (OracleDataReader reader = command.ExecuteReader())                     {                         // ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã™ã€‚                         while (reader.Read())                         {                             // åå‰ã¨çµ¦ä¸ã‚’å–å¾—ã—ã¾ã™ã€‚                             string name = reader.GetString(0);                             decimal salary = reader.GetDecimal(1);                              // çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚                             Debug.WriteLine($\"{name} : {salary}\");                         }                     }                 }                  // ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®æ¥ç¶šã‚’åˆ‡æ–­ã—ã¾ã™ã€‚                 connection.Close();             }         }     } } ```  Oracleã®æ¥ç¶šæ–‡å­—åˆ—ã¯ã€æ¥ç¶šå¯¾è±¡ã®Oracleã‚µãƒ¼ãƒãƒ¼ï¼ˆAndroidç«¯æœ«ãŒWifiæ¥ç¶šã—ã¦ã„ã‚‹ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å†…ã«å­˜åœ¨ã™ã‚‹DBã‚µãƒ¼ãƒãƒ¼ï¼‰ã«åˆã‚ã›ã¦å¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  > Oracleæ¥ç¶šã®è¨­å®šãŒæ­£ã—ã„ã®ã«ã‚‚é–¢ã‚ã‚‰ãšæ¥ç¶šä¸å¯ã®å ´åˆã€Oracleã‚µãƒ¼ãƒãƒ¼ï¼ˆPCï¼‰ã®ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«è¨­å®šã§ã€**å—ä¿¡ã®è¦å‰‡ã‹ã‚‰ãƒãƒ¼ãƒˆ1521ã‚’è§£æ”¾**ã—ã¦ã„ãªã„å¯èƒ½æ€§ã‚‚è€ƒãˆã‚‰ã‚Œã¾ã™ã€‚ç¢ºèªã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚  ã“ã‚Œã‚‰ã®æ‰‹é †ã§ã€Androidç«¯æœ«ã‹ã‚‰Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ç›´æ¥æ¥ç¶šã™ã‚‹äº‹ãŒã§ãã¾ã™ã€‚"
    },
    "_id": "blog/42-connect-oracle-xamarin-cs.mdx",
    "_raw": {
      "sourceFilePath": "blog/42-connect-oracle-xamarin-cs.mdx",
      "sourceFileName": "42-connect-oracle-xamarin-cs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/42-connect-oracle-xamarin-cs"
    },
    "type": "Post",
    "slug": "/blog/42-connect-oracle-xamarin-cs",
    "slugAsParams": "42-connect-oracle-xamarin-cs"
  },
  {
    "title": "Nx NestJSã‚’VSCodeã‹ã‚‰ãƒ‡ãƒãƒƒã‚°ã™ã‚‹è¨­å®š",
    "description": "Nx NestJS ã‚’VSCodeã‹ã‚‰ãƒ‡ãƒãƒƒã‚°ã™ã‚‹è¨­å®šã™ã‚‹æ–¹æ³•ã§ã™ã€‚èµ·å‹•ä¸­ã®NestJSã«å¯¾ã—ã¦ã€ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§ãƒ‡ãƒãƒƒã‚°ã—ã¾ã™ã€‚",
    "date": "2023-05-28T00:00:00.000Z",
    "emoji": "ğŸ",
    "tags": ["nx", "nestjs", "vscode"],
    "published": true,
    "body": {
      "raw": " Nx NestJSã‚’VSCodeã‹ã‚‰ãƒ‡ãƒãƒƒã‚°ã™ã‚‹è¨­å®šã™ã‚‹æ–¹æ³•ã§ã™ã€‚   èµ·å‹•ä¸­ã®NestJSã«å¯¾ã—ã¦ã€ã‚¢ã‚¿ãƒƒãƒãƒ¢ãƒ¼ãƒ‰ã§ãƒ‡ãƒãƒƒã‚°ã—ã¾ã™ã€‚  ### 1. launch.json ã‚’ä½œæˆ  VSCodeã®å®Ÿè¡Œã¨ãƒ‡ãƒãƒƒã‚°ã€€ï¼ã€€æ­¯è»Šãƒœã‚¿ãƒ³ ã‹ã‚‰ `launch.json`ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ  ```json {   \"version\": \"0.2.0\",   \"configurations\": [     {       \"type\": \"node\",       \"request\": \"attach\",       \"name\": \"Attach NestJS WS\",       \"restart\": true,       \"sourceMaps\": true,       \"cwd\": \"${workspaceFolder}/server\"     }   ] } ```  > `\"cwd\": \"${workspaceFolder}/server\"`ã®`server`ã¯ã€   > Nxã§ä½œæˆã—ãŸNestJSã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåï¼ˆãƒ•ã‚©ãƒ«ãƒ€åï¼‰ã®ãŸã‚é©å®œå¤‰æ›´ã—ã¦ä¸‹ã•ã„ã€‚  ### 2. NestJSãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èµ·å‹•  VSCodeã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã€ä¸‹è¨˜ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œ  ```shell nx serve server ```  ### 3. ãƒ‡ãƒãƒƒã‚°ã‚’èµ·å‹•  VSCodeã®å®Ÿè¡Œã¨ãƒ‡ãƒãƒƒã‚°ã€€ï¼ã€€ãƒ‡ãƒãƒƒã‚°ã®é–‹å§‹  ![img](/blog/43/1.png)"
    },
    "_id": "blog/43-nx-nestjs-debug.mdx",
    "_raw": {
      "sourceFilePath": "blog/43-nx-nestjs-debug.mdx",
      "sourceFileName": "43-nx-nestjs-debug.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/43-nx-nestjs-debug"
    },
    "type": "Post",
    "slug": "/blog/43-nx-nestjs-debug",
    "slugAsParams": "43-nx-nestjs-debug"
  },
  {
    "title": "Angularã§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹æ–¹æ³•",
    "description": "Angular ã§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€ngbDropdownã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ngbDropdownã¯Angular Bootstrapã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚ngbDropdownã‚’ä½¿ã†æ–¹æ³•ã®åŸºæœ¬çš„ãªæ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚",
    "date": "2023-06-03T00:00:00.000Z",
    "emoji": "ğŸ†",
    "tags": ["angular"],
    "published": true,
    "body": {
      "raw": " Angular ã§ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã¯ã€ngbDropdownã‚’åˆ©ç”¨ã—ã¾ã™ã€‚   ngbDropdownã¯Angular Bootstrapã®ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã™ã€‚   ä»¥ä¸‹ã«ngbDropdownã‚’ä½¿ã†æ–¹æ³•ã®åŸºæœ¬çš„ãªæ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚    ![img](/blog/44/1.png)  ## 1. Angular Bootstrapã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ Angular Bootstrapã¯ã€Bootstrapã®JavaScriptã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’Angularã§ä½¿ç”¨ã™ã‚‹ãŸã‚ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ã€‚   æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚    ```bash npm install @ng-bootstrap/ng-bootstrap ```  ## 2. AppModuleã§å¿…è¦ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã™ã€‚ src/app/app.module.tsãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚    ```typescript import { NgbModule } from '@ng-bootstrap/ng-bootstrap';  @NgModule({   imports: [NgbModule],   // ... }) export class AppModule { } ```  ## 3. ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚ ä¾‹ãˆã°ã€app.component.htmlãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’è¿½åŠ ã—ã¾ã™ã€‚    ```html <div ngbDropdown>   <button class=\"btn btn-primary\" ngbDropdownToggle>Toggle Dropdown</button>   <div ngbDropdownMenu>     <button class=\"dropdown-item\">Action 1</button>     <button class=\"dropdown-item\">Action 2</button>     <button class=\"dropdown-item\">Action 3</button>   </div> </div> ```  ## 4. å¿…è¦ã«å¿œã˜ã¦ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ã®å‹•ä½œã‚’ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¾ã™ã€‚ ä¾‹ãˆã°ã€ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãŒé–‹ã„ãŸã¨ãã«ç‰¹å®šã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚ˆã†ã«ã—ã¾ã™ã€‚    ```html <div ngbDropdown (open)=\"onDropdownOpen()\" (close)=\"onDropdownClose()\">   <!-- ... --> </div> ```  ```typescript export class AppComponent {   onDropdownOpen() {     console.log('Dropdown opened');     // é–‹ã„ãŸã¨ãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ    }    onDropdownClose() {     console.log('Dropdown closed');     // é–‰ã˜ãŸã¨ãã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ    } } ```  ä»¥ä¸ŠãŒngbDropdownã®åŸºæœ¬çš„ãªä½¿ã„æ–¹ã§ã™ã€‚   ã“ã®ä¾‹ã§ã¯ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã€é¸æŠã—ãŸã‚¢ã‚¤ãƒ†ãƒ ã«å¿œã˜ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã§ãã¾ã™ã€‚   ã•ã‚‰ã«è©³ç´°ãªã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã¯ã€Angular Bootstrapã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚  "
    },
    "_id": "blog/44-angular-doropdown.mdx",
    "_raw": {
      "sourceFilePath": "blog/44-angular-doropdown.mdx",
      "sourceFileName": "44-angular-doropdown.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/44-angular-doropdown"
    },
    "type": "Post",
    "slug": "/blog/44-angular-doropdown",
    "slugAsParams": "44-angular-doropdown"
  },
  {
    "title": "Render.comã®ã‚¹ãƒªãƒ¼ãƒ—å¯¾ç­–ï¼ˆcron-job.orgï¼‰",
    "description": "Render.comã®Freeãƒ—ãƒ©ãƒ³ã¯éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªçŠ¶æ…‹ãŒ15åˆ†é–“ç¶šãã¨ã‚¹ãƒªãƒ¼ãƒ—çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚å¯¾ç­–ã¨ã—ã¦ã€å®šæœŸçš„ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ã‚‹ cron-job.org ã®è¨­å®šæ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚",
    "date": "2023-06-11T00:00:00.000Z",
    "emoji": "âŒš",
    "tags": ["render"],
    "published": true,
    "body": {
      "raw": " Render.comã®Freeãƒ—ãƒ©ãƒ³ã¯éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªçŠ¶æ…‹ãŒ15åˆ†é–“ç¶šãã¨ã‚¹ãƒªãƒ¼ãƒ—çŠ¶æ…‹ã«ãªã‚Šã¾ã™ã€‚    å¯¾ç­–ã¨ã—ã¦ã€å®šæœŸçš„ãªãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’é€ã‚‹[cron-job.org](https://console.cron-job.org/)ã‚’åˆ©ç”¨ã—ã¾ã™ã€‚   ãã®æ‰‹é †ã‚’æ®‹ã—ã¦ãŠãã¾ã™ã€‚  ## 1. cron-job.orgã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ  [cron-job.org](https://console.cron-job.org/)    > å‚è€ƒã‚µã‚¤ãƒˆ   > [cron-job.org ã‚’åˆ©ç”¨ã—ã¦ç‰¹å®šã®URLã«å®šæœŸçš„ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã›ã‚‹](https://laboradian.com/access-url-using-cron-job-org/)  ## 2. JOBã‚’ä½œæˆ Dashboard > CREATE CRONJOB ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¾ã™ã€‚    ![image](/blog/45/1.png)    ## 3. COMMONã‚’è¨­å®š URLã‚„ã‚¢ã‚¯ã‚»ã‚¹é »åº¦ã‚’è¨­å®šã—ã¾ã™ã€‚ã“ã“ã§ã¯10åˆ†ã«ã—ã¦ãŠãã¾ã™ã€‚ ![image](/blog/45/2.png)    å®Ÿè¡ŒãŒå¤±æ•—ã—ãŸæ™‚ã®é€šçŸ¥è¨­å®šã§ã™ã€‚ï¼ˆä»»æ„ã§OKï¼‰   ![image](/blog/45/3.png)    ## 4. ADVANCEDã‚’è¨­å®š æ¬¡ã«ã‚¿ãƒ–ã‹ã‚‰ADVANCEã«åˆ‡ã‚Šæ›¿ãˆã¦è¨­å®šã—ã¾ã™ã€‚   ![image](/blog/45/4.png)    æœ€å¾Œã«CREATEãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦çµ‚äº†ã§ã™ã€‚"
    },
    "_id": "blog/45-cron-job.mdx",
    "_raw": {
      "sourceFilePath": "blog/45-cron-job.mdx",
      "sourceFileName": "45-cron-job.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/45-cron-job"
    },
    "type": "Post",
    "slug": "/blog/45-cron-job",
    "slugAsParams": "45-cron-job"
  },
  {
    "title": "Custom Angular Material toggule button",
    "description": "Here's how you can customize the appearance of an Angular Material toggle button. Although the method is unique, I'll explain it in this article.",
    "date": "2023-07-16T00:00:00.000Z",
    "emoji": "ğŸ†",
    "tags": ["angular"],
    "published": true,
    "body": {
      "raw": " Here's how you can customize the appearance of an Angular Material toggle button. Although the method is unique, I'll explain it in this article.    ![image](/blog/46/1.png)    ## 1. How to use Angular Material button-toggle ### Install Angular Material ```bash ng add @angular/material ```  ### Import Angular Material button-toggle to Module file   ```ts import {MatButtonToggleModule} from '@angular/material/button-toggle' ```  ### Html   ```html <mat-button-toggle [aria-label]=\"alertsEnabled ? 'Disable alerts' : 'Enable alerts'\">   <mat-icon>notifications</mat-icon> </mat-button-toggle> ```  For more details, refer to the official documentation:     [Angular Material Official Documentation](https://material.angular.io/components/button-toggle)    ## 2. Modifying the Appearance of the Toggle Button The default toggle button has a square appearance. In this case, we'll make it a circular button and ensure that the outline is not displayed when clicked and focused.    ### Html ```html <mat-button-toggle mat-fab class=\"toggle-button\" aria-label=\"blog button\" #blogButton>     <span class=\"toggle-icon fas fa-blog\"></span> </mat-button-toggle> ```  ### SCSS ```css .toggle-button {     width: 60px;     height: 60px;     border-radius: 50% !important;     box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12) !important; }  .toggle-icon {     font-size: 30px; }  :host ::ng-deep .mat-button-toggle-button:focus {     outline: none; } ```  ![image](/blog/46/2.png)    Feel free to modify the SCSS according to your needs."
    },
    "_id": "blog/46-custom-angular-material-toggle-button.mdx",
    "_raw": {
      "sourceFilePath": "blog/46-custom-angular-material-toggle-button.mdx",
      "sourceFileName": "46-custom-angular-material-toggle-button.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/46-custom-angular-material-toggle-button"
    },
    "type": "Post",
    "slug": "/blog/46-custom-angular-material-toggle-button",
    "slugAsParams": "46-custom-angular-material-toggle-button"
  },
  {
    "title": "Angular prismjs example",
    "description": "Here is how to apply prismjs to your code in Angular.By following this method, you will be able to apply prismjs to HTML stored in a database and display it on an Angular page.",
    "date": "2023-07-17T00:00:00.000Z",
    "emoji": "ğŸŒº",
    "tags": ["angular"],
    "published": true,
    "body": {
      "raw": " Here is how to apply prismjs to your code in Angular.   By following this method, you will be able to apply prismjs to HTML stored in a database and display it on an Angular page.    # angular-prismjs-example  [Edit on StackBlitz âš¡ï¸](https://stackblitz.com/edit/stackblitz-starters-rnpfug)  ![image](/blog/47/1.png)    The steps are as follows:    ## 1. Install module  ```bash npm install prismjs ```  ## 2. Add services  src/services/  - prism.service.ts - html-utils.ts - safe-html.pipe.ts - shared.module.ts  ### prism.service.ts  ```ts import { isPlatformBrowser } from '@angular/common'; import { Inject, Injectable, PLATFORM_ID } from '@angular/core';  // importing prismjs order is important! import 'prismjs';  import 'prismjs/plugins/toolbar/prism-toolbar';  import 'prismjs/plugins/copy-to-clipboard/prism-copy-to-clipboard'; import 'prismjs/plugins/line-numbers/prism-line-numbers'; import 'prismjs/plugins/show-language/prism-show-language';  import 'prismjs/components/prism-csharp'; import 'prismjs/components/prism-css'; import 'prismjs/components/prism-java'; import 'prismjs/components/prism-javascript'; import 'prismjs/components/prism-json'; import 'prismjs/components/prism-markup'; import 'prismjs/components/prism-python'; import 'prismjs/components/prism-sass'; import 'prismjs/components/prism-scss'; import 'prismjs/components/prism-sql'; import 'prismjs/components/prism-typescript'; import 'prismjs/components/prism-visual-basic'; import 'prismjs/components/prism-xml-doc';  // eslint-disable-next-line @typescript-eslint/no-explicit-any declare const Prism: any;  @Injectable({   providedIn: 'root', // can inject anywahere }) export class PrismService {   constructor(@Inject(PLATFORM_ID) private platformId: object) {}    highlightAll() {     if (isPlatformBrowser(this.platformId)) {       Prism.highlightAll();     }   }    highlightHtml(html: string): string {     const div = document.createElement('div');     div.innerHTML = html;     const codeElements = div.querySelectorAll('code');     codeElements.forEach((el) => {       const lang =         el.getAttribute('class')?.replace('language-', '') || 'javascript';       el.innerHTML = Prism.highlight(         el.textContent || '',         Prism.languages[lang],         lang       );     });     return div.innerHTML;   } } ```  ### html-utils.ts  ```ts export function addClassToHtml(   html: string,   className: string,   tagName: string ): string {   const parser = new DOMParser();   const doc = parser.parseFromString(html, 'text/html');   const elements = doc.querySelectorAll(tagName);   elements.forEach((el) => {     el.classList.add(className);   });   return doc.documentElement.innerHTML; } ```  ### safe-html.pipe.ts  ```ts import { Pipe, PipeTransform } from '@angular/core'; import { DomSanitizer, SafeHtml } from '@angular/platform-browser';  /** usage  * [innerHTML]=\"value | safeHtml\"  */ @Pipe({ name: 'safeHtml' }) export class SafeHtmlPipe implements PipeTransform {   constructor(private sanitizer: DomSanitizer) {}    // eslint-disable-next-line @typescript-eslint/no-explicit-any   transform(html: any): SafeHtml {     const result = this.sanitizer.bypassSecurityTrustHtml(html);     return result;   } } ```  ### shared.module.ts  ```ts import { NgModule } from '@angular/core'; import { SafeHtmlPipe } from './safe-html.pipe';  @NgModule({   declarations: [SafeHtmlPipe],   exports: [SafeHtmlPipe], }) export class SharedModule {} ```  ## 3. Add prismjs style to global style sheet  ### global_styles.css  ```css /* Add application styles & imports to this file! */  /* Prismjs theme */ @import \"prismjs/themes/prism-okaidia.css\"; @import \"prismjs/plugins/toolbar/prism-toolbar.css\"; @import \"prismjs/plugins/line-numbers/prism-line-numbers.css\"; /* Available themes */ /* @import \"prismjs/themes/prism.css\"; @import \"prismjs/themes/prism-coy.css\"; @import \"prismjs/themes/prism-dark.css\"; @import \"prismjs/themes/prism-funky.css\"; @import \"prismjs/themes/prism-solarizedlight.css\"; @import \"prismjs/themes/prism-tomorrow.css\"; @import \"prismjs/themes/prism-twilight.css\"; */ ```  ## 4. Apply prismjs to html  ### main.ts  ```ts @Component({   selector: 'my-app',   standalone: true,   imports: [CommonModule, SharedModule],   templateUrl: './main.html',   styleUrls: ['./main.scss'] }) export class App implements OnInit,AfterViewChecked {   name = 'Angular';    highlighted = false;    code = `   <p>Here's how you can customize the appearance of an Angular Material toggle button. Although the method is unique, I'll explain it in this article.</p>\\n<h2>1. How to use Angular Material button-toggle</h2>\\n<h3>Install Angular Material</h3>\\n<pre><code class=\\\"language-bash\\\">ng add @angular/material\\n</code></pre>\\n<h3>Import Angular Material button-toggle to Module file</h3>\\n<pre><code class=\\\"language-ts\\\">import {MatButtonToggleModule} from '@angular/material/button-toggle'\\n</code></pre>\\n<h3>Html</h3>\\n<pre><code class=\\\"language-html\\\">&lt;mat-button-toggle [aria-label]=&quot;alertsEnabled ? 'Disable alerts' : 'Enable alerts'&quot;&gt;\\n  &lt;mat-icon&gt;notifications&lt;/mat-icon&gt;\\n&lt;/mat-button-toggle&gt;\\n</code></pre>\\n<p>For more details, refer to the official documentation:<br>\\n<a href=\\\"https://material.angular.io/components/button-toggle\\\">Angular Material Official Documentation</a></p> `;    constructor(private readonly prismService: PrismService) {}    ngOnInit(){       this.code = HtmlUtils.addClassToHtml(this.code, 'line-numbers', 'pre');   }    ngAfterViewChecked() {     if (!this.highlighted && this.code) {       this.prismService.highlightAll();       this.highlighted = true;     }   } } ```  ### main.html  ```html <h1>Hello from {{name}}!</h1> <a target=\"_blank\" href=\"https://angular.io/start\">   Learn more about Angular sample </a>  <div [innerHtml]=\"code | safeHtml\"></div> ``` "
    },
    "_id": "blog/47-angular-prismjs-example.mdx",
    "_raw": {
      "sourceFilePath": "blog/47-angular-prismjs-example.mdx",
      "sourceFileName": "47-angular-prismjs-example.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/47-angular-prismjs-example"
    },
    "type": "Post",
    "slug": "/blog/47-angular-prismjs-example",
    "slugAsParams": "47-angular-prismjs-example"
  },
  {
    "title": "How to Serve Next.js SSG (Static Site Generation) from Nx NestJS",
    "description": "This article explains how to use the monorepo tool Nx to serve a statically generated site created with Next.js SSG (Static Site Generation) from a Next.js application. With this approach, you can have both the frontend and backend in a single project.",
    "date": "2023-09-24T00:00:00.000Z",
    "lastmod": "2023-09-24T00:00:00.000Z",
    "emoji": "ğŸ–¼",
    "tags": ["nx", "nestjs", "nextjs"],
    "published": true,
    "body": {
      "raw": " ## Introduction  In this article, we will explain how to use the monorepo tool Nx to serve a statically generated site created with Next.js SSG (Static Site Generation) from a Next.js application. This approach allows you to have both the frontend and backend in a single project.  ## 1. Create Frontend and Backend Projects  ### Create Nx Workspace and Nestjs Project  Navigate to the desired directory and run the following command:  ```bash npx create-nx-workspace@latest  âœ” Where would you like to create your workspace? Â· sample-workspace âœ” Which stack do you want to use? Â· node âœ” What framework should be used? Â· nest âœ” Integrated monorepo, or standalone project? Â· integrated âœ” Application name Â· api âœ” Would you like to generate a Dockerfile? [https://docs.docker.com/] Â· No âœ” Enable distributed caching to make your CI faster Â· No ```  This will create the Nestjs `api` project.  ### Create a Nextjs Project  ```bash nx g @nx/next:app web  âœ” Which stylesheet format would you like to use? Â· css âœ” Which E2E test runner would you like to use? Â· cypress âœ” Would you like to use the App Router (recommended)? (Y/n) Â· true ```  The directory structure created by the above commands will look like this:  ```text sample-workspace/   |- apps/   |    |- api/   |    |- web/ ```  ## 2. Enable Nextjs (Frontend) for SSG (Static Site Generation)  To enable support for static files, make the following changes:  * Add `unoptimized: true` in `images` (SSG doesn't support `next/image`). * Add `output: 'export'`. * Add `trailingSlash: true`.  ```js:apps/web/next.config.js const nextConfig = {   nx: {     // Set this to true if you would like to use SVGR     // See: https://github.com/gregberge/svgr     svgr: false   },    images: {     unoptimized: true,   },    output: 'export',    trailingSlash: true };  ```  > If you don't set `trailingSlash: true`, when accessing Nextjs via Nestjs, reloading the browser on pages other than the homepage will redirect you to the homepage. > > [NEXT.JS trailingSlash](https://nextjs.org/docs/app/api-reference/next-config-js/trailingSlash)  ## 3. Add ServeStaticModule to Nestjs (Backend)  ### Import the `serve-static` Package  ```bash npm i @nestjs/serve-static ```  ### Implement the ServeStaticModule  ```ts:apps/api/src/app/app.module.ts import { ServeStaticModule } from '@nestjs/serve-static';  import path, { join } from 'path';  // Other standard imports are omitted  @Module({   imports: [     ServeStaticModule.forRoot({       rootPath: join(__dirname, '..', 'web/.next'),       exclude: ['/api/*']     }),   ],    controllers: [AppController],    providers: [AppService] }) export class AppModule {} ```  With the above code, if the endpoint does not start with `/api`, it will redirect to the `.next` directory, which is the static site of Nextjs.  > At this point, the `.next` folder has not been generated yet. It will be generated later when you run Nextjs Build, as explained below.  ## 4. Add Build and Start Commands to `package.json`  Add the build and start commands to your `package.json` file.  ```json:package.json \"scripts\": {     \"cd:build-api\": \"npx nx build api --prod\",     \"cd:build-web\": \"npx nx build web --prod\",     \"cd:build\": \"npm run cd:build-api && npm run cd:build-web\",     \"cd:web-start:server\": \"cd dist/apps/web && npm run start\",     \"cd:web-start:static\": \"npx serve dist/apps/web/.next\",     \"cd:api-start\": \"node dist/apps/api/main.js\" } ```  Next, execute the build command:  ```bash npm run cd:build ```  This will generate build files for both the frontend (web) and backend (api).  Finally, execute the start command:  ```bash npm run cd:api-start ```  This will start the backend server on localhost, and you can access the Next.js pages in your browser.  By deploying these, you can serve both the frontend and backend integrated on a single server.  For reference, here is the directory structure after the build:  ```text sample-workspace/   |- apps/   |    |- api/   |    |- web/   |   |-dist/  <= generated after the build   |   |- apps/   |        |- api/      |        |- web/   |             |- .next/   |   |- package.json ``` "
    },
    "_id": "blog/48-nx-nestjs-nextjs-ssg.mdx",
    "_raw": {
      "sourceFilePath": "blog/48-nx-nestjs-nextjs-ssg.mdx",
      "sourceFileName": "48-nx-nestjs-nextjs-ssg.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/48-nx-nestjs-nextjs-ssg"
    },
    "type": "Post",
    "slug": "/blog/48-nx-nestjs-nextjs-ssg",
    "slugAsParams": "48-nx-nestjs-nextjs-ssg"
  },
  {
    "title": "C# Prism Template Pack Code Snippets (Visual Studio Code)",
    "description": "Visual Studio Code snippets for C# Prism Template Pack.",
    "date": "2023-09-30T00:00:00.000Z",
    "lastmod": "2023-09-30T00:00:00.000Z",
    "emoji": "ğŸŒ³",
    "tags": ["vscode", "csharp"],
    "published": true,
    "body": {
      "raw": " ## Registering Custom Code Snippets in Visual Studio Code  You can create code snippet files using the following steps:  1. Select **File > Preferences > User Snippets** from the code editor's top menu.  2. Snippets are written in JSON format.  ## Code Snippets  ### propp  Defines a property that requires update notifications.  ```json   \"Create Bindable Property\": {     \"scope\": \"csharp\",     \"prefix\": \"propp\",     \"body\": [       \"private ${1:Type} _${3:${2/(.*)/${1:/camelcase}/}};\",       \"public ${1:Type} ${2:Name}\",       \"{\",       \"   get { return _$3; }\",       \"   set { SetProperty(ref _$3, value); }\",       ,       \"}\"     ],     \"description\": \"Create a property, with a backing field, that depends on BindableBase.\"   } ```  #### About `${3:...}`  * `${2/(.*)/${1:/camelcase}/}`: This part is a combination of regular expression and replacement pattern. It generates the name of the backing field based on the value of `${2:Name}`. * `(.*)`: This is a regular expression capture group. It captures the property name (Name) entered by the user. * `${1:/camelcase}`: This is a replacement pattern for converting the captured string to camel case. `${1:...}` references the captured value, and `:camelcase` instructs camel case conversion.  ### cmd  Delegate command.  ```json   \"Create DelegateCommand Property\": {     \"scope\": \"csharp\",     \"prefix\": \"cmd\",     \"body\": [       \"public DelegateCommand ${1:Command} => new DelegateCommand(() =>\",        \"{\",        \"\",        \"});\"     ],     \"description\": \"Create a DelegateCommand property with a private setter.\"   } ```  ### cmdg  Parameterized delegate command.  ```json   \"Create Generic DelegateCommand Property\": {     \"scope\": \"csharp\",     \"prefix\": \"cmdg\",     \"body\": [       \"public DelegateCommand<${2:Param}> ${1:Command} => new DelegateCommand<${2:Param}>((p) =>\",       \"{\",       \"\",       \"});\"     ],     \"description\": \"Create a generic DelegateCommand property.\"   } ```"
    },
    "_id": "blog/49-cs-prism-snippet.mdx",
    "_raw": {
      "sourceFilePath": "blog/49-cs-prism-snippet.mdx",
      "sourceFileName": "49-cs-prism-snippet.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/49-cs-prism-snippet"
    },
    "type": "Post",
    "slug": "/blog/49-cs-prism-snippet",
    "slugAsParams": "49-cs-prism-snippet"
  },
  {
    "title": "VBS | Saving the results selected from Oracle DB to a CSV file",
    "description": "This time, we will explain a program that uses VBS to save data extracted from an Oracle DB into a CSV file.",
    "date": "2020-02-27T00:00:00.000Z",
    "emoji": "ğŸ’¿",
    "tags": ["vbs", "oracle"],
    "published": true,
    "body": {
      "raw": " Is there a need to work with data stored in a database (DB) using a different application?  In such cases, one approach is to first extract the DB data into a CSV file and then read that CSV file from the other application.  ![image](/blog/5/db_to_csv.png)  This time, we will explain a program that uses VBS to save data extracted from an Oracle DB into a CSV file.  The source code can be downloaded from here: â†“   [template-vbs/ExportCsvOracle/](https://github.com/atman-33/template-vbs/tree/master/ExportCsvOracle/ \"Github\")  ## Program Workflow  Although the program's main purpose is to save data extracted from a DB into a CSV file, the general workflow is as follows:  ```text â‘  Load necessary configuration information. ã€€â†“ â‘¡ Connect to the Oracle DB. ã€€â†“ â‘¢ Execute SQL containing the SELECT statement. ã€€â†“ â‘£ Save the executed SQL result to a CSV file. ã€€â†“ â‘¤ Disconnect from the Oracle DB. ```  ## Package Structure  The program's functionality isn't contained within a single source file. It involves a folder and file structure, as shown below:  ```text ExportCsvOracle/ â”œcsv/ â”œsql/ â”œConfig.ini â””ExportCsvOracle.vbs ```  |Folder/File|Description| |:--|:--| |ExportCsvOracle.vbs|Execution program.| |Config.ini|Configuration information for DB connections and folder paths.| |sql (Folder)|Contains files storing the SELECT statements.| |csv (Folder)|Stores CSV files extracted from the DB.|  ## Explanation of Source Code  For program execution, configuration information will be loaded from an INI file.  â–¼ Config.ini ```ini [source_db] provider=OraOLEDB.Oracle data_source=TESTDB user_id=system password=sys [path] sql_folder=sql csv_folder=csv ```  The INI file in this case contains the following information:  - Connection information to the DB (Oracle) - Folder name (path) for storing SQL statements - Folder name (path) for storing generated CSV files  This information from the INI file is read and stored in variables within the VBS script for later use. For more details on this process, you can refer to a separate article: [VBS | Getting Data from an INI File](/blog/3-get-ini-data-vbs)  ## Connecting to the Oracle DB  In this section, we prepare functions necessary for various operations with the Oracle DB.  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief: Connect to the DB (Oracle) ' note : ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Sub OpenDBOracle(ByRef objAdoCon, provider, dataSource, user, pass)      If DEBUG_MODE = 1 Then         WScript.Echo \"Connecting to the DB.\"     End If      Dim constr      Set objAdoCon = WScript.CreateObject(\"ADODB.Connection\")      constr = \"Provider=\" & provider & \";Data Source=\" & dataSource _                 & \";User ID=\" & user & \";Password=\" & pass      If DEBUG_MODE = 1 Then         WScript.Echo constr     End If      objAdoCon.ConnectionString = constr     objAdoCon.Open      If DEBUG_MODE = 1 Then         WScript.Echo \"Connected to the DB.\"     End If  End Sub  ' ... (Other DB-related functions) ```  In this context, we will only be using the DB connection and disconnection functions.  You can utilize the variables read from the earlier INI file to perform DB operations like this:  ```vb Dim objAdoCon       ' ADO connection  ' 1. Connect to the DB OpenDBOracle objAdoCon, SDB_PROVIDER, SDB_DATA_SOURCE, SDB_USER, SDB_PASS  ... ... ...  ' 4. Disconnect from the DB CloseDB objAdoCon Set objAdoCon = Nothing ```  ## Executing SQL Statements  Now that we have established a connection to the Oracle DB, let's proceed to explain how to execute SQL statements and retrieve record sets. The workflow for this section is as follows:  Retrieve SQL files from the SQL storage folder **â€» One SELECT statement per SQL file**   ã€€â†“   Extract SQL statements from SQL files   ã€€â†“   Execute SQL statements and retrieve record sets    First, we will prepare functions needed for each step:  ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief: Execute SQL SELECT statement and retrieve record set ' note : Return -> Record Set ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Function ExcuteSQLgetRS(objAdoCon, strSQL)      Dim objAdoRS  ' Record Set      Set objAdoRS = objAdoCon.Execute(strSQL)      Set ExcuteSQLgetRS = objAdoRS   ' Remember to use Set for objects  End Function  ' ... (Other functions) ```  With these functions, you can proceed to execute SQL statements and retrieve record sets. Though I'll skip detailed explanations, the record set will contain information from the extraction result specified in the SQL SELECT statement.  You can call these functions within your main program code:  ```vb Dim objAdoCon       ' ADO connection Dim strSQLFiles     ' SQL file collection to execute Dim strSQLFile      ' SQL file to execute Dim strSQL          ' SQL to execute Dim objAdoRS        ' ADO record set Dim csvText         ' CSV text obtained from SELECT query  ' 1. Connect to the DB OpenDBOracle objAdoCon, SDB_PROVIDER, SDB_DATA_SOURCE, SDB_USER, SDB_PASS  ' 2. Read SQL file collection strSQLFiles = GetFileNames(SQL_FOLDER_PATH)  ' 3. CSV generation For Each strSQLFile In strSQLFiles                      ' Iterate through each SQL file     strSQL = GetFileText(strSQLFile)                    ' Retrieve the SQL statement     Set objAdoRS = ExcuteSQLgetRS(objAdoCon, strSQL)    ' Execute the SQL statement and get the record set     csvText = GetCSVTextFromRS(objAdoRS)                ' Convert the record set to CSV-formatted text      WriteFile CSV_FOLDER_PATH & \"\\\" & GetBaseName(strSQLFile), csvText, \"csv\"   ' Generate CSV file Next ```  This completes the creation of CSV files.  ## Saving Executed SQL Results to CSV Files  Until now, the SQL results have been stored in a record set. However, to save the data in CSV format, you need to convert the record set into a text format compatible with CSV.  The workflow here is as follows  :  â‘  Convert the record set to CSV (text)   ã€€â†“   â‘¡ Write the converted text to a CSV file    ```vb ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' brief: Convert record set to CSV ' note : Return -> CSV-formatted text ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Function GetCSVTextFromRS(ByRef objAdoRS)      Dim csvText     Dim i      csvText = \"\"     Do While objAdoRS.EOF <> True          For i = 0 to objAdoRS.fields.count -1             If i <> objAdoRS.fields.count -1 then                 csvText = csvText & objAdoRS(i).value & \", \"             Else                 csvText = csvText & objAdoRS(i).value             End If         Next         csvText = csvText & vbCrLf         objAdoRS.MoveNext     Loop      objAdoRS.Close     Set objAdoRS = Nothing      If DEBUG_MODE = 1 Then         WScript.Echo csvText     End If     GetCSVTextFromRS = csvText  End Function  ' ... (Other functions) ```  You can incorporate these functions into your main program by adding the following code:  ```vb Dim objAdoCon       ' ADO connection Dim strSQLFiles     ' SQL file collection to execute Dim strSQLFile      ' SQL file to execute Dim strSQL          ' SQL to execute Dim objAdoRS        ' ADO record set Dim csvText         ' CSV text obtained from SELECT query  ' 1. Connect to the DB OpenDBOracle objAdoCon, SDB_PROVIDER, SDB_DATA_SOURCE, SDB_USER, SDB_PASS  ' 2. Read SQL file collection strSQLFiles = GetFileNames(SQL_FOLDER_PATH)  ' 3. CSV generation For Each strSQLFile In strSQLFiles                      ' Iterate through each SQL file     strSQL = GetFileText(strSQLFile)                    ' Retrieve the SQL statement     Set objAdoRS = ExcuteSQLgetRS(objAdoCon, strSQL)    ' Execute the SQL statement and get the record set     csvText = GetCSVTextFromRS(objAdoRS)                ' Convert the record set to CSV-formatted text      WriteFile CSV_FOLDER_PATH & \"\\\" & GetBaseName(strSQLFile), csvText, \"csv\"   ' Generate CSV file Next  ' 4. Disconnect from the DB CloseDB objAdoCon Set objAdoCon = Nothing  If DEBUG_MODE = 1 Then     WScript.Echo \"Process completed.\" End If ```  This concludes the explanation. Using this sample as a base, you can easily implement tasks like extracting the latest logs from a table in the database every hour. For automated repetitive execution, consider using the Task Scheduler on Windows. "
    },
    "_id": "blog/5-oracle-db-to-csv-vbs.mdx",
    "_raw": {
      "sourceFilePath": "blog/5-oracle-db-to-csv-vbs.mdx",
      "sourceFileName": "5-oracle-db-to-csv-vbs.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/5-oracle-db-to-csv-vbs"
    },
    "type": "Post",
    "slug": "/blog/5-oracle-db-to-csv-vbs",
    "slugAsParams": "5-oracle-db-to-csv-vbs"
  },
  {
    "title": "How to Use shadcn with Nx Next.js",
    "description": "Explaining how to use shadcn in Nx monorepo with Next.js.",
    "date": "2023-10-11T00:00:00.000Z",
    "lastmod": "2023-10-11T00:00:00.000Z",
    "emoji": "ğŸŒ™",
    "tags": ["nx", "nextjs", "shadcnui"],
    "published": true,
    "body": {
      "raw": " ## Introduction  In this guide, we will explain how to use shadcn in Nx monorepo with Next.js.  ## 1. Initialize Nx and Create a Next.js Project  ```bash npx create-nx-workspace@latest ```  ```bash npm i -D @nx/next ```  ```bash nx g @nx/next:app web --tags \"scope:web\"  âœ” Which stylesheet format would you like to use? Â· css âœ” Which E2E test runner would you like to use? Â· cypress âœ” Would you like to use the App Router (recommended)? (Y/n) Â· true ```  ## 2. Add Tailwind  ```bash nx g @nx/react:setup-tailwind --project=web ```  ## 3. Add Library for shadcn  ```bash npx nx generate @nx/next:library ui-shadcn --directory=web --importPath=@libs/web/ui-shadcn --tags=scope:web --bundler=swc  âœ” Which stylesheet format would you like to use? Â· css ```  After creating the library, perform the following steps:  - Delete `server.ts`. - Create a `components` folder at the root of the `src` folder.  At this point, your directory structure should look like this:  ```txt (your workspace)   |- apps/   |    |- web/   |   |- libs/   |    |- web/   |        |- ui-shadcn/   |             |- src/   |                 |- components/   |                 |- index.ts   |- package.json ```  ## 4. Add shadcn/ui  ```bash npm install tailwindcss-animate class-variance-authority clsx tailwind-merge ```  ```bash npm install @radix-ui/react-icons ```  Edit `tailwind.config.js`:  ```js:apps/web/tailwind.config.js /** @type {import('tailwindcss').Config} */ const { fontFamily } = require('tailwindcss/defaultTheme'); const { createGlobPatternsForDependencies } = require('@nx/react/tailwind'); const { join } = require('path');  module.exports = {   darkMode: ['class'],   content: [     join(       __dirname,       '{src,pages,components,app}/**/*!(*.stories|*.spec).{ts,tsx,html}'     ),     ...createGlobPatternsForDependencies(__dirname),   ],   theme: {     container: {       center: true,       padding: '2rem',       screens: {         '2xl': '1400px',       },     },     extend: {       colors: {         border: 'hsl(var(--border))',         input: 'hsl(var(--input))',         ring: 'hsl(var(--ring))',         background: 'hsl(var(--background))',         foreground: 'hsl(var(--foreground))',         primary: {           DEFAULT: 'hsl(var(--primary))',           foreground: 'hsl(var(--primary-foreground))',         },         secondary: {           DEFAULT: 'hsl(var(--secondary))',           foreground: 'hsl(var(--secondary-foreground))',         },         destructive: {           DEFAULT: 'hsl(var(--destructive))',           foreground: 'hsl(var(--destructive-foreground))',         },         muted: {           DEFAULT: 'hsl(var(--muted))',           foreground: 'hsl(var(--muted-foreground))',         },         accent: {           DEFAULT: 'hsl(var(--accent))',           foreground: 'hsl(var(--accent-foreground))',         },         popover: {           DEFAULT: 'hsl(var(--popover))',           foreground: 'hsl(var(--popover-foreground))',         },         card: {           DEFAULT: 'hsl(var(--card))',           foreground: 'hsl(var(--card-foreground))',         },       },       borderRadius: {         lg: `var(--radius)`,         md: `calc(var(--radius) - 2px)`,         sm: 'calc(var(--radius) - 4px)',       },       fontFamily: {         sans: ['var(--font-sans)', ...fontFamily.sans],       },       keyframes: {         'accordion-down': {           from: { height: 0 },           to: { height: 'var(--radix-accordion-content-height)' },         },         'accordion-up': {           from: { height: 'var(--radix-accordion-content-height)' },           to: { height: 0 },         },       },       animation: {         'accordion-down': 'accordion-down 0.2s ease-out',         'accordion-up': 'accordion-up 0.2s ease-out',       },     },   },   plugins: [require('tailwindcss-animate')], }; ```  Add `global.css`:  ```css:apps/web/styles/global.css @tailwind base; @tailwind components; @tailwind utilities;  @layer base {   :root {     --background: 0 0% 100%;     --foreground: 222.2 47.4% 11.2%;      --muted: 210 40% 96.1%;     --muted-foreground: 215.4 16.3% 46.9%;      --popover: 0 0% 100%;     --popover-foreground: 222.2 47.4% 11.2%;      --border: 214.3 31.8% 91.4%;     --input: 214.3 31.8% 91.4%;      --card: 0 0% 100%;     --card-foreground: 222.2 47.4% 11.2%;      --primary: 222.2 47.4% 11.2%;     --primary-foreground: 210 40% 98%;      --secondary: 210 40% 96.1%;     --secondary-foreground: 222.2 47.4% 11.2%;      --accent: 210 40% 96.1%;     --accent-foreground: 222.2 47.4% 11.2%;      --destructive: 0 100% 50%;     --destructive-foreground: 210 40% 98%;      --ring: 215 20.2% 65.1%;      --radius: 0.5rem;   }    .dark {     --background: 224 71% 4%;     --foreground: 213 31% 91%;      --muted: 223 47% 11%;     --muted-foreground: 215.4 16.3% 56.9%;      --accent: 216 34% 17%;     --accent-foreground: 210 40% 98%;      --popover: 224 71% 4%;     --popover-foreground: 215 20.2% 65.1%;      --border: 216 34% 17%;     --input: 216 34% 17%;      --card: 224 71% 4%;     --card-foreground: 213 31% 91%;      --primary: 210 40% 98%;     --primary-foreground: 222.2 47.4% 1.2%;      --secondary: 222.2 47.4% 11.2%;     --secondary-foreground: 210 40% 98%;      --destructive: 0 63% 31%;     --destructive-foreground: 210 40% 98%;      --ring: 216 34% 17%;      --radius: 0.5rem;   } }  @layer base {   * {     @apply border-border;   }   body {     @apply bg-background text-foreground;     font-feature-settings: \"rlig\" 1, \"calt\" 1;   } } ```  ## 5. Add util.ts for shadcn  **utils.ts**  ```ts:libs/web/ui-shadcn/src/lib/utils.ts import { clsx, type ClassValue } from 'clsx'; import { twMerge } from 'tailwind-merge';  export function cn(...inputs: ClassValue[]) {   return twMerge(clsx(inputs)); } ```  ## 6. Add component.json in the root directory  **components.json**  ```json:components.json {   \"$schema\": \"https://ui.shadcn.com/schema.json\",   \"style\": \"new-york\",   \"rsc\": false,   \"tailwind\": {     \"config\": \"apps/web/tailwind.config.js\",     \"css\": \"apps/web/app/styles/global.css\",     \"baseColor\": \"stone\",     \"cssVariables\": true   },   \"aliases\": {     \"components\": \"@libs/web/ui-shadcn/components\",     \"utils\": \"@libs/web/ui-shadcn/lib/utils\"   } } ```  ## 7. Add tsconfig.json in the root directory  The `tsconfig.json` is necessary for shacn/ui CLI commands.  **tsconfig.json**  ```json:tsconfig.json {   \"compilerOptions\": {     \"baseUrl\": \".\",     \"paths\": {       \"@libs/web/ui-shadcn\": [\"libs/web/ui-shadcn/src/index.ts\"],       \"@libs/web/ui-shadcn/*\": [\"libs/web/ui-shadcn/src/*\"]     }   } }  ```  With these steps, your setup is complete.  ## 8. Implement shadcn/ui Components  Use the shadcn/ui CLI to install components:  ```bash npx shadcn-ui@latest add button ```  Edit the component's tsx file:  - Add `'use client'`. - Resolve the `@nx/enforce-module-boundaries` warning.  ```tsx:libs/web/ui-shadcn/src/components/ui/button.tsx 'use client'; ... // eslint-disable-next-line @nx/enforce-module-boundaries import { cn } from '@libs/web/ui-shadcn/lib/utils'; ... ```  Add exports for the components in `index.ts`:  ```ts:libs/web/ui-shadcn/src/index.ts export * from './components/ui/button'; ```  Implement the component in `page.tsx`:  ```tsx:page.tsx import { Button } from '@libs/web/ui-shadcn';  const Page = () => {   return <Button>Button</Button> }  export default Page; ```  ## References  - [shadcn/ui Documentation](https://ui.shadcn.com/docs/installation/manual) - [GitHub Issue: component.json needs to load tsconfig.json](https://github.com/shadcn-ui/ui/issues/718)  "
    },
    "_id": "blog/50-nx-nextjs-shadcn.mdx",
    "_raw": {
      "sourceFilePath": "blog/50-nx-nextjs-shadcn.mdx",
      "sourceFileName": "50-nx-nextjs-shadcn.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/50-nx-nextjs-shadcn"
    },
    "type": "Post",
    "slug": "/blog/50-nx-nextjs-shadcn",
    "slugAsParams": "50-nx-nextjs-shadcn"
  },
  {
    "title": "electron-react-boilerplate ç’°å¢ƒæ§‹ç¯‰ï¼ˆProxy, ç’°å¢ƒå¤‰æ•°ï¼‰",
    "description": "Electron + Reactãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã®ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰ã€‚Node.jsã¨Proxyè¨­å®šã€boilerplateãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚¯ãƒ­ãƒ¼ãƒ³ã€ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•ã‚’æä¾›ã€‚",
    "date": "2023-10-29T00:00:00.000Z",
    "lastmod": "2023-11-07T00:00:00.000Z",
    "emoji": "âš¡",
    "tags": ["electron"],
    "published": true,
    "body": {
      "raw": " ## Electronã¨Reactã‚’çµ„ã¿åˆã‚ã›ãŸãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã®ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—  Electronã¯ã€HTMLã€CSSã€JavaScriptã‚’ç”¨ã„ã¦ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã™ã‚‹ãŸã‚ã®å¼·åŠ›ãªãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ã€Windowsç’°å¢ƒã§Electronã¨Reactã‚’çµ„ã¿åˆã‚ã›ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ–¹æ³•ã«ã¤ã„ã¦è©³ã—ãèª¬æ˜ã—ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã«å¾“ã£ã¦ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å§‹ã‚ã¾ã—ã‚‡ã†ã€‚  ### 1. å‰ææ¡ä»¶  æœ€åˆã«ã€Node.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚Node.jsã¯ã€Electronã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã«å¿…è¦ãªãƒ©ãƒ³ã‚¿ã‚¤ãƒ ç’°å¢ƒã§ã™ã€‚Node.jsã‚’ã¾ã ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ãªã„å ´åˆã¯ã€[Node.jsã®å…¬å¼ã‚¦ã‚§ãƒ–ã‚µã‚¤ãƒˆ](https://nodejs.org/)ã‹ã‚‰æœ€æ–°ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚  ### 2. npmã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã®Proxyè¨­å®š  Proxyã‚µãƒ¼ãƒãƒ¼ã‚’åˆ©ç”¨ã—ã¦ã„ã‚‹å ´åˆã€npmã‚’æ­£ã—ãè¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€npmã®Proxyè¨­å®šã‚’è¡Œã„ã¾ã™ã€‚  ```powershell npm config set strict-ssl false npm config registry \"http://registry.npmjs.org\" npm config set proxy \"åˆ©ç”¨ã—ã¦ã„ã‚‹Proxyã®URL\" npm config set https-proxy \"åˆ©ç”¨ã—ã¦ã„ã‚‹Proxyã®URL\" ```  ã“ã‚Œã«ã‚ˆã‚Šã€npmãŒProxyã‚’çµŒç”±ã—ã¦å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚  ### 3. electron-react-boilerplateã®ã‚¯ãƒ­ãƒ¼ãƒ³  æ¬¡ã«ã€GitHubã‹ã‚‰`electron-react-boilerplate`ã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å§‹ã‚ã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚  ```powershell git clone --depth 1 --branch main https://github.com/electron-react-boilerplate/electron-react-boilerplate your-project-name ```  ã“ã“ã§`your-project-name`ã¯ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åå‰ã‚’æŒ‡å®šã™ã‚‹ç®‡æ‰€ã§ã™ã€‚é©åˆ‡ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåã«å¤‰æ›´ã—ã¦ãã ã•ã„ã€‚  ### 4. å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã—ã€å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚ä»¥ä¸‹ã®æ‰‹é †ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚  1. Powershellã‚’é–‹ãã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã—ã¾ã™ã€‚  ```powershell cd your-project-name ```  2. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š  Electronã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ãŸã‚ã«ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¦è¨­å®šã—ã¾ã™ã€‚  ```powershell $env:ELECTRON_GET_USE_PROXY = 1 $env:GLOBAL_AGENT_HTTPS_PROXY = \"åˆ©ç”¨ã—ã¦ã„ã‚‹Proxyã®URL\" ```  3. ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«  æœ€å¾Œã«ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦å¿…è¦ãªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚  ```powershell npm install ```  ã“ã‚Œã§ã€Electronã¨Reactã‚’çµ„ã¿åˆã‚ã›ãŸãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãŒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸã€‚å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚„ä¾å­˜é–¢ä¿‚ãŒè§£æ±ºã•ã‚Œã€é–‹ç™ºã‚’é–‹å§‹ã§ãã¾ã™ã€‚  ### å‚è€ƒURL  - [Electron + Reactã§ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚’ä½œã‚ã†ï¼](https://qiita.com/udayaan/items/2a7c8fd0771d4d995b69) - [Proxyç’°å¢ƒã§Electronã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ã¨ã—ãŸã‚‰éš ã‚ŒãŸç½ ãŒã‚ã£ãŸã‚“ã§ã™](https://qiita.com/LuckyRetriever/items/2f377b1ce34f7d12903c)  ã“ã®ã‚¬ã‚¤ãƒ‰ã‚’é€šã˜ã¦ã€Electronã¨Reactã‚’çµ„ã¿åˆã‚ã›ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åŠ¹æœçš„ã«é–‹å§‹ã§ãã¾ã™ã€‚   é–‹ç™ºã‚’é€²ã‚ã¦ã€ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚’ä½œæˆã—ã¦ã¿ã¦ãã ã•ã„ã€‚"
    },
    "_id": "blog/51-electron-react-boilerplate.mdx",
    "_raw": {
      "sourceFilePath": "blog/51-electron-react-boilerplate.mdx",
      "sourceFileName": "51-electron-react-boilerplate.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/51-electron-react-boilerplate"
    },
    "type": "Post",
    "slug": "/blog/51-electron-react-boilerplate",
    "slugAsParams": "51-electron-react-boilerplate"
  },
  {
    "title": "Excel VBA ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæ”¹è‰¯ç‰ˆ mk2ï¼‰",
    "description": "Excel VBA ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä¸­å¿ƒã«ã€Excelãƒ†ãƒ¼ãƒ–ãƒ«ã¨é€£æºã—ãŸDBï¼ˆOracleï¼‰ã®CRUDæ“ä½œç­‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚",
    "date": "2023-10-29T00:00:00.000Z",
    "lastmod": "2023-10-29T00:00:00.000Z",
    "emoji": "ğŸ¦€",
    "tags": ["vba"],
    "published": true,
    "body": {
      "raw": " ![sample](/blog/52/1-sample.png)  ## æ¦‚è¦  Excel VBA ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã—ãŸã€‚ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä¸­å¿ƒã«ã€Excelãƒ†ãƒ¼ãƒ–ãƒ«ã¨é€£æºã—ãŸDBï¼ˆOracleï¼‰ã®CRUDæ“ä½œç­‰ã®æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚  Excelãƒ•ã‚¡ã‚¤ãƒ«åŠã³ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ä¸‹è¨˜ãƒªãƒã‚¸ãƒˆãƒªã«ä¿å­˜ã—ã¦ã„ã¾ã™ã€‚  [https://github.com/atman-33/template-excel-vba-mk2](https://github.com/atman-33/template-excel-vba-mk2)  ## 1. ä¸»ãªå®Ÿè£…æ©Ÿèƒ½ - Configã‚·ãƒ¼ãƒˆã®ãƒ‡ãƒ¼ã‚¿ã‚’VBAã§åˆ©ç”¨ - Oracleãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«æ¥ç¶šã—ã€Excelãƒ†ãƒ¼ãƒ–ãƒ«ã«ãƒ‡ãƒ¼ã‚¿æ ¼ç´/å‰Šé™¤ã™ã‚‹æ©Ÿèƒ½ - Excelãƒ†ãƒ¼ãƒ–ãƒ«æ“ä½œæ©Ÿèƒ½ï¼ˆã‚½ãƒ¼ãƒˆã€ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼‰  ## 2. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹æˆ  ```text |- æ¨™æº–ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«/ |   |- Constants        : å…±é€šã®å®šæ•°ã‚’è¨˜è¼‰ |   |- ModuleCommon     : Staticãªå…±é€šå‡¦ç†ã‚’è¨˜è¼‰ |   |- Tests            : ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆç”¨ã‚³ãƒ¼ãƒ‰ç½®ãå ´ |   |- Utils            : æ±ç”¨ãƒ¡ã‚½ãƒƒãƒ‰ç½®ãå ´ | |- ã‚¯ãƒ©ã‚¹ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«/ |   |- Config           : Excelã‚·ãƒ¼ãƒˆã«æŒ‡å®šã—ãŸConfigã‚’æ‰±ã†ã‚¯ãƒ©ã‚¹ |   |- DaoAccess        : Access ã«æ¥ç¶šã—ã€CRUDå‡¦ç†ã‚’è¡Œã†DAOã‚¯ãƒ©ã‚¹ |   |- DaoOracleOra     : Oracle ã«æ¥ç¶šã—ã€CRUDå‡¦ç†ã‚’è¡Œã†DAOã‚¯ãƒ©ã‚¹ |   |- ExListObject     : ãƒ†ãƒ¼ãƒ–ãƒ«ï¼ˆListObjectï¼‰ã®æ©Ÿèƒ½æ‹¡å¼µã‚¯ãƒ©ã‚¹ |   |- IDao             : DAOã‚¯ãƒ©ã‚¹ã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ |   |- Repository       : DAOã‚¯ãƒ©ã‚¹ã‚’åˆ©ç”¨ã™ã‚‹ãƒªãƒã‚¸ãƒˆãƒªã‚¯ãƒ©ã‚¹ |   |- TableXxx         : Excelãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ“ä½œã™ã‚‹ã‚¯ãƒ©ã‚¹ |   |- SheetXxx         : Excelã‚·ãƒ¼ãƒˆã‚’æ“ä½œã™ã‚‹ã‚¯ãƒ©ã‚¹ |  ```  ## 3. ã‚·ãƒ¼ãƒˆèª¬æ˜  ### Sample1 ã‚·ãƒ¼ãƒˆ  Sample1ã‚·ãƒ¼ãƒˆã§ã¯ã€OracleDBã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ãƒ»å¤‰æ›´ã§ãã¾ã™ã€‚   ã¾ãŸã€DBã‹ã‚‰å–å¾—ã—ãŸExcelãƒ†ãƒ¼ãƒ–ãƒ«ã«è²¼ã‚Šä»˜ã‘ã—ã€ã‚½ãƒ¼ãƒˆã‚„ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã™ã‚‹æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚  ![sample](/blog/52/1-sample.png)  Excelãƒ†ãƒ¼ãƒ–ãƒ«ã®ã€Œä¿å­˜ã€ãƒ»ã€Œå‰Šé™¤ã€ã‚¢ã‚¤ã‚³ãƒ³ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€ã‚¯ãƒªãƒƒã‚¯ã—ãŸãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’DBã«ä¿å­˜ã‚‚ã—ãã¯å‰Šé™¤ã§ãã¾ã™ã€‚  DBæ¥ç¶šè¨­å®šã‚„ãƒ‡ãƒ¼ã‚¿å–å¾—ã™ã‚‹SQLã¯ã€å¾Œè¿°ã®Configã‚·ãƒ¼ãƒˆãƒ»SQLã‚·ãƒ¼ãƒˆã§æŒ‡å®šã—ã¦ã„ã¾ã™ã€‚  ### Config ã‚·ãƒ¼ãƒˆ  DBæ¥ç¶šæƒ…å ±ç­‰ã€VBAã§åˆ©ç”¨ã™ã‚‹ãŸã‚ã®è¨­å®šã‚’è¡Œã†ã‚·ãƒ¼ãƒˆã§ã™ã€‚ ã“ã®ã‚·ãƒ¼ãƒˆã«æ ¼ç´ã—ãŸKeyã¨Itemã¯ã€VBAå´ã§å‘¼ã³å‡ºã™äº‹ãŒã§ãã¾ã™ã€‚  ![config](/blog/52/2-config.png)  ```vb:Config.cls ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' ã‚¯ãƒ©ã‚¹ï¼šConfig ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----  ' ---- å®šæ•°è¨­å®š ---- ' Const CONFIG_SHEET = \"Config\" Const CONFIG_TABLE = \"Config_tbl\" Const CONFIG_COL_KEY = \"Key\" Const CONFIG_COL_ITEM = \"Item\" ' ------------------ '  Private dictionary_ As Object  ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' Summary : ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Private Sub Class_Initialize()          Set dictionary_ = CreateObject(\"Scripting.Dictionary\")          ' Configãƒ†ãƒ¼ãƒ–ãƒ«ã‚’æ ¼ç´     Dim table As ListObject     Set table = ThisWorkbook.Worksheets(CONFIG_SHEET).ListObjects(CONFIG_TABLE)          ' Configãƒ†ãƒ¼ãƒ–ãƒ«ã®Keyã¨Itemã‚’è¾æ›¸ã«æ ¼ç´     Dim key As String, Item As String          Dim i As Long     For i = 1 To table.ListRows.Count         key = table.ListColumns(CONFIG_COL_KEY).DataBodyRange(i).Value         Item = table.ListColumns(CONFIG_COL_ITEM).DataBodyRange(i).Value              Call dictionary_.Add(key, Item)     Next i          ' ---- Debug ---- '     Dim varItem As Variant     Dim str As String     For Each varItem In dictionary_         str = str & varItem & \":\" & dictionary_.Item(varItem) & vbCrLf     Next          Debug.Print str '    Debug.Print dictionary_.Item(\"ORA_DATA_SOURCE\")          ' --------------- '      End Sub   ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ' Summary : æŒ‡å®šã—ãŸKeyã®ã‚¢ã‚¤ãƒ†ãƒ ã‚’å–å¾— ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- Public Property Get Item(key As String) As Variant     Item = dictionary_.Item(key) End Property ```  Configã®ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹éš›ã¯ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ä½¿ç”¨ã—ã¾ã™ã€‚  ex:   ```vb Dim conf As New Config Dim source As string  source = conf.Item(\"ORA_DATA_SOURCE\") ```  ### SQL ã‚·ãƒ¼ãƒˆ  DBã‹ã‚‰å–å¾—ã™ã‚‹SQLã¨ã€ãƒ‡ãƒ¼ã‚¿è²¼ã‚Šä»˜ã‘å…ˆï¼ˆã‚·ãƒ¼ãƒˆã€ãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã‚’æŒ‡å®šã—ã¾ã™ã€‚  ![sql](/blog/52/3-sql.png)  SQLãƒ†ãƒ¼ãƒ–ãƒ«ã«ã¤ã„ã¦è£œè¶³ï¼š  | åˆ—å  | å†…å®¹                                                                  | | :---- | :-------------------------------------------------------------------- | | Name  | SQLã®åç§°ï¼ˆSQLã‚’åˆ†ã‹ã‚Šæ˜“ãã™ã‚‹ãŸã‚ã«æº–å‚™ã—ã¦ã„ã‚‹ã€‚VBAã§åˆ©ç”¨ã—ãªã„ã€‚ï¼‰ | | Sheet | SQLã®çµæœã‚’å‡ºåŠ›ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ãŒå­˜åœ¨ã™ã‚‹ã‚·ãƒ¼ãƒˆåç§°                       | | Table | SQLã®çµæœã‚’å‡ºåŠ›ã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«åç§°                                       | | SQL   | å®Ÿè¡Œã™ã‚‹SQLæ–‡                                                         | | èª¬æ˜  | SQLã®å†…å®¹ãªã©è£œè¶³ã™ã‚‹å ´åˆã®ã‚³ãƒ¡ãƒ³ãƒˆ                                   |  "
    },
    "_id": "blog/52-excel-vba-template-mk2.mdx",
    "_raw": {
      "sourceFilePath": "blog/52-excel-vba-template-mk2.mdx",
      "sourceFileName": "52-excel-vba-template-mk2.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/52-excel-vba-template-mk2"
    },
    "type": "Post",
    "slug": "/blog/52-excel-vba-template-mk2",
    "slugAsParams": "52-excel-vba-template-mk2"
  },
  {
    "title": "Reactç”¨èªä¸€è¦§ã¨åˆ©ç”¨ã‚¬ã‚¤ãƒ‰",
    "description": "Reactã®ç”¨èªã¨Reactãƒ•ãƒƒã‚¯ã‚’è§£èª¬ã€‚useStateã€useEffectã€Recoilã€Reduxãªã©ã®ä¸»è¦ãªæ©Ÿèƒ½ã¨ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æä¾›ã€‚",
    "date": "2023-11-07T00:00:00.000Z",
    "lastmod": "2023-12-03T00:00:00.000Z",
    "emoji": "ğŸŒŸ",
    "tags": ["react"],
    "published": true,
    "body": {
      "raw": " ## React ç”¨èªä¸€è¦§ã¨åˆ©ç”¨ã‚¬ã‚¤ãƒ‰  React ã‚’ãƒã‚¹ã‚¿ãƒ¼ã—ã€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ™ãƒ¼ã‚¹ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã‚’åŠ¹ç‡çš„ã«è¡Œã†ãŸã‚ã®ç”¨èªè§£èª¬ã¨ã‚¬ã‚¤ãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚   React ã®åŸºæœ¬ã‹ã‚‰é«˜åº¦ãªæ¦‚å¿µã¾ã§ç†è§£ã—ã¾ã—ã‚‡ã†ã€‚  ## React ãƒ•ãƒƒã‚¯  React ãƒ•ãƒƒã‚¯ã¯ã€é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§çŠ¶æ…‹ã‚„å‰¯ä½œç”¨ã‚’æ‰±ã†ãŸã‚ã®ç‰¹åˆ¥ãªé–¢æ•°ã§ã™ã€‚ä»¥ä¸‹ã«ä¸»è¦ãª React ãƒ•ãƒƒã‚¯ã‚’èª¬æ˜ã—ã€ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚‚æä¾›ã—ã¾ã™ã€‚  ### useState  `useState`ã¯ã€é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§çŠ¶æ…‹ã‚’ç®¡ç†ã™ã‚‹ãŸã‚ã® React ãƒ•ãƒƒã‚¯ã§ã™ã€‚çŠ¶æ…‹ã®ä¿æŒã¨æ›´æ–°ãŒå¯èƒ½ã§ã™ã€‚  ```jsx import React, { useState } from 'react';  function Counter() {   const [count, setCount] = useState(0);    return (     <div>       <p>Count: {count}</p>       <button onClick={() => setCount(count + 1)}>Increment</button>     </div>   ); } ```  ### useEffect  `useEffect`ã¯ã€é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§å‰¯ä½œç”¨ã‚’åˆ¶å¾¡ã™ã‚‹ React ãƒ•ãƒƒã‚¯ã§ã™ã€‚å‰¯ä½œç”¨ã¯ã€DOM ã®å¤‰æ›´ã‚„éåŒæœŸå‡¦ç†ãªã©ã€é–¢æ•°å¤–ã®å½±éŸ¿ã‚’ä¸ãˆã‚‹å‡¦ç†ã‚’æŒ‡ã—ã¾ã™ã€‚  ```jsx import React, { useState, useEffect } from 'react';  function DataFetching() {   const [data, setData] = useState([]);    useEffect(() => {     fetch('https://api.example.com/data')       .then((response) => response.json())       .then((data) => setData(data));   }, []);    return (     <ul>       {data.map((item) => (         <li key={item.id}>{item.name}</li>       ))}     </ul>   ); } ```  ### useRef  `useRef`ã¯ã€é–¢æ•°ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå†…ã§ DOM è¦ç´ ã‚„ä»–ã® Ref ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚  ```jsx import React, { useRef, useEffect } from 'react';  function FocusInput() {   const inputRef = useRef(null);    useEffect(() => {     // ãƒšãƒ¼ã‚¸ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚ŒãŸã¨ãã« input è¦ç´ ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å½“ã¦ã‚‹     inputRef.current.focus();   }, []);    return <input ref={inputRef} type=\"text\" />; } ```  ### useContext ã¨ createContext  `useContext`ã¨`createContext`ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’ä½¿ç”¨ã§ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€è¦ªã‹ã‚‰ Props çµŒç”±ã§ãƒ‡ãƒ¼ã‚¿ã‚’æ¸¡ã™å¿…è¦ãŒãªããªã‚Šã¾ã™ã€‚  ```jsx import React, { useContext, createContext } from 'react';  const MyContext = createContext();  function App() {   return (     <MyContext.Provider value=\"Hello from Context!\">       <ChildComponent />     </MyContext.Provider>   ); }  function ChildComponent() {   const value = useContext(MyContext);   return <p>{value}</p>; } ```  ### useMemo ã¨ useCallback  `useMemo`ã¯å€¤ã®ãƒ¡ãƒ¢åŒ–ã«ä½¿ç”¨ã•ã‚Œã€`useCallback`ã¯å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã‚’é¿ã‘ãŸã„ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«é–¢æ•°ã‚’æ¸¡ã™éš›ã«åˆ©ç”¨ã—ã¾ã™ã€‚  ```jsx import React, { useState, useMemo, useCallback } from 'react';  function List({ items }) {   const itemCount = useMemo(() => items.length, [items]);   const handleClick = useCallback((item) => {     // ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãƒ­ã‚¸ãƒƒã‚¯   }, []);    return (     <div>       <p>Item Count: {itemCount}</p>       {items.map((item) => (         <button key={item.id} onClick={() => handleClick(item)}>           {item.name}         </button>       ))}     </div>   ); } ```  ## Recoil  Recoil ã¯ React ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ã®çŠ¶æ…‹ç®¡ç†ã‚’ç°¡ç•¥åŒ–ã—ã¾ã™ã€‚ä»¥ä¸‹ã« Recoil ã®ä¸»è¦ãªãƒ•ãƒƒã‚¯ã‚’èª¬æ˜ã—ã€ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’æä¾›ã—ã¾ã™ã€‚  ### useRecoilState  `useRecoilState`ã¯ã€useState ã®ã‚ˆã†ã«ã‚¹ãƒ†ãƒ¼ãƒˆã‚’æ‰±ã„ã¾ã™ã€‚ã‚¹ãƒ†ãƒ¼ãƒˆãŒæ›´æ–°ã•ã‚Œã‚‹ã¨ã€ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚  ```jsx import { useRecoilState } from 'recoil'; import { myState } from './recoilAtoms';  function MyComponent() {   const [state, setState] = useRecoilState(myState);    return (     <div>       <p>State: {state}</p>       <button onClick={() => setState(state + 1)}>Increment</button>     </div>   ); } ```  ### useRecoilValue  `useRecoilValue`ã¯ RecoilValue å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ã‚¹ãƒ†ãƒ¼ãƒˆã‚’åˆ©ç”¨ã—ã¾ã™ã€‚ã‚¹ãƒ†ãƒ¼ãƒˆãŒæ›´æ–°ã•ã‚Œã‚‹ã¨ã€ãã‚Œã‚’ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã™ã€‚  ```jsx import { useRecoilValue } from 'recoil'; import { myState } from './recoilAtoms';  function MyComponent() {   const state = useRecoilValue(myState);    return <p>State: {state}</p>; } ```  ### useSetRecoilState  `useSetRecoilState`ã¯ RecoilState å‹ã®ãƒ‡ãƒ¼ã‚¿ã‚’å—ã‘å–ã‚Šã€ã‚¹ãƒ†ãƒ¼ãƒˆã®ã‚»ãƒƒã‚¿ãƒ¼é–¢æ•°ã‚’æä¾›ã—ã¾ã™ã€‚ã‚¹ãƒ†ãƒ¼ãƒˆãŒæ›´æ–°ã—ã¦ã‚‚ã€ä½¿ç”¨ã™ã‚‹ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯å†ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã•ã‚Œã¾ã›ã‚“ã€‚  ```jsx import { useSetRecoilState } from 'recoil'; import { myState } from './recoilAtoms';  function MyComponent() {   const setState = useSetRecoilState(myState);    return (     <div>       <button onClick={() => setState((prev) => prev + 1)}>Increment</button>     </div>   ); } ```  ## Redux  Redux ã¯å¼·åŠ›ãªã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¹ãƒ†ãƒ¼ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«ã§ã™ãŒã€Recoil ã®åˆ©ç”¨ã‚’æ¤œè¨ã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚ä»¥ä¸‹ã¯ Redux ã®ä¸»è¦ãªé–¢æ•°ã¨ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚  ### createSlice  `createSlice`ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€Reducer ã‚’ç”Ÿæˆã—ã€Action Type ã¨ Action Creator ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã¾ã™ã€‚  ```jsx import { createSlice } from '@reduxjs/toolkit';  const counterSlice = createSlice({   name: 'counter',   initialState: 0,   reducers: {     increment: (state) => state + 1,     decrement: (state) => state - 1   } });  export const { increment, decrement } = counterSlice.actions; export default counterSlice.reducer; ```  ### configureStore  `configureStore`ã‚’ä½¿ç”¨ã—ã¦ã€ä½œæˆã—ãŸ Slice ã‚’ 1 ã¤ã®ã‚¹ãƒˆã‚¢ã«çµåˆã§ãã¾ã™ã€‚  ```jsx import { configureStore } from '@reduxjs/toolkit'; import counterReducer from './counterSlice';  const store = configureStore({   reducer: {     counter: counterReducer   } }); ```  ### useSelector  `useSelector`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ãƒˆã‚¢ã«ä¿å­˜ã•ã‚ŒãŸã‚¹ãƒ†ãƒ¼ãƒˆãƒ‡ãƒ¼ã‚¿ã‹ã‚‰å¿…è¦ãªãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã™ã€‚  ```jsx import { useSelector } from 'react-redux';  function CounterDisplay() {   const count = useSelector((state) => state.counter);   return <p>Count: {count}</p>; } ```  ### useDispatch  `useDispatch`ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¹ãƒˆã‚¢ã®ãƒ‡ãƒ¼ã‚¿ã‚’å¤‰æ›´ã™ã‚‹é–¢æ•°ã‚’å–å¾—ã§ãã¾ã™ã€‚  ```jsx import { useDispatch } from 'react-redux'; import { increment, decrement } from './counterSlice';  function CounterButtons() {   const dispatch = useDispatch();    return (     <div>       <button onClick={() => dispatch(increment())}>Increment</button>       <button onClick={() => dispatch(decrement())}>Decrement</button>     </div>   ); } ```  React ã¨ãã®ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ ã®ç”¨èªã‚’ç†è§£ã—ã€ã“ã‚Œã‚‰ã®ãƒ•ãƒƒã‚¯ã¨ãƒ„ãƒ¼ãƒ«ã‚’æ´»ç”¨ã—ã¦åŠ¹æœçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚ "
    },
    "_id": "blog/53-react-list-and-usage-guide.mdx",
    "_raw": {
      "sourceFilePath": "blog/53-react-list-and-usage-guide.mdx",
      "sourceFileName": "53-react-list-and-usage-guide.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/53-react-list-and-usage-guide"
    },
    "type": "Post",
    "slug": "/blog/53-react-list-and-usage-guide",
    "slugAsParams": "53-react-list-and-usage-guide"
  },
  {
    "title": "Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 1",
    "description": "Guide to integrating Nx, Nest.js, MongoDB, and Mongoose for enhanced scalability and efficiency. Follow steps for seamless development.",
    "date": "2023-11-17T00:00:00.000Z",
    "lastmod": "2023-11-17T00:00:00.000Z",
    "emoji": "ğŸ¥­",
    "tags": ["nx", "nestjs", "mongodb"],
    "published": true,
    "body": {
      "raw": " ## Introduction In this article, we'll walk through the setup process for integrating Nx, Nest.js, MongoDB, and Mongoose. This integration is crucial for building scalable and efficient applications. We'll cover the installation of necessary packages, updating the main application file (`main.ts`), modifying the `app.module.ts` file, generating projects, creating configuration files, and setting up the MongoDB connection.  ## Install Packages Let's start by installing the required packages for our project. Open your terminal and run the following commands:  ### GraphQL Packages ```bash npm i @nestjs/graphql @nestjs/apollo graphql apollo-server-express ```  ### Class Validator Packages ```bash npm i class-validator class-transformer ```  ### Bcrypt ```bash npm i bcrypt ```  ### Passport and JWT Packages ```bash npm install --save @nestjs/passport passport passport-local npm install --save-dev @types/passport-local npm install --save @nestjs/jwt passport-jwt npm install --save-dev @types/passport-jwt ```  ### Cookie Parser ```bash npm install cookie-parser npm install --save-dev @types/cookie-parser ```  ## Update main.ts Next, update the `main.ts` file located at `apps/api/src/main.ts`. Add the necessary configurations for cookies and validation pipes.  > In this case, `apps/api` folder is a nextjs project.  ```typescript import { Logger, ValidationPipe } from '@nestjs/common'; import { NestFactory } from '@nestjs/core'; import cookieParser from 'cookie-parser';  import { AppModule } from './app/app.module';  async function bootstrap() {   const app = await NestFactory.create(AppModule);   const globalPrefix = 'api';   app.setGlobalPrefix(globalPrefix);    app.use(cookieParser());   app.useGlobalPipes(new ValidationPipe());    const port = process.env.PORT || 3000;   await app.listen(port);   Logger.log(`ğŸš€ Application playground is running on: http://localhost:${port}/api/graphql`); }  bootstrap(); ```  ## Update app.module.ts Now, let's update the `app.module.ts` file located at `apps/api/src/app/app.module.ts`. This modification includes the integration of Apollo and GraphQL.  ```typescript import { ApolloDriver, ApolloDriverConfig } from '@nestjs/apollo'; import { Module } from '@nestjs/common'; import { GraphQLModule } from '@nestjs/graphql'; import { AppController } from './app.controller'; import { AppService } from './app.service';  @Module({   imports: [     GraphQLModule.forRoot<ApolloDriverConfig>({       driver: ApolloDriver,       path: '/api/graphql',       autoSchemaFile: true     }),   ],   controllers: [AppController],   providers: [AppService] }) export class AppModule {} ```  > If any module that has a resolver does not exist, an error will occur!  ## Install @nestjs/config Package To handle configuration settings, install the `@nestjs/config` package:  ```bash npm i @nestjs/config ```  ## Generate Project Now, generate the shared configuration project:  ```bash npx nx generate @nx/js:library shared-config --directory=libs/shared/config --importPath=@libs/shared/config --tags=scope:shared --bundler=swc  âœ” Which unit test runner would you like to use? Â· jest ```  ## Create env.ts Create the `env.ts` file inside `libs/shared/config/src/lib/` with the following content:  ```typescript import * as dotenv from 'dotenv';  dotenv.config({ path: '.env.local' });  export const env = {   PORT: process.env['PORT'],   API_PORT: process.env['API_PORT'],   NEXT_PUBLIC_API_GQL_URL: process.env['NEXT_PUBLIC_API_GQL_URL'],   DB_URL: process.env['DB_URL'], }; ```  Update the `index.ts` file.  ```ts:index.ts export * from './lib/env'; ```  ## Install @nestjs/mongoose Package To interact with MongoDB using Nest.js, install the `@nestjs/mongoose` and `mongoose` packages:  ```bash npm i @nestjs/mongoose mongoose ```  ## Generate Mongoose Project Generate the project for Mongoose shared configuration:  ```bash npx nx generate @nx/js:library api-mongoose-shared --directory=libs/api/mongoose/shared --importPath=@libs/api/mongoose/shared --tags=scope:api --bundler=swc  âœ” Which unit test runner would you like to use? Â· none ```  ## Create Mongoose Files Create the following files within `libs/api/mongoose/shared/src/lib/`:  ### model/abstract.model.ts ```typescript import { Field, ObjectType } from '@nestjs/graphql';  @ObjectType() export class AbstractModel {   @Field()   readonly _id!: string; } ```  ### database/abstract.schema.ts ```typescript import { Prop, Schema } from '@nestjs/mongoose'; import { SchemaTypes, Types } from 'mongoose';  @Schema() export class AbstractDocument {   @Prop({ type: SchemaTypes.ObjectId })   _id!: Types.ObjectId; } ```  ### database/abstract.repository.ts ```typescript import { Logger, NotFoundException } from '@nestjs/common'; import { FilterQuery, Model, Types, UpdateQuery } from 'mongoose'; import { AbstractDocument } from './abstract.schema';  export abstract class AbstractRepository<TDocument extends AbstractDocument> {   protected abstract readonly logger: Logger;    constructor(protected readonly model: Model<TDocument>) {}    async create(document: Omit<TDocument, '_id'>): Promise<TDocument> {     const createdDocument = new this.model({       ...document,       _id: new Types.ObjectId()     });      return (await createdDocument.save()).toJSON() as unknown as TDocument;   }    async findOne(filterQuery: FilterQuery<TDocument>): Promise<TDocument> {     const document = await this.model.findOne(filterQuery, {}, { lean: true });      if (!document) {       this.logger.warn('Document not found with filterQuery', filterQuery);       throw new NotFoundException('Document not found.');     }      return document as TDocument;   }    async findOneAndUpdate(filterQuery: FilterQuery<TDocument>, update: UpdateQuery<TDocument>) {     const document = await this.model.findOneAndUpdate(filterQuery, update, {       lean: true,       new: true     });      if (!document) {       this.logger.warn(`Document not found with filterQuery:`, filterQuery);       throw new NotFoundException('Document not found.');     }      return document;   }    async find(filterQuery: FilterQuery<TDocument>) {     return this.model.find(filterQuery, {}, { lean: true });   }    async deleteOne(filterQuery: FilterQuery<TDocument>): Promise<void> {     const result = await this.model.deleteOne(filterQuery);      if (result.deletedCount === 0) {       this.logger.warn('No document found for deletion with filterQuery', filterQuery);       // throw new NotFoundException('No document found for deletion.');     }   }    async deleteMany(filterQuery: FilterQuery<TDocument>): Promise<void> {     const result = await this.model.deleteMany(filterQuery);      if (result.deletedCount === 0) {       this.logger.warn('No documents found for deletion with filterQuery', filterQuery);       // throw new NotFoundException('No documents found for deletion.');     }   }   // eslint-disable-next-line @typescript-eslint/no-explicit-any  async aggregate(pipeline: any[]): Promise<any[]> {     return this.model.aggregate(pipeline);   } } ```  ### database/database.module.ts ```typescript import { env } from '@libs/shared/config'; import { Module } from '@nestjs/common'; import { MongooseModule } from '@nestjs/mongoose';  @Module({   imports: [     MongooseModule.forRootAsync({       useFactory: () => ({         uri: env.DB_URL       })     })   ] }) export class DatabaseModule {} ```  Update the `index.ts` file.  ```ts:index.ts export { AbstractRepository } from './lib/database/abstract.repository'; export { AbstractDocument } from './lib/database/abstract.schema'; export { DatabaseModule } from './lib/database/database.module'; export { AbstractModel } from './lib/model/abstract.model'; ```  This completes the setup for the first part of Nx, Nest.js, MongoDB, and Mongoose integration. Stay tuned for the next part where we will continue with the configuration and integration process.  [Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 2](/blog/55-nx-nestjs-mongodb-mongoose-part2/)"
    },
    "_id": "blog/54-nx-nestjs-mongodb-mongoose-part1.mdx",
    "_raw": {
      "sourceFilePath": "blog/54-nx-nestjs-mongodb-mongoose-part1.mdx",
      "sourceFileName": "54-nx-nestjs-mongodb-mongoose-part1.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/54-nx-nestjs-mongodb-mongoose-part1"
    },
    "type": "Post",
    "slug": "/blog/54-nx-nestjs-mongodb-mongoose-part1",
    "slugAsParams": "54-nx-nestjs-mongodb-mongoose-part1"
  },
  {
    "title": "Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 2",
    "description": "Part 2 of Nx Nest.js MongoDB Mongoose Integration - Generate todos, create modules, implement GraphQL models, repositories, DTOs, and MongoDB schemas for enhanced application efficiency. Stay tuned for a comprehensive configuration guide.",
    "date": "2023-11-18T00:00:00.000Z",
    "lastmod": "2023-11-18T00:00:00.000Z",
    "emoji": "ğŸ¥­",
    "tags": ["nx", "nestjs", "mongodb"],
    "published": true,
    "body": {
      "raw": " ## Introduction  Welcome to the second part of our tutorial series on setting up Nx, Nest.js, MongoDB, and Mongoose integration. In this installment, we will guide you through the process of generating the feature-sample-todos library using Nx, creating modules, resolvers, and services, and establishing MongoDB document schemas. Additionally, we'll cover the implementation of GraphQL models, repositories, DTOs, and updates to the service and resolver for the sample-todos feature. Follow the step-by-step instructions to seamlessly integrate these technologies, enhancing the scalability and efficiency of your application. Stay tuned for a comprehensive configuration and integration journey.  ## Generating Feature-Sample-Todos  To begin, generate the feature-sample-todos library using Nx:  ```bash npx nx generate @nx/js:library api-feature-sample-todos --directory=libs/api/mongoose/feature-sample-mongoose --importPath=@libs/api/mongoose/feature-sample-mongoose --tags=scope:api --bundler=swc  âœ” Which unit test runner would you like to use? Â· jest ```  ## Creating Module, Resolver, and Service  Now, create the module, resolver, and service for the sample-todos feature:  ```bash nx generate @nx/nest:module sample-todos --project=api-feature-sample-todos nx generate @nx/nest:resolver sample-todos --project=api-feature-sample-todos nx generate @nx/nest:service sample-todos --project=api-feature-sample-todos ```  Once the files are created, move them to the lib folder.  ## Creating MongoDB Document (Schema)  Create the document (schema) for MongoDB:  `libs/api/feature-sample-todos/src/lib/sample-todos/models/sample-todos.schema.ts`  ```typescript import { AbstractDocument } from '@libs/api/mongoose/shared'; import { Prop, Schema, SchemaFactory } from '@nestjs/mongoose';  @Schema({ versionKey: false }) export class SampleTodoDocument extends AbstractDocument {   @Prop()   content!: string;    @Prop()   editing!: boolean;    @Prop()   completed!: boolean; }  export const SampleTodoSchema = SchemaFactory.createForClass(SampleTodoDocument); ```  ## Creating GraphQL Model  Create the model for GraphQL:  `libs/api/feature-sample-todos/src/lib/sample-todos/models/sample-todos.model.ts`  ```typescript import { AbstractModel } from '@libs/api/mongoose/shared'; import { Field, ObjectType } from '@nestjs/graphql';  @ObjectType() export class SampleTodo extends AbstractModel {   @Field()   readonly content!: string;    @Field()   readonly editing!: boolean;    @Field()   readonly completed!: boolean; } ```  ## Creating Repository  Create the repository for sample-todos:  `libs/api/feature-sample-todos/src/lib/sample-todos/sample-todos.repository.ts`  ```typescript import { AbstractRepository } from '@libs/api/mongoose/shared'; import { Injectable, Logger } from '@nestjs/common'; import { InjectModel } from '@nestjs/mongoose'; import { Model } from 'mongoose'; import { SampleTodo } from './models/sample-todo.model'; import { SampleTodoDocument } from './models/sample-todo.schema';  @Injectable() export class SampleTodosRepository extends AbstractRepository<SampleTodoDocument> {   protected readonly logger = new Logger(SampleTodosRepository.name);    constructor(     @InjectModel(SampleTodo.name)     SampleTodoModel: Model<SampleTodoDocument>   ) {     super(SampleTodoModel);   } } ```  ## Creating DTOs  Create the DTOs for sample-todos:  ### Args  `libs/api/feature-sample-todos/src/lib/sample-todos/dto/args/get-sample-todos-args.dto.ts`  ```typescript import { ArgsType, Field } from '@nestjs/graphql'; import { IsNotEmpty, IsString } from 'class-validator';  @ArgsType() export class GetSampleTodoArgs {   @Field()   @IsNotEmpty()   @IsString()   _id!: string; } ```  ### Inputs  `libs/api/feature-sample-todos/src/lib/sample-todos/dto/input/create-sample-todos-input.dto.ts`  ```typescript import { Field, InputType } from '@nestjs/graphql'; import { IsBoolean, IsString } from 'class-validator';  @InputType() export class CreateSampleTodoInput {   @Field()   @IsString()   content!: string;    @Field()   @IsBoolean()   editing!: boolean;    @Field()   @IsBoolean()   completed!: boolean; } ```  `libs/api/feature-sample-todos/src/lib/sample-todos/dto/input/delete-sample-todos-input.dto.ts`  ```typescript import { Field, InputType } from '@nestjs/graphql'; import { IsNotEmpty, IsString } from 'class-validator';  @InputType() export class DeleteSampleTodoInput {   @Field()   @IsNotEmpty()   @IsString()   _id!: string; } ```  `libs/api/feature-sample-todos/src/lib/sample-todos/dto/input/update-sample-todos-input.dto.ts`  ```typescript import { Field, InputType } from '@nestjs/graphql'; import { IsBoolean, IsNotEmpty, IsString } from 'class-validator';  @InputType() export class UpdateSampleTodoInput {   @Field()   @IsNotEmpty()   @IsString()   _id!: string;    @Field()   @IsString()   content!: string;    @Field()   @IsBoolean()   editing!: boolean;    @Field()   @IsBoolean()   completed!: boolean; } ```  ## Updating Service  Update the service for sample-todos:  `libs/api/feature-sample-todos/src/lib/sample-todos/sample-todos.service.ts`  ```typescript import { Injectable } from '@nestjs/common'; import { GetSampleTodoArgs } from './dto/args/get-sample-todo-args.dto'; import { CreateSampleTodoInput } from './dto/input/create-sample-todo-input.dto'; import { DeleteSampleTodoInput } from './dto/input/delete-sample-todo-input.dto'; import { UpdateSampleTodoInput } from './dto/input/update-sample-todo-input.dto'; import { SampleTodoDocument } from './models/sample-todo.schema'; import { SampleTodosRepository } from './sample-todos.repository';  @Injectable() export class SampleTodosService {   constructor(private readonly SampleTodoRepository: SampleTodosRepository) {}    async createSampleTodo(createSampleTodoData: CreateSampleTodoInput) {     const SampleTodoDocument = await this.SampleTodoRepository.create({       ...createSampleTodoData     });      return this.toModel(SampleTodoDocument);   }    async updateSampleTodo(updateSampleTodoData: UpdateSampleTodoInput) {     const SampleTodoDocument = await this.SampleTodoRepository.findOneAndUpdate(       { _id: updateSampleTodoData._id },       updateSampleTodoData     );     return this.toModel(SampleTodoDocument);   }    async deleteSampleTodo(deleteSampleTodoData: DeleteSampleTodoInput) {     return await this.SampleTodoRepository.deleteOne({       _id: deleteSampleTodoData._id     });   }    async getSampleTodos() {     const SampleTodoDocument = await this.SampleTodoRepository.find({});     return SampleTodoDocument.map((todo) => this.toModel(todo));   }    async getSampleTodo(getSampleTodoArgs: GetSampleTodoArgs) {     const SampleTodoDocument = await this.SampleTodoRepository.findOne({       ...getSampleTodoArgs     });     return this.toModel(SampleTodoDocument);   }    private toModel(SampleTodoDocument: SampleTodoDocument) {     return {       // eslint-disable-next-line @typescript-eslint/ban-ts-comment       //@ts-ignore       _id: SampleTodoDocument._id.toHexString(),       ...SampleTodoDocument     };   } } ```  ## Updating Resolver  Update the resolver for sample-todos:  `libs/api/feature-sample-todos/src/lib/sample-todos/sample-todos.resolver.ts`  ```typescript import { Args, Mutation, Query, Resolver } from '@nestjs/graphql'; import { GetSampleTodoArgs } from './dto/args/get-sample-todo-args.dto'; import { CreateSampleTodoInput } from './dto/input/create-sample-todo-input.dto'; import { DeleteSampleTodoInput } from './dto/input/delete-sample-todo-input.dto'; import { UpdateSampleTodoInput } from './dto/input/update-sample-todo-input.dto'; import { SampleTodo } from './models/sample-todo.model'; import { SampleTodosService } from './sample-todos.service';  @Resolver() export class SampleTodosResolver {   constructor(private readonly SampleTodoService: SampleTodosService) {}    @Mutation(() => SampleTodo, { name: 'createSampleTodo' })   async createSampleTodo(     @Args('createSampleTodoData')     createSampleTodoData: CreateSampleTodoInput   ) {     return await this.SampleTodoService.createSampleTodo(createSampleTodoData);   }    @Mutation(() => SampleTodo, { name: 'updateSampleTodo' })   async updateSampleTodo(     @Args('updateSampleTodoData')     updateSampleTodoData: UpdateSampleTodoInput   ) {     return this.SampleTodoService.updateSampleTodo(updateSampleTodoData);   }    @Mutation(() => SampleTodo, { name: 'deleteSampleTodo', nullable: true })   async deleteSampleTodo(     @Args('deleteSampleTodoData')     deleteSampleTodoData: DeleteSampleTodoInput   ) {     return this.SampleTodoService.deleteSampleTodo(deleteSampleTodoData);   }    @Query(() => [SampleTodo], { name: 'sampleTodos' })   async getSampleTodos() {     return this.SampleTodoService.getSampleTodos();   }    @Query(() => SampleTodo, { name: 'sampleTodo' })   async getSampleTodo(@Args() getSampleTodoArgs: GetSampleTodoArgs) {     return this.SampleTodoService.getSampleTodo(getSampleTodoArgs);   } } ```  ## Updating Module  Update the module for sample-todos:  `libs/api/feature-sample-todos/src/lib/sample-todos/sample-todos.module.ts`  * Add MongooseModule. * Add SampleMongooseTableRepository to providers.  ```typescript import { Module } from '@nestjs/common'; import { MongooseModule } from '@nestjs/mongoose'; import { SampleTodo } from './models/sample-todo.model'; import { SampleTodoSchema } from './models/sample-todo.schema'; import { SampleTodosRepository } from './sample-todos.repository'; import { SampleTodosResolver } from './sample-todos.resolver'; import { SampleTodosService } from './sample-todos.service';  @Module({   imports: [     MongooseModule.forFeature([       {         name: SampleTodo.name,         schema: SampleTodoSchema       }     ])   ],   providers: [SampleTodosResolver, SampleTodosService, SampleTodosRepository] }) export class SampleTodosModule {} ```  ## Updating app.module.ts  Update the app.module.ts file in the apps/api/src/app/ directory:  * Add DatabaseModule. * Add SampleTodosModule.  ```typescript @Module({   imports: [     ServeStaticModule.forRoot({       rootPath: join(__dirname, '..', 'web/.next'),       exclude: ['/api/*', '/api/graphql']     }),     GraphQLModule.forRoot<ApolloDriverConfig>({       driver: ApolloDriver,       path: '/api/graphql',       autoSchemaFile: true     }),     // ---- Graphql ---- //     // When using Mongoose, the DatabaseModule is required.     DatabaseModule,     SampleTodosModule   ],   controllers: [AppController],   providers: [AppService] }) export class AppModule {} ```  Stay tuned for the next part as we continue configuring and integrating Nx, Nest.js, MongoDB, and Mongoose for a robust development experience.  [Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 3](/blog/56-nx-nestjs-mongodb-mongoose-part3/)"
    },
    "_id": "blog/55-nx-nestjs-mongodb-mongoose-part2.mdx",
    "_raw": {
      "sourceFilePath": "blog/55-nx-nestjs-mongodb-mongoose-part2.mdx",
      "sourceFileName": "55-nx-nestjs-mongodb-mongoose-part2.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/55-nx-nestjs-mongodb-mongoose-part2"
    },
    "type": "Post",
    "slug": "/blog/55-nx-nestjs-mongodb-mongoose-part2",
    "slugAsParams": "55-nx-nestjs-mongodb-mongoose-part2"
  },
  {
    "title": "Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 3",
    "description": "Part 3 of Nx Nest.js GraphQL Integration - Install packages, update configs, generate GraphQL client for seamless integration. Enhance data management and scalability. Congrats on completing this guide to harmonious Nx, Nest.js, GraphQL integration! Stay tuned for more tutorials.",
    "date": "2023-11-19T00:00:00.000Z",
    "lastmod": "2023-12-02T00:00:00.000Z",
    "emoji": "ğŸ¥­",
    "tags": ["nx", "nestjs", "mongodb"],
    "published": true,
    "body": {
      "raw": " ## Introduction  Welcome to the third part of our Nx Nest.js GraphQL Integration series, where we enhance our project by incorporating GraphQL. Follow these steps to seamlessly install essential packages, update the `app.module.ts` file, generate the `data-access-graphql` project, and utilize GraphQL code generation. We'll guide you through creating a GraphQL client and demonstrate its usage in a Next.js web application.  ## Reference URL  [Engilaboo Next.js GraphQL Tutorial](https://www.engilaboo.com/nextjs-graphql/)  ## Install Packages  ```bash npm i @graphql-codegen/typed-document-node @graphql-codegen/cli @graphql-codegen/typescript-operations @apollo/client @graphql-codegen/client-preset ```  ## Update app.module.ts in Nest.js Project  Add the following code:  ```typescript @Module({   imports: [     ServeStaticModule.forRoot({       rootPath: join(__dirname, '..', 'web/.next'),       exclude: ['/api/*', '/api/graphql']     }),     GraphQLModule.forRoot<ApolloDriverConfig>({       driver: ApolloDriver,       path: '/api/graphql',       autoSchemaFile: path.join(__dirname, './autogenerated-schema.gql')     }), ```  By doing so, the `autogenerated-schema.gql` is created in the `dist/apps/api` folder after building the API.  ## Generate data-access-graphql Project  ```bash npx nx generate @nx/js:library data-access-graphql --directory=libs/web/data-access-graphql --importPath=@libs/web/data-access-graphql --tags=scope:web --bundler=swc  âœ” Which unit test runner would you like to use? Â· none ```  ## Create codegen.yml  `tools/graphql-codegen/codegen.ts`  ```ts import type { CodegenConfig } from '@graphql-codegen/cli';  const codegenConfig: CodegenConfig = {   overwrite: true,   schema: 'dist/apps/api/autogenerated-schema.gql',   documents: ['apps/web/**/*.graphql', 'libs/**/*.graphql'],   generates: {     'libs/web/data-access-graphql/src/lib/__generated__/': {       preset: 'client',       plugins: [         {           // branded type for custom Scalar           add: {             content: `export type DateString = string & { readonly __brand: unique symbol }`           }         }       ],       config: {         strictScalars: true,         useTypeImports: true,         skipTypename: true,         arrayInputCoercion: true,         avoidOptionals: {           field: true,           inputValue: false,           object: true,           defaultValue: false         },         scalars: {           Date: 'DateString'         },         enumsAsTypes: true       }     }   } };  export default codegenConfig; ```  ## Run Codegen  Add script to package.json  ```json    \"scripts\": {     \"start:gql:watch\": \"graphql-codegen --config tools/graphql-codegen/codegen.ts --watch\", ```  ## Create Client for Web  1. Create apollo-client.ts  `apps/web/lib/apollo-client.ts`  > In this case, `apps/web` is a Next.js project.  ```typescript import { NEXT_PUBLIC_API_GQL_URL } from '@/config/index'; import { ApolloClient, InMemoryCache } from '@apollo/client';  // If env.NEXT_PUBLIC_API_GQL_URL is undefined, throw exeption. if (!NEXT_PUBLIC_API_GQL_URL) {   throw new Error('NEXT_PUBLIC_API_GQL_URL is undefined'); }  export const apolloClient = new ApolloClient({   uri: NEXT_PUBLIC_API_GQL_URL,   cache: new InMemoryCache(),   credentials: 'include' }); ```  2. Create ApolloProvider  `apps/web/lib/apollo-client.ts`  ```typescript 'use client';  import { apolloClient } from '@/lib/apollo-client'; import { ApolloProvider as Apollo } from '@apollo/client';  const ApolloProvider = ({ children }: React.PropsWithChildren) => {   return <Apollo client={apolloClient}>{children}</Apollo>; };  export default ApolloProvider; ```  3. Update `tsconfig.base.json`  ```json     \"paths\": {       \"@/lib/*\": [         \"apps/web/lib/*\"       ], ```  4. Set ApolloProvider  `apps/web/app/layout.tsx`  ```tsx import ApolloProvider from '@/components/providers/ApolloProvider'; ...  export default async function RootLayout({ children }: { children: ReactNode }) {   return (     <html suppressHydrationWarning>       <head>         ...       </head>        <body className=\"overflow-x-hidden bg-white text-black antialiased dark:bg-gray-900 dark:text-white\">         <ApolloProvider>           ...         </ApolloProvider>       </body>     </html>   ); } ```  ## Use graphql  Example:  1. Create graphql file  `todo.graphql`  ```graphql query getSampleTodos {   sampleTodos {     _id     content     editing     completed   } } ```  2. Use useQuery  ```tsx import { useQuery } from '@apollo/client'; import { GetSampleTodosDocument } from '@libs/web/data-access-graphql';  export default async function page() {   const { data, loading, error } = useQuery(GetSampleTodosDocument);    return <div>{data.GetSampleTodosDocument.map((x) => x._id)}</div>; } ```  Congratulations! You've successfully configured Nx, Nest.js, and GraphQL in a harmonious integration. This series has empowered you to efficiently manage and query data, making your application more robust and scalable. Stay tuned for more insightful tutorials and happy coding!  The first part is here.  [Setting Up Nx Nestjs Mongodb Mongoose Integration - Part 1](/blog/54-nx-nestjs-mongodb-mongoose-part1/) "
    },
    "_id": "blog/56-nx-nestjs-mongodb-mongoose-part3.mdx",
    "_raw": {
      "sourceFilePath": "blog/56-nx-nestjs-mongodb-mongoose-part3.mdx",
      "sourceFileName": "56-nx-nestjs-mongodb-mongoose-part3.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/56-nx-nestjs-mongodb-mongoose-part3"
    },
    "type": "Post",
    "slug": "/blog/56-nx-nestjs-mongodb-mongoose-part3",
    "slugAsParams": "56-nx-nestjs-mongodb-mongoose-part3"
  },
  {
    "title": "Reactã¨dnd-kit/coreã‚’ä½¿ç”¨ã—ã¦ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒªã‚¹ãƒˆã‚’ä½œæˆ",
    "description": "Reactã¨dnd-kit/coreã‚’ä½¿ç”¨ã—ã¦ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ãƒªã‚¹ãƒˆã‚’å®Ÿè£…ã€‚åŸºæœ¬çš„ãªã‚³ãƒ¼ãƒ‰ã¨ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã®è§£èª¬ã‚’æä¾›",
    "date": "2024-01-30T00:00:00.000Z",
    "lastmod": "2024-01-30T00:00:00.000Z",
    "emoji": "â›„",
    "tags": ["react"],
    "published": true,
    "body": {
      "raw": " ![image](/blog/57/1-sample.gif)  ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã¯ã€ç¾ä»£ã®Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã‚ˆãè¦‹ã‚‰ã‚Œã‚‹æ©Ÿèƒ½ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ã‚¤ãƒ†ãƒ ã‚’ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ã«ä¸¦ã¹æ›¿ãˆã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€`dnd-kit/core`ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨ã—ã¦Reactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã«ã¤ã„ã¦æ¢ã‚Šã¾ã™ã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ä¸»è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®ç°¡å˜ãªãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚  ## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—  å®Ÿè£…ã«å…¥ã‚‹å‰ã«ã€å¿…è¦ãªä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚Reactãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§`@dnd-kit/core`ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚  ```bash npm i @dnd-kit/core @dnd-kit/sortable ```  ã“ã“ã‹ã‚‰ã¯ã€ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªãƒªã‚¹ãƒˆã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚  ## DraggableListã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ä½œæˆ  `DraggableList`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®ã‚³ãƒ³ãƒ†ãƒŠã¨ã—ã¦æ©Ÿèƒ½ã—ã¾ã™ã€‚`DraggableList.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š  `DraggableList.tsx(DraggableList)`  ```tsx import {   DndContext,   KeyboardSensor,   PointerSensor,   UniqueIdentifier,   closestCenter,   useSensor,   useSensors } from '@dnd-kit/core'; import {   SortableContext,   horizontalListSortingStrategy,   rectSortingStrategy,   sortableKeyboardCoordinates,   useSortable,   verticalListSortingStrategy } from '@dnd-kit/sortable'; import { CSS } from '@dnd-kit/utilities'; import { ComponentProps, FC, ReactNode, useMemo } from 'react';  export interface HasId {   id: UniqueIdentifier; }  type Props<T extends HasId> = {   items: T[];   onDragStart?: ComponentProps<typeof DndContext>['onDragStart'];   onDragEnd?: ComponentProps<typeof DndContext>['onDragEnd'];   onDragOver?: ComponentProps<typeof DndContext>['onDragOver'];   layout: 'horizontal' | 'vertical' | 'grid';   children: ReactNode; }; // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯èƒ½ãªãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ  export const DraggableList: FC<Props<HasId>> = ({   items,   onDragStart,   onDragEnd,   onDragOver,   layout,   children }) => {   // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹æ™‚ã«è¨±å¯ã™ã‚‹å…¥åŠ›   const sensors = useSensors(     useSensor(PointerSensor),     useSensor(KeyboardSensor, {       coordinateGetter: sortableKeyboardCoordinates     })   );    // ãƒªã‚¹ãƒˆã®ç¨®é¡   const strategy = useMemo(() => {     switch (layout) {       case 'horizontal':         return horizontalListSortingStrategy;       case 'vertical':         return verticalListSortingStrategy;       case 'grid':       default:         return rectSortingStrategy;     }   }, [layout]);    return (     <DndContext       sensors={sensors}       collisionDetection={closestCenter}       onDragStart={onDragStart}       onDragEnd={onDragEnd}       onDragOver={onDragOver}     >       <SortableContext items={items} strategy={strategy}>         <ul>{children}</ul>       </SortableContext>     </DndContext>   ); }; ```  ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ã€`@dnd-kit/core`ã«ã‚ˆã£ã¦æä¾›ã•ã‚Œã‚‹`DndContext`ã¨`SortableContext`ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ã€‚ã¾ãŸã€ãƒªã‚¹ãƒˆå†…ã®å„ã‚¢ã‚¤ãƒ†ãƒ ã‚’ãƒ©ãƒƒãƒ—ã™ã‚‹`DraggableItem`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®šç¾©ã—ã¦ã„ã¾ã™ã€‚  ## ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®æ§‹ç¯‰  ãƒªã‚¹ãƒˆå†…ã®å„ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã¯ã€`DraggableItem`ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§è¡¨ã•ã‚Œã¾ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³ã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«`DraggableHandle`ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š  `DraggableList.tsx(DraggableItem)`  ```tsx // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯èƒ½ãªãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ  export const DraggableItem: FC<{   id: HasId['id'];   children: ReactNode; }> = ({ id, children }) => {   const { setNodeRef, transform, transition } = useSortable({ id });    const style = {     transform: CSS.Transform.toString(transform),     transition   };    return (     <li ref={setNodeRef} style={style}>       {children}     </li>   ); };  // MyDraggableItemã‚’ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—ã™ã‚‹ãŸã‚ã®ãƒãƒ³ãƒ‰ãƒ« export const DraggableHandle: FC<{   id: HasId['id'];   children: ReactNode; }> = ({ id, children }) => {   const { attributes, listeners } = useSortable({ id });    return (     <div {...attributes} {...listeners}>       {children}     </div>   ); }; ```  ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯`@dnd-kit/core`ã‹ã‚‰ã®`useSortable`ãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã®å‹•ä½œã‚’å‡¦ç†ã—ã¾ã™ã€‚  ## Pageã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã‚’å®Ÿè£…  ãƒ¡ã‚¤ãƒ³ã®ãƒšãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆ`page.tsx`ï¼‰ã§ã¯ã€`DraggableList`ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ä½¿ç”¨ã—ã€è£½å“ã®ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ã„ã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š  > Nextjs ã‚’åˆ©ç”¨ã—ãŸãŸã‚ã€`page.tsx`ãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ã„ã¾ã™ãŒã€é€šå¸¸ã®Reactã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§ã‚‚åˆ©ç”¨å¯èƒ½ã§ã™ã€‚  ```jsx 'use client';  import { DragEndEvent, DragStartEvent } from '@dnd-kit/core'; import { faBars } from '@fortawesome/free-solid-svg-icons'; import { FontAwesomeIcon } from '@fortawesome/react-fontawesome'; import { FC, useCallback, useState } from 'react'; import { DraggableHandle, DraggableItem, DraggableList } from './_components/DraggableList';  // ãƒªã‚½ãƒ¼ã‚¹:å•†å“ã®å‹ type Product = {   id: string;   name: string;   price: number; };  const Products = [   {     id: '1',     name: 'å•†å“1',     price: 100   },   {     id: '2',     name: 'å•†å“2',     price: 200   },   {     id: '3',     name: 'å•†å“3',     price: 300   } ];  // å•†å“ã‚’è¡¨ç¤ºã™ã‚‹ãƒªã‚¹ãƒˆã‚¢ã‚¤ãƒ†ãƒ  const ProductItem: FC<{   product: Product; }> = ({ product }) => (   <DraggableItem id={product.id}>     <div className=\"m-4 h-[100px] w-[200px] items-center rounded-md border-2 p-2 shadow-sm\">       <div className=\"flex space-x-4\">         <DraggableHandle id={product.id}>           <FontAwesomeIcon icon={faBars} className=\"m-4\" size=\"lg\" />         </DraggableHandle>         <p>{product.name}</p>         <p>Â¥ {product.price}</p>       </div>     </div>   </DraggableItem> );  // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯èƒ½ãªå•†å“ãƒªã‚¹ãƒˆ const Page = () => {   // ä¸€è¦§è¡¨ç¤ºã™ã‚‹å•†å“ç¾¤   const [products, setProducts] = useState<Product[]>(Products);    const onDragStart = useCallback((e: DragStartEvent) => {     console.log('onDragStart', e);   }, []);    const onDragEnd = useCallback((e: DragEndEvent) => {     console.log('onDragEnd', e);   }, []);    return (     <DraggableList       items={products}       onDragStart={onDragStart}       onDragEnd={onDragEnd}       layout={'vertical'}     >       {products.map((product) => (         <ProductItem key={product.id} product={product} />       ))}     </DraggableList>   ); };  export default Page; ```  ã“ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯è£½å“ã®ãƒªã‚¹ãƒˆã‚’è¡¨ç¤ºã—ã€`onDragStart`ãŠã‚ˆã³`onDragEnd`ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯ã¯é–¢é€£ã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã«è¨˜éŒ²ã—ã¾ã™ã€‚  ## ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º  ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³ã«åŸºã¥ã„ã¦ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªã‚¢ã‚¤ãƒ†ãƒ ã®ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã‚’è‡ªç”±ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºã—ã¦ãã ã•ã„ã€‚æä¾›ã•ã‚ŒãŸã‚³ãƒ¼ãƒ‰ã«ã¯ã€Tailwind CSSã‚’ä½¿ç”¨ã—ãŸåŸºæœ¬çš„ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚  ## ã¾ã¨ã‚  ã“ã®ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã§ã¯ã€`react`ã¨`@dnd-kit/core`ã‚’ä½¿ç”¨ã—ã¦ç°¡å˜ãªãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãªãƒªã‚¹ãƒˆã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã®ç›¸äº’ä½œç”¨ã‚’å‡¦ç†ã™ã‚‹ãŸã‚ã®å …ç‰¢ãªãƒ„ãƒ¼ãƒ«ã‚»ãƒƒãƒˆã‚’æä¾›ã—ã¦ãŠã‚Šã€ã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ã‚¯ã‚¹ãƒšãƒªã‚¨ãƒ³ã‚¹ã‚’ç°¡å˜ã«ä½œæˆã§ãã¾ã™ã€‚  ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã€ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ©ãƒƒã‚°ãƒãƒ³ãƒ‰ãƒ«ãªã©ã€ã“ã®å®Ÿè£…ã‚’ã•ã‚‰ã«å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚è¿½åŠ ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚„å¯èƒ½æ€§ã«ã¤ã„ã¦ã¯ã€`@dnd-kit/core`ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’æ¢ç´¢ã—ã¦ãã ã•ã„ã€‚"
    },
    "_id": "blog/57-react-draggable-list.mdx",
    "_raw": {
      "sourceFilePath": "blog/57-react-draggable-list.mdx",
      "sourceFileName": "57-react-draggable-list.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/57-react-draggable-list"
    },
    "type": "Post",
    "slug": "/blog/57-react-draggable-list",
    "slugAsParams": "57-react-draggable-list"
  },
  {
    "title": "C# WPFã§ObservableCollectionã‚’éåŒæœŸã§æ›´æ–°ã™ã‚‹æ–¹æ³•",
    "description": "WPFã§éåŒæœŸæ›´æ–°å¯èƒ½ãªObservableCollectionã‚’å®Ÿè£…ã€‚AsyncObservableCollectionã¨PageMstCollectionã®ä¾‹ã‚’ç´¹ä»‹",
    "date": "2024-01-30T00:00:00.000Z",
    "lastmod": "2024-01-30T00:00:00.000Z",
    "emoji": "ğŸ±",
    "tags": ["csharp"],
    "published": true,
    "body": {
      "raw": " äº†è§£ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã¯ã€`AsyncObservableCollection`ã®å‡¦ç†ã‚’`PageMstCollection`ã«çµ±åˆã—ãŸå ´åˆã®è¨˜äº‹ã«ãªã‚Šã¾ã™ã€‚  ---  WPFã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€UIã‚¹ãƒ¬ãƒƒãƒ‰ã¨ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¹ãƒ¬ãƒƒãƒ‰ã®é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’åŒæœŸã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ãã®ãŸã‚ã€éåŒæœŸã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€UIã«åæ˜ ã™ã‚‹ãŸã‚ã®ObservableCollectionã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®è¨˜äº‹ã§ã¯ã€ãã®æ–¹æ³•ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚  ## ObservableCollectionã®éåŒæœŸæ›´æ–°  WPFã§ã¯ã€UIã¸ã®å¤‰æ›´ã¯UIã‚¹ãƒ¬ãƒƒãƒ‰ã§è¡Œã‚ãªã‘ã‚Œã°ãªã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€éåŒæœŸå‡¦ç†ã‚’è¡Œã„ã¤ã¤UIã‚’æ›´æ–°ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆã€`BindingOperations.EnableCollectionSynchronization`ã¨`lockæ–‡`ã‚’ä½¿ã†ã“ã¨ã§ç°¡å˜ã«å®Ÿç¾ã§ãã¾ã™ã€‚  ```csharp public class PageMstCollection : ObservableCollection<PageMstViewModelEntity> {     private readonly object _lock = new object();     private readonly IPageMstRepository _pageMstRepository;      public PageMstCollection(IPageMstRepository pageMstRepository)     {         _pageMstRepository = pageMstRepository;         BindingOperations.EnableCollectionSynchronization(this, _lock);     }      public async Task LoadDataAsync()     {         var newData = await Task.Run(() =>         {             return _pageMstRepository.GetData().Select(entity => new PageMstViewModelEntity(entity));         });          lock (_lock)         {             Clear();             foreach (var item in newData)             {                 Add(item);             }         }     } } ```  ã“ã®ã‚¯ãƒ©ã‚¹ã§ã¯ã€`LoadDataAsync`ãƒ¡ã‚½ãƒƒãƒ‰å†…ã§`_pageMstRepository`ã‹ã‚‰éåŒæœŸã«ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€`lock`æ–‡ã‚’ä½¿ç”¨ã—ã¦UIã‚¹ãƒ¬ãƒƒãƒ‰ã§å®‰å…¨ã«`ObservableCollection`ã‚’æ›´æ–°ã—ã¦ã„ã¾ã™ã€‚  ## ViewModelã®ä½¿ç”¨ä¾‹  æœ€å¾Œã«ã€ã“ã‚Œã‚‰ã®ã‚¯ãƒ©ã‚¹ã‚’ViewModelã§ä½¿ç”¨ã™ã‚‹ä¾‹ã‚’ç¤ºã—ã¾ã™ã€‚  ```csharp public class MainViewModel : ViewModelBase {     private readonly PageMstCollection _pageMstCollection;      public MainViewModel(IPageMstRepository pageMstRepository)     {         _pageMstCollection = new PageMstCollection(pageMstRepository);         LoadData();     }      private async void LoadData()     {         await _pageMstCollection.LoadDataAsync();         OnPropertyChanged(nameof(PageMstCollection));     }      public ObservableCollection<PageMstViewModelEntity> PageMstCollection => _pageMstCollection; } ```  ViewModelã§`LoadDataAsync`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ã§ã€ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã§ãƒ‡ãƒ¼ã‚¿ã‚’éåŒæœŸã«èª­ã¿è¾¼ã¿ã€UIã«åæ˜ ã§ãã¾ã™ã€‚`OnPropertyChanged`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€`PageMstCollection`ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã®å¤‰æ›´ã‚’é€šçŸ¥ã—ã¾ã™ã€‚  ã“ã‚Œã§ã€éåŒæœŸã§ãƒ‡ãƒ¼ã‚¿ã‚’æ›´æ–°ã™ã‚‹ObservableCollectionã‚’ä½œæˆã—ã€WPFã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ä½¿ç”¨ã™ã‚‹æ–¹æ³•ãŒã‚ã‹ã‚Šã¾ã—ãŸã€‚"
    },
    "_id": "blog/58-wpf-async-observablecollection.mdx",
    "_raw": {
      "sourceFilePath": "blog/58-wpf-async-observablecollection.mdx",
      "sourceFileName": "58-wpf-async-observablecollection.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/58-wpf-async-observablecollection"
    },
    "type": "Post",
    "slug": "/blog/58-wpf-async-observablecollection",
    "slugAsParams": "58-wpf-async-observablecollection"
  },
  {
    "title": "Power Query | Creating a Calendar for a Specified Period Using Parameter Configuration (Power BI)",
    "description": "When using Power BI, there are instances where you might want to create a calendar based on dates. In this scenario, I'll explain how to automatically generate a calendar for a specified period, which can be quite useful.",
    "date": "2020-03-01T00:00:00.000Z",
    "emoji": "ğŸ“Š",
    "tags": ["powerbi"],
    "published": true,
    "body": {
      "raw": " When using Power BI, there are instances where you might want to create a calendar based on dates. In this scenario, I'll explain how to automatically generate a calendar for a specified period, which can be quite useful.  *Additional Note:* I found that creating the calendar using DAX allows for more flexibility in adding columns. This article serves as a reference for the procedure of utilizing parameters in queries.  ## Calendar Generation Workflow  The steps involve the following workflow:  â‘  Parameter Configuration (Considering Multiple Modes)   ã€€â†“   â‘¡ Fetching Dates Based on Different Modes   ã€€â†“   â‘¢ Creating the Calendar    ## Parameter Configuration  For this case, the parameters to be configured are as follows:  ![image](/blog/6/create_calendar.png)  Although it's just specifying a date range, I've added a mode selection feature to accommodate multiple patterns for user convenience.  ### â‘  Date Specification Mode  This mode creates a calendar for the specified start and end dates.  â–¼ Parameter Configuration (Prerequisite)   A_DATE_MODE = 0    â–¼ Parameter Configuration (Items Requiring Configuration)   B_START_DATE = Any YYYYMMDD [e.g., 20200101]   C_END_DATE = Any YYYYMMDD [e.g., 20200131]    ### â‘¡ Days Ago Mode  This mode creates a calendar starting from today's date and going back a specified number of days.  â–¼ Parameter Configuration (Prerequisite)   A_DATE_MODE = 1    â–¼ Parameter Configuration (Items Requiring Configuration)   D_DAYS_AGO = Number of days to go back from today [e.g., -5 (5 days ago)]   E_DAYS_LATER = Number of days to move forward from today [e.g., 2 (2 days later)]    ## Fetching Dates Based on Modes  To calculate dates corresponding to the aforementioned modes, the following approach is taken. The START_DATE and END_DATE are prepared for the later Calendar query.  ![image](/blog/6/template_query.png)  â–¼ Query: START_DATE  ```text let     // For A_date_mode = 0 (Date Specified)     start_date_0 = Date.FromText(Text.Start(B_START_DATE,4) & \",\" & Text.Middle(B_START_DATE,4,2) & \",\" & Text.End(B_START_DATE,2)),      // For A_date_mode = 1 (Days Ago)     now_1 = DateTime.LocalNow() ,     start_date_1 = DateTime.Date(Date.AddDays(now_1,D_DAYS_AGO)),      // For A_date_mode = 2 (Months Ago)     now_2 = DateTime.LocalNow() ,     start_month_2 = DateTime.Date(Date.AddMonths(now_2,F_MONTHS_AGO)),     start_date_2 = DateTime.Date(Date.AddDays(start_month_2,-Date.Day(start_month_2)+1)),      // Fetching date based on mode     start_date_ori = if A_DATE_MODE = 0 then start_date_0 else (if A_DATE_MODE = 1 then start_date_1 else start_date_2)  in     start_date_ori ```  â–¼ Query: END_DATE  ```text let     // For A_date_mode = 0 (Date Specified)     end_date_0 = Date.FromText(Text.Start(C_END_DATE,4) & \",\" & Text.Middle(C_END_DATE,4,2) & \",\" & Text.End(C_END_DATE,2)),      // For A_date_mode = 1 (Days Ago)     now_1 = DateTime.LocalNow() ,     end_date_1 = DateTime.Date(Date.AddDays(now_1,E_DAYS_LATER)),      // For A_date_mode = 2 (Months Ago)     now_2 = DateTime.LocalNow() ,     end_date_2 = DateTime.Date(Date.AddDays(now_2,E_DAYS_LATER)),      // Fetching date based on mode     end_date_ori = if A_DATE_MODE = 0 then end_date_0 else (if A_DATE_MODE = 1 then end_date_1 else end_date_2)  in     end_date_ori ```  Create an empty query and use the Advanced Editor to copy and paste the above code to make it usable.  ## Creating the Calendar  The calendar is created for the specified period based on the mode configured in the parameters.  â–¼ Query: Calendar  ```text let     Source = List.Generate(                     ()=>[Date=START_DATE, DayOfWeek=Date.DayOfWeekName(Date)],                     each [Date]<=END_DATE,                     each [Date=Date.AddDays([Date],1),DayOfWeek=Date.DayOfWeekName(Date)]              ),     Custom = Table.FromRecords(Source),     AddedCustom = Table.AddColumn(Custom, \"YearMonth\", each Number.ToText(Date.Year([Date])) & Text.PadStart(Number.ToText(Date.Month([Date])),2,\"0\")),     InsertedMonthWeek = Table.AddColumn(AddedCustom, \"MonthWeek\", each Date.WeekOfMonth([Date]), Int64.Type) in     InsertedMonthWeek ```  The result of this query will look something like this:  ![image](/blog/6/calendar_sample.png)  This concludes the process of generating a calendar for a specific period.  That's it! "
    },
    "_id": "blog/6-custom-calendar-power-query.mdx",
    "_raw": {
      "sourceFilePath": "blog/6-custom-calendar-power-query.mdx",
      "sourceFileName": "6-custom-calendar-power-query.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/6-custom-calendar-power-query"
    },
    "type": "Post",
    "slug": "/blog/6-custom-calendar-power-query",
    "slugAsParams": "6-custom-calendar-power-query"
  },
  {
    "title": "Power Query | How to Load Dynamic SQL Results (Power BI)",
    "description": "I'll explain how to dynamically execute SQL by linking SQL query conditions (e.g., within the WHERE clause) with Power Query parameters.",
    "date": "2020-03-02T00:00:00.000Z",
    "emoji": "ğŸ“Š",
    "tags": ["powerbi"],
    "published": true,
    "body": {
      "raw": " In Power Query, it's common to connect to a database and import SQL results into tables. But what if you want to easily change the SQL query's filtering conditions?  This time, I'll explain how to dynamically execute SQL by linking SQL query conditions (e.g., within the WHERE clause) with Power Query parameters.  ## Query for Executing Dynamic SQL  Here's an example query for executing dynamic SQL:  ```text let // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // SQL starts here sql1 = \" SELECT   * FROM   test_table WHERE   start_date >= '__start_date__' AND start_date <= '__end_date__' \", // SQL ends here // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----      // Replace SQL variables (e.g., __start_date__ and __end_date__)     sql2 = Text.Replace(sql1, \"__start_date__\", START_DATE),     sql3 = Text.Replace(sql2, \"__end_date__\", END_DATE),      sql = sql3, // Reassign it as 'sql' to prevent errors      Source = Oracle.Database(DB_NAME, [HierarchicalNavigation=true, Query=sql]) in     Source ```  In this example, the flow of operations is as follows:  ### â‘  sql1  ```txst // SQL starts here sql1 = \" SELECT   * FROM   test_table WHERE   start_date &gt;= '__start_date__' AND start_date &lt;= '__end_date__' \", // SQL ends here ```  This section contains the base SQL (enclosed within // ---). The parts you want to change dynamically are marked as variables (e.g., `__start_date__` and `__end_date__`).  ### â‘¡ sql2  ```text sql2 = Text.Replace(sql1, \"__start_date__\", START_DATE) ```  `sql2` replaces `__start_date__` in `sql1` with `START_DATE` (a parameter). In this example, `START_DATE` holds a string in the format YYYYMMDD.  ### â‘¢ sql3  ```text sql3 = Text.Replace(sql2, \"__end_date__\", END_DATE) ```  `sql3` replaces `__end_date__` in `sql2` with `END_DATE` (a parameter). In this example, `END_DATE` holds a string in the format YYYYMMDD.  ### â‘£ sql and Source  ```text     sql = sql3, // Reassign it as 'sql' to prevent errors      Source = Oracle.Database(DB_NAME, [HierarchicalNavigation=true, Query=sql]) ```  `sql3` is stored in `sql`, and then it's applied as an argument to the `Oracle.Database` function. In this example, `DB_NAME` holds the database name (schema).  ___  When you try this, make sure to prepare the necessary parameters and paste the code from an empty query into the Advanced Editor.  By changing parameter settings, you can dynamically modify the SQL extraction results. That's it!"
    },
    "_id": "blog/7-dynamic-sql-power-query.mdx",
    "_raw": {
      "sourceFilePath": "blog/7-dynamic-sql-power-query.mdx",
      "sourceFileName": "7-dynamic-sql-power-query.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/7-dynamic-sql-power-query"
    },
    "type": "Post",
    "slug": "/blog/7-dynamic-sql-power-query",
    "slugAsParams": "7-dynamic-sql-power-query"
  },
  {
    "title": "WSF | Executing Processing by Combining and Loading Multiple VBS Scripts (Batch, WSF, VBS Integration)",
    "description": "I will explain how to use it as a package to call multiple VBS files together using WSF.",
    "date": "2020-03-03T00:00:00.000Z",
    "emoji": "ğŸ–¥ï¸",
    "tags": ["wsf", "vbs"],
    "published": true,
    "body": {
      "raw": " WSF is an XML file that allows you to consolidate multiple scripts. This enables the reusability of VBS scripts created for various functions, making it extremely convenient. (Additionally, it allows coexistence of JScript and VBS.)  This time, I will explain how to use it as a package to call multiple VBS files together.  [**Source Code is here**](https://github.com/atman-33/template-vbs/tree/master/ExportCsvOracleWsf)  ## Package Structure  Similar to the functionality previously covered in the article [**ã€VBSã€‘Saving SELECT Results from Oracle DB to CSV**](/blog/5-oracle-db-to-csv-vbs) but using a combination of batch, WSF, and VBS, we will achieve the same functionality.  First, let's look at the package structure.  ![image](/blog/8/package.png)  â–¼ `wsf_oracledb_to_csv` Folder  ```text Main.bat               Main execution file OraclToCsv.wsf         File for loading various VBS Config.ini             File containing various configuration information sql                    SQL statements to extract data from the DB csv                    Folder to store CSV files extracted from the DB vbs                    Folder to store VBS classes and modules â”” common               Folder for common classes and modules    â”œ DatabaseOracle.vbs Oracle DB operation-related class    â”œ fso.vbs            Functions to manipulate files and folders    â”” ini.vbs            Functions to manipulate ini files ```  The WSF file is where VBS scripts are loaded together, allowing you to work with individual functions and classes.  ## Source Code Explanation  Now, let's explain the code for the WSF and BAT files (we'll skip the VBS files as they have already been explained in a separate article).  ### WSF File  WSF files are written in XML format.  In this example, we've referenced classes and functions from various VBS files required for DB connection and CSV output.  â–¼ `oracledb_to_csv.wsf`  ```wsf <job> <script language=\"vbscript\" src=\".\\vbs\\common\\ini.vbs\"/> <script language=\"vbscript\" src=\".\\vbs\\common\\fso.vbs\"/> <script language=\"vbscript\" src=\".\\vbs\\common\\DatabaseOracle.vbs\"/> <script language=\"vbscript\">      ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     ' brief: Save the results extracted from Oracle DB using a SELECT statement to a CSV     ' note:     ' ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----      ' Const INI_FILE = \"Config.ini\"     ' Ini file name (can be specified in the BAT file)      Dim SQL_FOLDER_PATH, CSV_FOLDER_PATH     Dim SDB_PROVIDER, SDB_DATA_SOURCE, SDB_USER, SDB_PASS      Dim ini     ' ini = GetCurrentDirectory() & \"\\\" & INI_FILE     ini = GetCurrentDirectory() & \"\\\" & Wscript.Arguments(0)      ' #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####     ' 0. Read the INI file â€» Save it in the same folder as the executing VBS file     SDB_PROVIDER = GetIniData(ini, \"source_db\", \"provider\")     SDB_DATA_SOURCE = GetIniData(ini, \"source_db\", \"data_source\")     SDB_USER = GetIniData(ini, \"source_db\", \"user_id\")     SDB_PASS = GetIniData(ini, \"source_db\", \"password\")      SQL_FOLDER_PATH = GetCurrentDirectory() & \"\\\" & GetIniData(ini, \"path\", \"sql_folder\")     CSV_FOLDER_PATH = GetCurrentDirectory() & \"\\\" & GetIniData(ini, \"path\", \"csv_folder\")     ' #### #### #### #### #### #### #### #### #### #### #### #### #### #### ####      Dim objDBOracle     ' Oracle connection class     Dim strSQLFiles     ' Group of SQL files to execute     Dim strSQLFile      ' SQL file to execute     Dim strSQL          ' SQL to execute     Dim objAdoRS        ' ADO Recordset     Dim csvText         ' CSV text content obtained from SELECT using SQL      WScript.Echo \"Processing started.\"      ' 1. DB connection     Set objDBOracle = New DatabaseOracle     objDBOracle.OpenDBOracle SDB_PROVIDER, SDB_DATA_SOURCE, SDB_USER, SDB_PASS      ' 2. Read SQL files     strSQLFiles = GetFileNames(SQL_FOLDER_PATH)      ' 3. Generate CSV     For Each strSQLFile In strSQLFiles         WScript.Echo strSQLFile         strSQL = GetFileText(strSQLFile)         objDBOracle.excuteSQLgetRS strSQL         csvText = objDBOracle.getCSVTextFromRS()          writeFile CSV_FOLDER_PATH & \"\\\" & GetBaseName(strSQLFile), csvText, \"csv\"     Next      ' 4. Disconnect from DB     objDBOracle.closeDB     Set objDBOracle = Nothing      WScript.Echo \"Processing completed.\"  </script> </job> ```  As shown above, you can load multiple VBS files within a WSF file, and you can also directly include VBS scripts in the WSF file itself.  ### BAT File  â–¼ `main.bat`  ```batch @echo off  rem To use variables within if and for loops, you can use ! instead of % @setlocal enabledelayedexpansion  rem ---- Configuration ---- set script=OracleToCsv.wsf set ini=Config.ini  cd %~dp0 Cscript %script% %ini%  pause ```  With this setup, the message boxes won't appear when launching the WSF file, and the processing will proceed as intended.\" "
    },
    "_id": "blog/8-call-vbs-wsf.mdx",
    "_raw": {
      "sourceFilePath": "blog/8-call-vbs-wsf.mdx",
      "sourceFileName": "8-call-vbs-wsf.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/8-call-vbs-wsf"
    },
    "type": "Post",
    "slug": "/blog/8-call-vbs-wsf",
    "slugAsParams": "8-call-vbs-wsf"
  },
  {
    "title": "JavaScript | Sample of a Shooting Game Using CreateJS and Classes",
    "description": "I tried creating a 'shooting game' using CreateJS and classes (object-oriented).",
    "date": "2020-03-06T00:00:00.000Z",
    "emoji": "ğŸ›¸",
    "tags": ["javascript"],
    "published": true,
    "body": {
      "raw": " I tried creating a 'shooting game' using CreateJS and classes (object-oriented).  2020/03/06 Update: I found an issue where declaring fields outside the JavaScript constructor doesn't work on mobile browsers, so I made corrections.  ## Overview This game allows you to move your character using the mouse or touch screen and shoot bullets to defeat enemy aircraft.  [Play the sample game](https://atman-33.github.io/shooting-game-js/)  [Here is the source code](https://github.com/atman-33/shooting-game-js)  ![image](/blog/9/thumbnail.png)  ## Package Structure The structure is as follows:  This time, I prepared three classes, Player (your character), Enemy (opponents), and Bullet (projectiles), inside the 'js/class' folder.  ```text js-shooting-game â”œ index.html â”œ css â”‚  â””base.css â”” js    â””class ã€€    â”œPlayer.js ã€€    â”œEnemy.js ã€€    â””Bullet.js ```  ## Source Code Explanation Each JavaScript class is contained in a separate file, following the Java style. You can include these class files in your main program HTML file (in this case, index.html) to use them.  ### â‘  Beginning of the Main Program index.html serves as the page where the shooting game runs. Here, various CSS and JavaScript files are loaded to make the program work.  ```html <html> <head>     <meta charset=\"utf-8\" />     <link rel=\"stylesheet\" href=\"css/base.css\" />      <script src=\"//code.createjs.com/1.0.0/createjs.min.js\"></script>     <script src=\"js/class/Player.js\"></script>     <script src=\"js/class/Bullet.js\"></script>     <script src=\"js/class/Enemy.js\"></script>      <script type=\"text/javascript\">      // The main program continues below     // ...     // ...     // ...  ```  The CreateJS library is loaded initially, allowing you to use CreateJS objects, including the classes you've created.  **Note:** The \"//code.createjs.com/1.0.0/createjs.min.js\" URL format supports both \"http://\" and \"https://\" protocols.  ### â‘¡ Player Class The Player class has the following functionalities:  - Movement to the mouse position - Experience points gained when defeating enemies  **Note:** While one of the expected functionalities for the player is shooting bullets, you've kept that functionality in the main program (index.html) for the sake of simplicity.  Here's the Player.js code:  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // Brief: Player Class // Note: ... // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- class Player extends createjs.Shape {     // getters     getX() { return this.x; }   // Return X position.     getY() { return this.y; }   // Return Y position.     getLevel() { return this.level }     getExp() { return this.exp }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Constructor     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     constructor() {         super();    // Call the parent class constructor          this.x = 0;         this.y = 0;         this.exp = 0;         this.level = 1;          // Define the shape of the player         this.graphics.beginFill(\"white\").moveTo(0, -10).lineTo(-5, 0).lineTo(5, 0).closePath();     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Move the player.     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     move(stage) {         // Move the player to the mouse coordinates (with deceleration)         this.x += (stage.mouseX - this.x) * 0.1;         this.y += (stage.mouseY - this.y) * 0.1;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Gain experience points.     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     addExp(exp) {         this.exp = this.exp + exp;         this.level = Math.ceil(this.exp / 500)     } } ```  The Player class extends createjs.Shape, making createjs.Shape the superclass in this context. This approach allows you to reuse the fields and methods of createjs.Shape.  ### â‘¢ Enemy Class The Enemy class is almost identical to the Player class, with one key difference. It includes functionality for collision detection with bullets. This functionality is used in the main program to implement the destruction of enemies when hit by player bullets.  Here's the Enemy.js code:  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // Brief: Enemy Class // Note: ... // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- class Enemy extends createjs.Shape {     // getters     getX() { return this.x; }   // Return X position.     getY() { return this.y; }   // Return Y position.      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Constructor     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     constructor(stageW, stageH) {         super();    // Call the parent class constructor          this.x = 0;         this.y = 0;          // Define the shape of the enemy         this.graphics.beginFill(\"red\").moveTo(10, -5).lineTo(10, 5).lineTo(5, 5).lineTo(5, 10)             .lineTo(-5, 10).lineTo(-5, 5).lineTo(-10, 5).lineTo(-10, -5).closePath();          // Generate the enemy randomly from the top of the screen         this.x = stageW * Math.random();         this.y = stageH;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Move the enemy.     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     move() {         // Move the enemy         this.y += 1;     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Collision detection with player bullets.     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     collideWith(bullet) {         // Get the local coordinates of the bullet relative to the enemy         var pt = bullet.localToLocal(0, 0, this);          // Perform collision detection         return this.hitTest(pt.x, pt.y);     } } ```  In this code, the localToLocal and hitTest   methods are used for collision detection. These details are simplified for explanation, but essentially, it recalculates the position of bullets relative to the enemy and checks whether their shapes overlap.  ### â‘£ Bullet Class The Bullet class is also similar to the Player and Enemy classes.  Here's the Bullet.js code:  ```js // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- // Brief: Bullet Class // Note: ... // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- class Bullet extends createjs.Shape {     // getters     getX() { return this.x; }   // Return X position.     getY() { return this.y; }   // Return Y position.      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Constructor     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     constructor(x, y, level) {         super();    // Call the parent class constructor          this.x = x;         this.y = y;         this.level = level;          // Define the shape of the bullet         this.graphics.beginFill(\"white\").drawCircle(0, 0, 3);     }      // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     // Brief: Move the bullet.     // Note: ...     // ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ---- ----     move() {         // Move the bullet         this.y -= 10 + this.level;     } } ```  ### â‘¤ Main Program Finally, you have the main program that instantiates and utilizes instances of the Player, Enemy, and Bullet classes.  Here's the continuation of your index.html code:  ```html     // The main program continues here     // ...     // ...     // ...      // Game Over     function showGameOver() {         alert(\"Game Over! Your score was \" + scoreNum + \".\");          // Remove all event listeners         createjs.Ticker.removeAllEventListeners();         stage.removeAllEventListeners();     }      // Game Clear     function showGameClear() {         alert(\"Achievement: \" + scoreNum + \" points! Game Clear!\");          // Remove all event listeners         createjs.Ticker.removeAllEventListeners();         stage.removeAllEventListeners();     } }      </script>  </head> <body>     <canvas id=\"myCanvas\" width=\"540\" height=\"960\"></canvas> </body> </html> ```  In this main program, the initialization and game loop are handled.  - Initialization: The `init` function is executed when the page loads. - Game Loop: The `handleTick` function is called continuously to update the game state, including player movement, enemy generation, bullet movement, collision detection, and updating scores and levels.  This structure and approach are fundamental for developing games and various applications. It's especially useful when creating larger-scale games or applications, as it allows you to organize your code efficiently.  If you have any specific questions or need further clarification on any part of the code, feel free to ask!"
    },
    "_id": "blog/9-shooting-game-js.mdx",
    "_raw": {
      "sourceFilePath": "blog/9-shooting-game-js.mdx",
      "sourceFileName": "9-shooting-game-js.mdx",
      "sourceFileDir": "blog",
      "contentType": "mdx",
      "flattenedPath": "blog/9-shooting-game-js"
    },
    "type": "Post",
    "slug": "/blog/9-shooting-game-js",
    "slugAsParams": "9-shooting-game-js"
  }
]
