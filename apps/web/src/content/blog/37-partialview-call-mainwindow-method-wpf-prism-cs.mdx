---
title: C# | WPF Prism éƒ¨åˆ†Viewã‹ã‚‰MainWindowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•
description: WPF Prismã§ã¯ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚Prismã®ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ViewModelé–“ã®ç›´æ¥çš„ãªå‚ç…§ã‚’å›é¿ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç°¡å˜ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
date: 2023-03-19
emoji: ğŸ‡
tags: 
  - csharp
published: true
---

WPF Prismã§ã¯ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚

Prismã®ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€ViewModelé–“ã®ç›´æ¥çš„ãªå‚ç…§ã‚’å›é¿ã—ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å†…ã§ç™ºç”Ÿã™ã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç°¡å˜ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚  

ä»¥ä¸‹ã¯ã€Aggregatorã‚’ä½¿ç”¨ã—ã¦ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ViewModelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™æ–¹æ³•ã®ä¾‹ã§ã™ã€‚

### 1. Main Windowã®ViewModelã«ã€å‘¼ã³å‡ºã—ãŸã„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚

```cs
public class MainWindowViewModel : BindableBase
{
    private readonly IEventAggregator _eventAggregator;

    public MainWindowViewModel(IEventAggregator eventAggregator)
    {
        _eventAggregator = eventAggregator;
    }

    public void SomeMethod()
    {
        // Do something
    }
}
```

### 2. éƒ¨åˆ†Viewã«ã€ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’æ³¨å…¥ã—ã¾ã™ã€‚

```cs
public class PartialView : UserControl
{
    private readonly IEventAggregator _eventAggregator;

    public PartialView(IEventAggregator eventAggregator)
    {
        _eventAggregator = eventAggregator;
    }
}
```

### 3. éƒ¨åˆ†Viewå†…ã§ã€ã‚¤ãƒ™ãƒ³ãƒˆAggregatorã‚’ä½¿ç”¨ã—ã¦ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã—ã¾ã™ã€‚

ãŸã¨ãˆã°ã€ä»¥ä¸‹ã®ã‚ˆã†ã«ã€"SomeEvent"ã¨ã„ã†ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```cs
_eventAggregator.GetEvent<SomeEvent>().Publish();
```

ãã®ã¾ã¾ã ã¨ã€SomeEventã‚¯ãƒ©ã‚¹ãŒç„¡ã„ãŸã‚ã‚¨ãƒ©ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚
ãã®ãŸã‚ã€æ–°ã—ã„ã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¦ PubSubEvent ã‚’ç¶™æ‰¿ã—ãŸSomeEventã‚¯ãƒ©ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚
```cs
public class SomeEvent : PubSubEvent
{
}
```

è£œè¶³ã§ã™ãŒã€ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚ã‚Šã®ã‚¤ãƒ™ãƒ³ãƒˆç”¨æ„ã™ã‚‹å ´åˆã¯ã€PubSubEventã®ã‚¸ã‚§ãƒãƒªãƒƒã‚¯å‹ã«å®šç¾©ã—ã¾ã™ã€‚
```cs
public class SomeEvent : PubSubEvent<string>
{
}
```

### 4. Main Windowã®ViewModelã«ã€"SomeEvent"ã‚’è³¼èª­ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚

ã“ã‚Œã«ã‚ˆã‚Šã€ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºè¡Œã•ã‚ŒãŸã¨ãã«ã€è©²å½“ã®ãƒ¡ã‚½ãƒƒãƒ‰ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚

```cs
public class MainWindowViewModel : BindableBase
{
    private readonly IEventAggregator _eventAggregator;

    public MainWindowViewModel(IEventAggregator eventAggregator)
    {
        _eventAggregator = eventAggregator;
        _eventAggregator.GetEvent<SomeEvent>().Subscribe(OnSomeEvent);
    }

    public void OnSomeEvent()
    {
        SomeMethod();
    }

    public void SomeMethod()
    {
        // Do something
    }
}
```

ã“ã‚Œã§ã€éƒ¨åˆ†Viewã‹ã‚‰Main Windowã®ViewModelã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã³å‡ºã™ã“ã¨ãŒã§ãã¾ã™ã€‚  
éƒ¨åˆ†Viewå†…ã§ã‚¤ãƒ™ãƒ³ãƒˆã‚’ç™ºè¡Œã™ã‚‹ã“ã¨ã§ã€Main Windowã®ViewModelã«ã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ä¿¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½œæˆã—ã€å¿…è¦ãªå‡¦ç†ã‚’å®Ÿè¡Œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚