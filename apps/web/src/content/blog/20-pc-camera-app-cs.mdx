---
title: C# | PCã‚«ãƒ¡ãƒ©ã‹ã‚‰æ˜ åƒã‚’å–å¾—ã™ã‚‹ã‚¢ãƒ—ãƒª
description: C#, OpenCV ã‚’åˆ©ç”¨ã—ãŸPCã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’åŠ å·¥ã—ã¦è¡¨ç¤ºã•ã›ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
date: 2020-04-03
emoji: ğŸ“·
tags: 
  - csharp
published: true
---

PCã«æ­è¼‰ã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’å–å¾—ã—ã¦ã€è§£æç­‰ã‚’è¡Œã„ãŸã„ã¨æ€ã£ãŸã“ã¨ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

ä»Šå›ã€PCã‚«ãƒ¡ãƒ©ã®æ˜ åƒã‚’åŠ å·¥ã—ã¦è¡¨ç¤ºã•ã›ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã—ãŸã®ã§ç´¹ä»‹ã—ã¾ã™ã€‚

[ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã€‘](https://github.com/atman-33/pc-camera-app-cs)

**2020/4/14è¿½è¨˜**  
ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã€Visual Studio ã‹ã‚‰ã‚½ãƒªãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã¨å‚ç…§éƒ¨åˆ†ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹å ´åˆãŒã‚ã‚Šã¾ã™ã€‚Nugetãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ä¸‹ã•ã„ã€‚

___
## æ¦‚è¦
PCã«å†…è”µã•ã‚Œã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ã¨ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã‚’é¸æŠã™ã‚‹ã“ã¨ã§ã€å¯¾å¿œã—ãŸæ˜ åƒã‚’ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«è¡¨ç¤ºã—ã¾ã™ã€‚

ã€ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã€‘
- ãªã—
- ã‚°ãƒ¬ãƒ¼ã€€ï¼šã€€æ˜ åƒãŒã‚°ãƒ¬ãƒ¼ã«ãªã‚Šã¾ã™ã€‚
- é¡”èªè­˜ã€€ï¼šã€€é¡”ã‚’èªè­˜ã—ãŸéƒ¨åˆ†ã«èµ¤ã®çŸ©å½¢ã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

![image](/blog/20/app_sample.png)

___
## ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸æ§‹æˆ
ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯Visual Studioã§ä½œæˆã—ã¦ã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€å†…ã«ã¯å¤šãã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒå«ã¾ã‚Œã¦ãŠã‚Šã¾ã™ã®ã§ã€ä¸»ãªãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿èª¬æ˜ã—ã¾ã™ã€‚

ã“ã¡ã‚‰ã¯ã€ä¸Šã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰å¯èƒ½ãªã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨å¯¾å¿œã—ã¦ã„ã¾ã™ã€‚

```text
PcCameraApp
|-MainForm.cs
|-OpenCVSharpBitmap.cs
|-haarcascade_frontalface_default.xml
```

|ãƒ•ã‚¡ã‚¤ãƒ«å|æ©Ÿèƒ½|
|:--|:--|
MainForm.cs|ã‚¢ãƒ—ãƒªã®æ“ä½œã«å¯¾ã™ã‚‹å„ç¨®å‡¦ç†
OpenCVSharpBitmap.cs|æ˜ åƒã‚’åŠ å·¥ã—ã¦Bitmapã§è¿”ã™ã‚¯ãƒ©ã‚¹
haarcascade_frontalface_default.xml|é¡”ã‚’æ¤œå‡ºã™ã‚‹ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«

___
## è£½ä½œæ‰‹é †
Visual Studio ã‚’ç”¨ã„ãŸã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è£½ä½œæ‰‹é †ã«ã¤ã„ã¦èª¬æ˜ã—ã¦ã„ãã¾ã™ã€‚

___
### â‘ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ
ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆã«é–¢ã—ã¦ã€è©³ç´°ã®èª¬æ˜ã¯çœç•¥ã•ã›ã¦é ‚ãã¾ã™ã€‚

ä¸‹è¨˜ãƒªãƒ³ã‚¯ã‚’å‚è€ƒã«ã—ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆã¾ã§é€²ã‚ã¦ãã ã•ã„ã€‚

[Visual Studio ã§ã®æ–°ã—ã„ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ä½œæˆ](https://docs.microsoft.com/ja-jp/visualstudio/ide/create-new-project?view=vs-2019)

___
### â‘¡OpenCVSharpã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ç”»åƒå‡¦ç†ã®æ©Ÿèƒ½ã‚’æ‰±ãˆã‚‹ã‚ˆã†ã« OpenCVSharp ã‚’ä½¿ç”¨ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€â†’ã€ŒNuGet ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ç®¡ç†ã€ã‚’é–‹ãã¾ã™ã€‚

![image](/blog/20/visual_studio_1.png)

å‚ç…§ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã€ã€Œopencvã€ã‚’å…¥åŠ›ã—ã¾ã™ã€‚

è¡¨ç¤ºã•ã‚ŒãŸä¸€è¦§ã‹ã‚‰ã€ã€ŒOpenCvSharp3-AnyCPUã€ã‚’é¸æŠã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

![image](/blog/20/11.png)

___
### â‘¢AForge.NETãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

PCä»˜éšã®ã‚«ãƒ¡ãƒ©ã‚’åˆ©ç”¨ã™ã‚‹éš›ã«ã¯ã€AForge.NETã¨ã„ã†å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ä¸€é€šã‚Šã®å‡¦ç†ãŒã¾ã‹ãªãˆã¾ã™ã€‚

ã“ã“ã§ã€ã‚«ãƒ¡ãƒ©ã®æ˜ åƒå–å¾—ç”¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æº–å‚™ã—ã¾ã™ã€‚

[AFroge.netã®é…å¸ƒã‚µã‚¤ãƒˆ](http://www.aforgenet.com/framework/downloads.html)

ã€ŒDownload Libraries Only ã€ã‚’é¸æŠã—ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã‚’è¡Œã„ã¾ã™ã€‚

![image](/blog/20/aforge_net.png)

___
### â‘£AForge.NET ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å‚ç…§è¨­å®š
ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚©ãƒ«ãƒ€ï¼ˆAForge.NET Framework-2.2.5-(libs only).zipï¼‰ã®ä¸­ã«ã€ŒReleseã€ã¨ã„ã†ãƒ•ã‚©ãƒ«ãƒ€ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã®ã€ŒReleseã€ãƒ•ã‚©ãƒ«ãƒ€ã‹ã‚‰ã€ä»Šå›å¿…è¦ãªä¸‹è¨˜ã®ï¼’ç‚¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’Visual Studioã®å‚ç…§è¨­å®šã«è¿½åŠ ã—ã¾ã™ã€‚

- AForge.Video.dll
- AForge.Video.DirecrtShow.dll

![image](/blog/20/visual_studio_1.png)
![image](/blog/20/visual_studio_2.png)

___
### â‘¤ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³è£½ä½œ
ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã‚·ãƒ³ãƒ—ãƒ«ã§ã™ã€‚

ãƒ•ã‚©ãƒ¼ãƒ ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‡ã‚¶ã‚¤ãƒ³å´ã§ã€ãƒ„ãƒ¼ãƒ«ãƒœãƒƒã‚¯ã‚¹ã‚ˆã‚Šã€å¿…è¦ãªæ•°ã®ComboBoxã€Buttonã€Labelã€PictureBoxã€Timerã‚’é…ç½®ã—ã¾ã™ã€‚

ã“ã“ã§ã€PictureBox ã¯ã‚«ãƒ¡ãƒ©æ˜ åƒã‚’æ˜ ã™éƒ¨åˆ†ã§ã™ãŒã€æ˜ åƒãŒå¤§ãã„å ´åˆã¯ã€æº–å‚™ã—ãŸ PictureBox å†…ã«æ˜ åƒãŒåã¾ã‚Šã¾ã›ã‚“ã€‚


ãã®ãŸã‚ã€PictureBox ã® SizeMode ã‚’ StreachImage ã«å¤‰æ›´ã—ã¦ãŠãã¾ã—ã‚‡ã†ã€‚

![image](/blog/20/visual_studio_3.png)

___
### â‘¥ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®åŸ‹ã‚è¾¼ã¿
ã“ã“ã‹ã‚‰ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¤ã„ã¦ã§ã™ã€‚ã¾ãšã¯ã€ãƒ•ã‚©ãƒ¼ãƒ ã®ã‚³ãƒ¼ãƒ‰å´ã§ã™ã€‚

â–¼ MainForm.cs

```cs
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Diagnostics;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

using AForge.Video;             // AForge.NETãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰èª­è¾¼
using AForge.Video.DirectShow;  // AForge.NETãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰èª­è¾¼

using Original;

namespace PcCameraApp
{
    public partial class MainForm : Form
    {
        // ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
        readonly string[] IMAGE_MODE = { "ãªã—", "ã‚°ãƒ¬ãƒ¼", "é¡”èªè­˜" };  // ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰
        private string mode;                                            // ç¾åœ¨ã®ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰

        public bool DeviceExist = false;                // ãƒ‡ãƒã‚¤ã‚¹æœ‰ç„¡
        public FilterInfoCollection videoDevices;       // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§
        public VideoCaptureDevice videoSource = null;   // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã‹ã‚‰å–å¾—ã—ãŸæ˜ åƒ

        public MainForm()
        {
            InitializeComponent();
        }

        // Loadã‚¤ãƒ™ãƒ³ãƒˆï¼ˆFormã®ç«‹ã¡ä¸Šã’æ™‚ã«å®Ÿè¡Œï¼‰
        private void Form1_Load(object sender, EventArgs e)
        {
            Debug.WriteLine("Formã®ãƒ­ãƒ¼ãƒ‰é–‹å§‹");
            this.getCameraInfo();
        }

        // ã‚«ãƒ¡ãƒ©æƒ…å ±ã®å–å¾—
        public void getCameraInfo()
        {
            try
            {
                // ç«¯æœ«ã§èªè­˜ã—ã¦ã„ã‚‹ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§ã‚’å–å¾—
                videoDevices = new FilterInfoCollection(FilterCategory.VideoInputDevice);
                comboBoxCameraType.Items.Clear();

                if (videoDevices.Count == 0)
                    throw new ApplicationException();

                foreach (FilterInfo device in videoDevices)
                {
                    // ã‚«ãƒ¡ãƒ©ãƒ‡ãƒã‚¤ã‚¹ã®ä¸€è¦§ã‚’ã‚³ãƒ³ãƒœãƒœãƒƒã‚¯ã‚¹ã«è¿½åŠ 
                    comboBoxCameraType.Items.Add(device.Name);
                    comboBoxCameraType.SelectedIndex = 0;
                    DeviceExist = true;
                }
            }
            catch (ApplicationException)
            {
                DeviceExist = false;
                comboBoxCameraType.Items.Add("DeviceãŒå­˜åœ¨ã—ã¦ã„ã¾ã›ã‚“ã€‚");
            }

            comboBoxMode.Items.Clear();

            // ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ã®è¿½åŠ 
            foreach (string mode in IMAGE_MODE)
            {
                comboBoxMode.Items.Add(mode);
            }
        }

        // é–‹å§‹oråœæ­¢ãƒœã‚¿ãƒ³
        private void button1_Click(object sender, EventArgs e)
        {
            Debug.WriteLine("ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯");
            mode = comboBoxMode.Text;

            if (buttonStartStop.Text == "é–‹å§‹")
            {

                if (DeviceExist)
                {
                    videoSource = new VideoCaptureDevice(videoDevices[comboBoxCameraType.SelectedIndex].MonikerString);
                    videoSource.NewFrame += new NewFrameEventHandler(videoRendering);
                    this.CloseVideoSource();

                    videoSource.Start();

                    buttonStartStop.Text = "åœæ­¢";
                    timer1.Enabled = true;

                    Debug.WriteLine("ç”»åƒå‡¦ç†ãƒ¢ãƒ¼ãƒ‰ï¼š" + mode);
                }
                else
                {
                    labelFps.Text = "ãƒ‡ãƒã‚¤ã‚¹ãŒå­˜åœ¨ã—ã¦ã„ã¾ã›ã‚“ã€‚";
                }
            }
            else
            {
                if (videoSource.IsRunning)
                {
                    timer1.Enabled = false;
                    this.CloseVideoSource();
                    labelFps.Text = "åœæ­¢ä¸­";
                    buttonStartStop.Text = "é–‹å§‹";

                }
            }
        }
        // æç”»å‡¦ç†
        private void videoRendering(object sender, NewFrameEventArgs eventArgs)
        {
            Bitmap img = (Bitmap)eventArgs.Frame.Clone();

            Debug.WriteLine(DateTime.Now + ":" + "æç”»æ›´æ–°");
            // Debug.WriteLine(mode);

            try
            {
                switch (mode)
                {
                    case "ãªã—":
                        pictureBoxCamera.Image = img;
                        break;

                    case "ã‚°ãƒ¬ãƒ¼":
                        using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))
                        {
                            pictureBoxCamera.Image = bitmap.toGray();
                        }
                        break;

                    case "é¡”èªè­˜":
                        using (OpenCVSharpBitmap bitmap = new OpenCVSharpBitmap(img))
                        {
                            string strCurDir = System.Environment.CurrentDirectory;
                            Debug.WriteLine(strCurDir);
                            // pictureBoxCamera.Image = bitmap.addFaceRect(@"C:\Users\gpbjk\source\repos\Original\cs\opencv\haarcascade_frontalface_default.xml");
                            pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @"\haarcascade_frontalface_default.xml");
                        }
                        break;

                    default:
                        pictureBoxCamera.Image = img;
                        break;
                }
            }
            catch
            {
                pictureBoxCamera.Image = img;
            }
        }
        // åœæ­¢ã®åˆæœŸåŒ–
        private void CloseVideoSource()
        {
            if (!(videoSource == null))
                if (videoSource.IsRunning)
                {
                    videoSource.SignalToStop();
                    videoSource = null;
                }
        }
        // ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆã®å–å¾—
        private void timer1_Tick(object sender, EventArgs e)
        {
            labelFps.Text = videoSource.FramesReceived.ToString() + "FPS";
        }
        // ã‚½ãƒ•ãƒˆçµ‚äº†æ™‚ã®ã‚¯ãƒ­ãƒ¼ã‚ºå‡¦ç†
        private void MainForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (videoSource != null)
            {
                // Form ã‚’é–‰ã˜ã‚‹éš›ã¯æ˜ åƒãƒ‡ãƒ¼ã‚¿å–å¾—ã‚’ã‚¯ãƒ­ãƒ¼ã‚º
                if (videoSource.IsRunning)
                {
                    this.CloseVideoSource();
                }
            }
        }
    }
}
```

æç”»å‡¦ç†éƒ¨åˆ†ã§ã€ã‚¯ãƒ©ã‚¹ã€ŒOpenCVSharpBitmap ã€ã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚

ã“ã®ã‚¯ãƒ©ã‚¹ã§ã€æ˜ åƒã‚’åŠ å·¥ã—ã¦Bitmapã®ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã™å‡¦ç†ã‚’è¡Œã„ã¾ã™ã€‚

â–¼OpenCVSharpBitmap .cs

```cs
using OpenCvSharp;
using OpenCvSharp.Extensions;
using System;
using System.Drawing;

///

/// ã‚ªãƒªã‚¸ãƒŠãƒ«ã‚¯ãƒ©ã‚¹
///

namespace Original
{
    public class OpenCVSharpBitmap : IDisposable
    {
        private Mat mat;

        ///

        /// ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
        ///

        ///
        public OpenCVSharpBitmap(Bitmap img)
        {
            this.mat = BitmapConverter.ToMat(img);
        }

        public void Dispose()
        {
            ((IDisposable)mat).Dispose();
        }

        ///

        /// ã‚°ãƒ¬ãƒ¼ã«å¤‰æ›ã—ãŸBitmapã‚’å–å¾—
        ///

        ///
        public Bitmap toGray()
        {
            Mat matGray = mat.CvtColor(ColorConversionCodes.BGR2GRAY);
            return BitmapConverter.ToBitmap(matGray);
        }

        ///

        /// é¡”ã‚’èªè­˜ã—ã¦èµ¤æ ã‚’è¿½åŠ ã—ãŸBitmapã‚’å–å¾—
        ///

        ///
        ///
        public Bitmap addFaceRect(string @cascadePath)
        {
            // åˆ†é¡æ©Ÿã®ç”¨æ„
            using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath))
            {
                foreach (Rect rectFace in cascade.DetectMultiScale(mat))
                {
                    // è¦‹ã¤ã‹ã£ãŸå ´æ‰€ã«èµ¤æ ã‚’è¡¨ç¤º
                    Rect rect = new Rect(rectFace.X, rectFace.Y, rectFace.Width, rectFace.Height);
                    mat.Rectangle(rect, new OpenCvSharp.Scalar(0,0,255), 3, LineTypes.Link8);
                }
            }

            return BitmapConverter.ToBitmap(mat);
        }
    }
}
```
___
### â‘¦é¡”èªè­˜ã®æ–¹æ³•
é¡”èªè­˜ã—ãŸçŸ©å½¢ã‚’æ˜ åƒã«åŠ ãˆã‚‹å‡¦ç†ã¯ã€è£œè¶³ã§èª¬æ˜ã—ã¦ãŠãã¾ã™ã€‚

ã¾ãšã€ä»Šå›ã®é¡”èªè­˜ã§ã¯ **ã€Œã‚«ã‚¹ã‚±ãƒ¼ãƒ‰åˆ†é¡ã€** ã¨å‘¼ã°ã‚Œã‚‹æ–¹æ³•ã‚’ç”¨ã„ã¦ã„ã¾ã™ã€‚  
äºˆã‚ã€ç‰¹å®šã®ãƒ¢ãƒã‚’åŒºåˆ¥ã™ã‚‹è¨­å®šå€¤ãŒå«ã¾ã‚Œã‚‹XMLãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ãŠãã€ãã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ OpenCvSharp ã®é–¢æ•°ã‹ã‚‰èª­ã¿è¾¼ã¿ã¾ã™ã€‚

é¡”èªè­˜ã«å¿…è¦ãªXMLãƒ•ã‚¡ã‚¤ãƒ«ã€Œhaarcascade_frontalface_default.xmlã€ã¯ã€ä¸‹è¨˜ã®githubã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã§ãã¾ã™ã€‚


[xmlãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰](https://github.com/opencv/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml)

ä»Šå›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’åŒãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å®Ÿè¡Œãƒ•ã‚©ãƒ«ãƒ€ã«ä¿å­˜ã—ã¦æ‰±ã†ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚

MainForm.cs
```cs
pictureBoxCamera.Image = bitmap.addFaceRect(strCurDir + @"\haarcascade_frontalface_default.xml");
```

OpenCVSharpBitmap.cs
```cs
using (CascadeClassifier cascade = new CascadeClassifier(@cascadePath))
```

ã“ã®ã‚ˆã†ã«ã€ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã¯å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ã¨åŒã˜ãƒ•ã‚©ãƒ«ãƒ€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§ã—ã¾ã™ã®ã§ã€ãƒ“ãƒ«ãƒ‰ã™ã‚‹éš›ã«ã¯ã‚«ã‚¹ã‚±ãƒ¼ãƒ‰ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¸€ç·’ã«å‡ºåŠ›ã•ã›ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

![image](/blog/20/visual_studio_4.png)

ã“ã‚Œã§èª¬æ˜ã¯çµ‚äº†ã§ã™ã€‚

ä»Šå›ã¯ã‚ãã¾ã§ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚

ç”»åƒå‡¦ç†ã®å®Ÿè£…æ–¹æ³•ãªã©ã¯æµç”¨ã§ãã¾ã™ã®ã§ã€è‡ªåˆ†å¥½ã¿ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’é–‹ç™ºã—ã¦ã„ãå‚è€ƒã«ãªã‚Œã°å¹¸ã„ã§ã™ã€‚

ä»¥ä¸Šã§ã™ã€‚
